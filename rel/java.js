/*! For license information please see java.js.LICENSE.txt */
(()=>{var e={251(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,l=(1<<s)-1,c=l>>1,d=-7,u=n?o-1:0,p=n?-1:1,h=e[t+u];for(u+=p,i=h&(1<<-d)-1,h>>=-d,d+=s;d>0;i=256*i+e[t+u],u+=p,d-=8);for(a=i&(1<<-d)-1,i>>=-d,d+=r;d>0;a=256*a+e[t+u],u+=p,d-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),i-=c}return(h?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,l,c=8*i-o-1,d=(1<<c)-1,u=d>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+u>=1?p/l:p*Math.pow(2,1-u))*l>=2&&(a++,l/=2),a+u>=d?(s=0,a=d):a+u>=1?(s=(t*l-1)*Math.pow(2,o),a+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,o),a=0));o>=8;e[n+h]=255&s,h+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+h]=255&a,h+=f,a/=256,c-=8);e[n+h-f]|=128*m}},287(e,t,n){"use strict";var r=n(526),o=n(251),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.hp=l,t.IS=50;var a=2147483647;function s(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|m(e,t),r=s(n),o=r.write(e,t);return o!==n&&(r=r.slice(0,o)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(F(e,Uint8Array)){var t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return p(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(F(e,ArrayBuffer)||e&&F(e.buffer,ArrayBuffer))return h(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(F(e,SharedArrayBuffer)||e&&F(e.buffer,SharedArrayBuffer)))return h(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);var o=function(e){if(l.isBuffer(e)){var t=0|f(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||V(e.length)?s(0):p(e):"Buffer"===e.type&&Array.isArray(e.data)?p(e.data):void 0}(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return d(e),s(e<0?0:0|f(e))}function p(e){for(var t=e.length<0?0:0|f(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function f(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||F(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(o)return r?-1:D(e).length;t=(""+t).toLowerCase(),o=!0}}function _(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return j(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return k(this,t,n);case"base64":return L(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),V(n=+n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,o){var i,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var d=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===l)return d*a}else-1!==d&&(i-=i-d),d=-1}else for(n+l>s&&(n=s-l),i=n;i>=0;i--){for(var u=!0,p=0;p<l;p++)if(c(e,i+p)!==c(t,p)){u=!1;break}if(u)return i}return-1}function b(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(V(s))return a;e[n+a]=s}return a}function C(e,t,n,r){return J(D(t,e.length-n),e,n,r)}function w(e,t,n,r){return J(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return J(z(t),e,n,r)}function E(e,t,n,r){return J(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function L(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function j(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,l,c=e[o],d=null,u=c>239?4:c>223?3:c>191?2:1;if(o+u<=n)switch(u){case 1:c<128&&(d=c);break;case 2:128==(192&(i=e[o+1]))&&(l=(31&c)<<6|63&i)>127&&(d=l);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(l=(15&c)<<12|(63&i)<<6|63&a)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(d=l)}null===d?(d=65533,u=1):d>65535&&(d-=65536,r.push(d>>>10&1023|55296),d=56320|1023&d),r.push(d),o+=u}return function(e){var t=e.length;if(t<=N)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=N));return n}(r)}l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return d(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},l.allocUnsafe=function(e){return u(e)},l.allocUnsafeSlow=function(e){return u(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(F(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),F(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(F(i,Uint8Array))o+i.length>r.length?l.from(i).copy(r,o):Uint8Array.prototype.set.call(r,i,o);else{if(!l.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o)}o+=i.length}return r},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?j(this,0,e):_.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.IS;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(l.prototype[i]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,o){if(F(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),c=this.slice(r,o),d=e.slice(t,n),u=0;u<s;++u)if(c[u]!==d[u]){i=c[u],a=d[u];break}return i<a?-1:a<i?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return C(this,e,t,n);case"ascii":case"latin1":case"binary":return w(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function A(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function k(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function M(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=$[e[i]];return o}function P(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length-1;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function I(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,o,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function x(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function T(e,t,n,r,i){return t=+t,n>>>=0,i||x(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,i){return t=+t,n>>>=0,i||x(e,0,n,8),o.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||I(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||I(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||I(e,4,this.length),o.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||I(e,4,this.length),o.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||I(e,8,this.length),o.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||I(e,8,this.length),o.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,n){return T(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return T(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),o},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var o=e.charCodeAt(0);("utf8"===r&&o<128||"latin1"===r)&&(e=o)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=l.isBuffer(e)?e:l.from(e,r),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var O=/[^+/0-9A-Za-z-_]/g;function D(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function z(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function J(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function F(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function V(e){return e!=e}var $=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,o=0;o<16;++o)t[r+o]=e[n]+e[o];return t}()},526(e,t){"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=s(e),a=i[0],l=i[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,l)),d=0,u=l>0?a-4:a;for(n=0;n<u;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[d++]=255&t),1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=16383,s=0,l=r-o;s<l;s+=a)i.push(c(e,s,s+a>l?l:s+a));return 1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function c(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(l(r));return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{NB:()=>he,wp:()=>nn,m7:()=>dn,nO:()=>At,ah:()=>Zt,CK:()=>Gt,mW:()=>$t,JO:()=>He,oi:()=>Se,x4:()=>Be,Bh:()=>nt,Xi:()=>rt,Q:()=>ye,jc:()=>vt,kS:()=>_t,qD:()=>Nt,b:()=>hn,m1:()=>Mt,Pm:()=>ft,rt:()=>pt});const{pageSize:t,pointerSize:r}=Process;class o{constructor(e){this.sliceSize=e,this.slicesPerPage=t/e,this.pages=[],this.free=[]}allocateSlice(e,n){const r=void 0===e.near,o=1===n;if(r&&o){const e=this.free.pop();if(void 0!==e)return e}else if(n<t){const{free:t}=this,i=t.length,a=o?null:ptr(n-1);for(let n=0;n!==i;n++){const i=t[n],s=r||this._isSliceNear(i,e),l=o||i.and(a).isNull();if(s&&l)return t.splice(n,1)[0]}}return this._allocatePage(e)}_allocatePage(e){const n=Memory.alloc(t,e),{sliceSize:r,slicesPerPage:o}=this;for(let e=1;e!==o;e++){const t=n.add(e*r);this.free.push(t)}return this.pages.push(n),n}_isSliceNear(e,t){const n=e.add(this.sliceSize),{near:r,maxDistance:o}=t,a=i(r.sub(e)),s=i(r.sub(n));return a.compare(o)<=0&&s.compare(o)<=0}freeSlice(e){this.free.push(e)}}function i(e){const t=4===r?31:63,n=ptr(1).shl(t).not();return e.and(n)}const a=0;function s(e,t){if(t!==a)throw new Error(e+" failed: "+t)}const l={v1_0:805371904,v1_2:805372416},c={canTagObjects:1},{pointerSize:d}=Process,u={exceptions:"propagate"};function p(e,t){this.handle=e,this.vm=t,this.vtable=e.readPointer()}function h(e,t,n,r){let o=null;return function(){null===o&&(o=new NativeFunction(this.vtable.add((e-1)*d).readPointer(),t,n,u));let i=[o];return i=i.concat.apply(i,arguments),r.apply(this,i)}}function f(e,t,{limit:n}){let r=e,o=null;for(let e=0;e!==n;e++){const e=Instruction.parse(r),n=t(e,o);if(null!==n)return n;r=e.next,o=e}return null}function m(e){let t=null,n=!1;return function(...r){return n||(t=e(...r),n=!0),t}}function _(e,t){this.handle=e,this.vm=t}p.prototype.deallocate=h(47,"int32",["pointer","pointer"],function(e,t){return e(this.handle,t)}),p.prototype.getLoadedClasses=h(78,"int32",["pointer","pointer","pointer"],function(e,t,n){s("EnvJvmti::getLoadedClasses",e(this.handle,t,n))}),p.prototype.iterateOverInstancesOfClass=h(112,"int32",["pointer","pointer","int","pointer","pointer"],function(e,t,n,r,o){s("EnvJvmti::iterateOverInstancesOfClass",e(this.handle,t,n,r,o))}),p.prototype.getObjectsWithTags=h(114,"int32",["pointer","int","pointer","pointer","pointer","pointer"],function(e,t,n,r,o,i){s("EnvJvmti::getObjectsWithTags",e(this.handle,t,n,r,o,i))}),p.prototype.addCapabilities=h(142,"int32",["pointer","pointer"],function(e,t){return e(this.handle,t)});const g=Process.pointerSize,v={pointer:34,uint8:37,int8:40,uint16:43,int16:46,int32:49,int64:52,float:55,double:58,void:61},y={pointer:64,uint8:67,int8:70,uint16:73,int16:76,int32:79,int64:82,float:85,double:88,void:91},b={pointer:114,uint8:117,int8:120,uint16:123,int16:126,int32:129,int64:132,float:135,double:138,void:141},C={pointer:95,uint8:96,int8:97,uint16:98,int16:99,int32:100,int64:101,float:102,double:103},w={pointer:104,uint8:105,int8:106,uint16:107,int16:108,int32:109,int64:110,float:111,double:112},S={pointer:145,uint8:146,int8:147,uint16:148,int16:149,int32:150,int64:151,float:152,double:153},E={pointer:154,uint8:155,int8:156,uint16:157,int16:158,int32:159,int64:160,float:161,double:162},L={exceptions:"propagate"};let j=null,N=[];function A(e){return N.push(e),e}function k(e){return null===j&&(j=e.handle.readPointer()),j}function M(e,t,n,r){let o=null;return function(){null===o&&(o=new NativeFunction(k(this).add(e*g).readPointer(),t,n,L));let i=[o];return i=i.concat.apply(i,arguments),r.apply(this,i)}}_.dispose=function(e){N.forEach(e.deleteGlobalRef,e),N=[]},_.prototype.getVersion=M(4,"int32",["pointer"],function(e){return e(this.handle)}),_.prototype.findClass=M(6,"pointer",["pointer","pointer"],function(e,t){const n=e(this.handle,Memory.allocUtf8String(t));return this.throwIfExceptionPending(),n}),_.prototype.throwIfExceptionPending=function(){const e=this.exceptionOccurred();if(e.isNull())return;this.exceptionClear();const t=this.newGlobalRef(e);this.deleteLocalRef(e);const n=this.vaMethod("pointer",[])(this.handle,t,this.javaLangObject().toString),r=this.stringFromJni(n);this.deleteLocalRef(n);const o=new Error(r);throw o.$h=t,Script.bindWeak(o,function(e,t){return function(){e.perform(e=>{e.deleteGlobalRef(t)})}}(this.vm,t)),o},_.prototype.fromReflectedMethod=M(7,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.fromReflectedField=M(8,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.toReflectedMethod=M(9,"pointer",["pointer","pointer","pointer","uint8"],function(e,t,n,r){return e(this.handle,t,n,r)}),_.prototype.getSuperclass=M(10,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.isAssignableFrom=M(11,"uint8",["pointer","pointer","pointer"],function(e,t,n){return!!e(this.handle,t,n)}),_.prototype.toReflectedField=M(12,"pointer",["pointer","pointer","pointer","uint8"],function(e,t,n,r){return e(this.handle,t,n,r)}),_.prototype.throw=M(13,"int32",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.exceptionOccurred=M(15,"pointer",["pointer"],function(e){return e(this.handle)}),_.prototype.exceptionDescribe=M(16,"void",["pointer"],function(e){e(this.handle)}),_.prototype.exceptionClear=M(17,"void",["pointer"],function(e){e(this.handle)}),_.prototype.pushLocalFrame=M(19,"int32",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.popLocalFrame=M(20,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.newGlobalRef=M(21,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.deleteGlobalRef=M(22,"void",["pointer","pointer"],function(e,t){e(this.handle,t)}),_.prototype.deleteLocalRef=M(23,"void",["pointer","pointer"],function(e,t){e(this.handle,t)}),_.prototype.isSameObject=M(24,"uint8",["pointer","pointer","pointer"],function(e,t,n){return!!e(this.handle,t,n)}),_.prototype.newLocalRef=M(25,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.allocObject=M(27,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.getObjectClass=M(31,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.isInstanceOf=M(32,"uint8",["pointer","pointer","pointer"],function(e,t,n){return!!e(this.handle,t,n)}),_.prototype.getMethodId=M(33,"pointer",["pointer","pointer","pointer","pointer"],function(e,t,n,r){return e(this.handle,t,Memory.allocUtf8String(n),Memory.allocUtf8String(r))}),_.prototype.getFieldId=M(94,"pointer",["pointer","pointer","pointer","pointer"],function(e,t,n,r){return e(this.handle,t,Memory.allocUtf8String(n),Memory.allocUtf8String(r))}),_.prototype.getIntField=M(100,"int32",["pointer","pointer","pointer"],function(e,t,n){return e(this.handle,t,n)}),_.prototype.getStaticMethodId=M(113,"pointer",["pointer","pointer","pointer","pointer"],function(e,t,n,r){return e(this.handle,t,Memory.allocUtf8String(n),Memory.allocUtf8String(r))}),_.prototype.getStaticFieldId=M(144,"pointer",["pointer","pointer","pointer","pointer"],function(e,t,n,r){return e(this.handle,t,Memory.allocUtf8String(n),Memory.allocUtf8String(r))}),_.prototype.getStaticIntField=M(150,"int32",["pointer","pointer","pointer"],function(e,t,n){return e(this.handle,t,n)}),_.prototype.getStringLength=M(164,"int32",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.getStringChars=M(165,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.releaseStringChars=M(166,"void",["pointer","pointer","pointer"],function(e,t,n){e(this.handle,t,n)}),_.prototype.newStringUtf=M(167,"pointer",["pointer","pointer"],function(e,t){const n=Memory.allocUtf8String(t);return e(this.handle,n)}),_.prototype.getStringUtfChars=M(169,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.releaseStringUtfChars=M(170,"void",["pointer","pointer","pointer"],function(e,t,n){e(this.handle,t,n)}),_.prototype.getArrayLength=M(171,"int32",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.newObjectArray=M(172,"pointer",["pointer","int32","pointer","pointer"],function(e,t,n,r){return e(this.handle,t,n,r)}),_.prototype.getObjectArrayElement=M(173,"pointer",["pointer","pointer","int32"],function(e,t,n){return e(this.handle,t,n)}),_.prototype.setObjectArrayElement=M(174,"void",["pointer","pointer","int32","pointer"],function(e,t,n,r){e(this.handle,t,n,r)}),_.prototype.newBooleanArray=M(175,"pointer",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.newByteArray=M(176,"pointer",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.newCharArray=M(177,"pointer",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.newShortArray=M(178,"pointer",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.newIntArray=M(179,"pointer",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.newLongArray=M(180,"pointer",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.newFloatArray=M(181,"pointer",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.newDoubleArray=M(182,"pointer",["pointer","int32"],function(e,t){return e(this.handle,t)}),_.prototype.getBooleanArrayElements=M(183,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.getByteArrayElements=M(184,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.getCharArrayElements=M(185,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.getShortArrayElements=M(186,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.getIntArrayElements=M(187,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.getLongArrayElements=M(188,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.getFloatArrayElements=M(189,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.getDoubleArrayElements=M(190,"pointer",["pointer","pointer","pointer"],function(e,t){return e(this.handle,t,NULL)}),_.prototype.releaseBooleanArrayElements=M(191,"pointer",["pointer","pointer","pointer","int32"],function(e,t,n){e(this.handle,t,n,2)}),_.prototype.releaseByteArrayElements=M(192,"pointer",["pointer","pointer","pointer","int32"],function(e,t,n){e(this.handle,t,n,2)}),_.prototype.releaseCharArrayElements=M(193,"pointer",["pointer","pointer","pointer","int32"],function(e,t,n){e(this.handle,t,n,2)}),_.prototype.releaseShortArrayElements=M(194,"pointer",["pointer","pointer","pointer","int32"],function(e,t,n){e(this.handle,t,n,2)}),_.prototype.releaseIntArrayElements=M(195,"pointer",["pointer","pointer","pointer","int32"],function(e,t,n){e(this.handle,t,n,2)}),_.prototype.releaseLongArrayElements=M(196,"pointer",["pointer","pointer","pointer","int32"],function(e,t,n){e(this.handle,t,n,2)}),_.prototype.releaseFloatArrayElements=M(197,"pointer",["pointer","pointer","pointer","int32"],function(e,t,n){e(this.handle,t,n,2)}),_.prototype.releaseDoubleArrayElements=M(198,"pointer",["pointer","pointer","pointer","int32"],function(e,t,n){e(this.handle,t,n,2)}),_.prototype.getByteArrayRegion=M(200,"void",["pointer","pointer","int","int","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.setBooleanArrayRegion=M(207,"void",["pointer","pointer","int32","int32","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.setByteArrayRegion=M(208,"void",["pointer","pointer","int32","int32","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.setCharArrayRegion=M(209,"void",["pointer","pointer","int32","int32","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.setShortArrayRegion=M(210,"void",["pointer","pointer","int32","int32","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.setIntArrayRegion=M(211,"void",["pointer","pointer","int32","int32","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.setLongArrayRegion=M(212,"void",["pointer","pointer","int32","int32","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.setFloatArrayRegion=M(213,"void",["pointer","pointer","int32","int32","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.setDoubleArrayRegion=M(214,"void",["pointer","pointer","int32","int32","pointer"],function(e,t,n,r,o){e(this.handle,t,n,r,o)}),_.prototype.registerNatives=M(215,"int32",["pointer","pointer","pointer","int32"],function(e,t,n,r){return e(this.handle,t,n,r)}),_.prototype.monitorEnter=M(217,"int32",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.monitorExit=M(218,"int32",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.getDirectBufferAddress=M(230,"pointer",["pointer","pointer"],function(e,t){return e(this.handle,t)}),_.prototype.getObjectRefType=M(232,"int32",["pointer","pointer"],function(e,t){return e(this.handle,t)});const P=new Map;function I(e,t,n,r){return T(this,"p",U,e,t,n,r)}function R(e,t,n,r){return T(this,"v",O,e,t,n,r)}function x(e,t,n,r){return T(this,"n",D,e,t,n,r)}function T(e,t,n,r,o,i,a){if(void 0!==a)return n(e,r,o,i,a);const s=[r,t,o].concat(i).join("|");let l=P.get(s);return void 0===l&&(l=n(e,r,o,i,L),P.set(s,l)),l}function U(e,t,n,r,o){return new NativeFunction(k(e).add(t*g).readPointer(),n,["pointer","pointer","pointer"].concat(r),o)}function O(e,t,n,r,o){return new NativeFunction(k(e).add(t*g).readPointer(),n,["pointer","pointer","pointer","..."].concat(r),o)}function D(e,t,n,r,o){return new NativeFunction(k(e).add(t*g).readPointer(),n,["pointer","pointer","pointer","pointer","..."].concat(r),o)}_.prototype.constructor=function(e,t){return R.call(this,28,"pointer",e,t)},_.prototype.vaMethod=function(e,t,n){const r=v[e];if(void 0===r)throw new Error("Unsupported type: "+e);return R.call(this,r,e,t,n)},_.prototype.nonvirtualVaMethod=function(e,t,n){const r=y[e];if(void 0===r)throw new Error("Unsupported type: "+e);return x.call(this,r,e,t,n)},_.prototype.staticVaMethod=function(e,t,n){const r=b[e];if(void 0===r)throw new Error("Unsupported type: "+e);return R.call(this,r,e,t,n)},_.prototype.getField=function(e){const t=C[e];if(void 0===t)throw new Error("Unsupported type: "+e);return I.call(this,t,e,[])},_.prototype.getStaticField=function(e){const t=S[e];if(void 0===t)throw new Error("Unsupported type: "+e);return I.call(this,t,e,[])},_.prototype.setField=function(e){const t=w[e];if(void 0===t)throw new Error("Unsupported type: "+e);return I.call(this,t,"void",[e])},_.prototype.setStaticField=function(e){const t=E[e];if(void 0===t)throw new Error("Unsupported type: "+e);return I.call(this,t,"void",[e])};let z=null;_.prototype.javaLangClass=function(){if(null===z){const e=this.findClass("java/lang/Class");try{const t=this.getMethodId.bind(this,e);z={handle:A(this.newGlobalRef(e)),getName:t("getName","()Ljava/lang/String;"),getSimpleName:t("getSimpleName","()Ljava/lang/String;"),getGenericSuperclass:t("getGenericSuperclass","()Ljava/lang/reflect/Type;"),getDeclaredConstructors:t("getDeclaredConstructors","()[Ljava/lang/reflect/Constructor;"),getDeclaredMethods:t("getDeclaredMethods","()[Ljava/lang/reflect/Method;"),getDeclaredFields:t("getDeclaredFields","()[Ljava/lang/reflect/Field;"),isArray:t("isArray","()Z"),isPrimitive:t("isPrimitive","()Z"),isInterface:t("isInterface","()Z"),getComponentType:t("getComponentType","()Ljava/lang/Class;")}}finally{this.deleteLocalRef(e)}}return z};let J=null;_.prototype.javaLangObject=function(){if(null===J){const e=this.findClass("java/lang/Object");try{const t=this.getMethodId.bind(this,e);J={handle:A(this.newGlobalRef(e)),toString:t("toString","()Ljava/lang/String;"),getClass:t("getClass","()Ljava/lang/Class;")}}finally{this.deleteLocalRef(e)}}return J};let F=null;_.prototype.javaLangReflectConstructor=function(){if(null===F){const e=this.findClass("java/lang/reflect/Constructor");try{F={getGenericParameterTypes:this.getMethodId(e,"getGenericParameterTypes","()[Ljava/lang/reflect/Type;")}}finally{this.deleteLocalRef(e)}}return F};let V=null;_.prototype.javaLangReflectMethod=function(){if(null===V){const e=this.findClass("java/lang/reflect/Method");try{const t=this.getMethodId.bind(this,e);V={getName:t("getName","()Ljava/lang/String;"),getGenericParameterTypes:t("getGenericParameterTypes","()[Ljava/lang/reflect/Type;"),getParameterTypes:t("getParameterTypes","()[Ljava/lang/Class;"),getGenericReturnType:t("getGenericReturnType","()Ljava/lang/reflect/Type;"),getGenericExceptionTypes:t("getGenericExceptionTypes","()[Ljava/lang/reflect/Type;"),getModifiers:t("getModifiers","()I"),isVarArgs:t("isVarArgs","()Z")}}finally{this.deleteLocalRef(e)}}return V};let $=null;_.prototype.javaLangReflectField=function(){if(null===$){const e=this.findClass("java/lang/reflect/Field");try{const t=this.getMethodId.bind(this,e);$={getName:t("getName","()Ljava/lang/String;"),getType:t("getType","()Ljava/lang/Class;"),getGenericType:t("getGenericType","()Ljava/lang/reflect/Type;"),getModifiers:t("getModifiers","()I"),toString:t("toString","()Ljava/lang/String;")}}finally{this.deleteLocalRef(e)}}return $};let G=null;_.prototype.javaLangReflectTypeVariable=function(){if(null===G){const e=this.findClass("java/lang/reflect/TypeVariable");try{const t=this.getMethodId.bind(this,e);G={handle:A(this.newGlobalRef(e)),getName:t("getName","()Ljava/lang/String;"),getBounds:t("getBounds","()[Ljava/lang/reflect/Type;"),getGenericDeclaration:t("getGenericDeclaration","()Ljava/lang/reflect/GenericDeclaration;")}}finally{this.deleteLocalRef(e)}}return G};let Z=null;_.prototype.javaLangReflectWildcardType=function(){if(null===Z){const e=this.findClass("java/lang/reflect/WildcardType");try{const t=this.getMethodId.bind(this,e);Z={handle:A(this.newGlobalRef(e)),getLowerBounds:t("getLowerBounds","()[Ljava/lang/reflect/Type;"),getUpperBounds:t("getUpperBounds","()[Ljava/lang/reflect/Type;")}}finally{this.deleteLocalRef(e)}}return Z};let B=null;_.prototype.javaLangReflectGenericArrayType=function(){if(null===B){const e=this.findClass("java/lang/reflect/GenericArrayType");try{B={handle:A(this.newGlobalRef(e)),getGenericComponentType:this.getMethodId(e,"getGenericComponentType","()Ljava/lang/reflect/Type;")}}finally{this.deleteLocalRef(e)}}return B};let q=null;_.prototype.javaLangReflectParameterizedType=function(){if(null===q){const e=this.findClass("java/lang/reflect/ParameterizedType");try{const t=this.getMethodId.bind(this,e);q={handle:A(this.newGlobalRef(e)),getActualTypeArguments:t("getActualTypeArguments","()[Ljava/lang/reflect/Type;"),getRawType:t("getRawType","()Ljava/lang/reflect/Type;"),getOwnerType:t("getOwnerType","()Ljava/lang/reflect/Type;")}}finally{this.deleteLocalRef(e)}}return q};let H=null;_.prototype.javaLangString=function(){if(null===H){const e=this.findClass("java/lang/String");try{H={handle:A(this.newGlobalRef(e))}}finally{this.deleteLocalRef(e)}}return H},_.prototype.getClassName=function(e){const t=this.vaMethod("pointer",[])(this.handle,e,this.javaLangClass().getName);try{return this.stringFromJni(t)}finally{this.deleteLocalRef(t)}},_.prototype.getObjectClassName=function(e){const t=this.getObjectClass(e);try{return this.getClassName(t)}finally{this.deleteLocalRef(t)}},_.prototype.getActualTypeArgument=function(e){const t=this.vaMethod("pointer",[])(this.handle,e,this.javaLangReflectParameterizedType().getActualTypeArguments);if(this.throwIfExceptionPending(),!t.isNull())try{return this.getTypeNameFromFirstTypeElement(t)}finally{this.deleteLocalRef(t)}},_.prototype.getTypeNameFromFirstTypeElement=function(e){if(!(this.getArrayLength(e)>0))return"java.lang.Object";{const t=this.getObjectArrayElement(e,0);try{return this.getTypeName(t)}finally{this.deleteLocalRef(t)}}},_.prototype.getTypeName=function(e,t){const n=this.vaMethod("pointer",[]);if(this.isInstanceOf(e,this.javaLangClass().handle))return this.getClassName(e);if(this.isInstanceOf(e,this.javaLangReflectGenericArrayType().handle))return this.getArrayTypeName(e);if(this.isInstanceOf(e,this.javaLangReflectParameterizedType().handle)){const r=n(this.handle,e,this.javaLangReflectParameterizedType().getRawType);let o;this.throwIfExceptionPending();try{o=this.getTypeName(r)}finally{this.deleteLocalRef(r)}return t&&(o+="<"+this.getActualTypeArgument(e)+">"),o}return this.isInstanceOf(e,this.javaLangReflectTypeVariable().handle)||this.isInstanceOf(e,this.javaLangReflectWildcardType().handle),"java.lang.Object"},_.prototype.getArrayTypeName=function(e){const t=this.vaMethod("pointer",[]);if(this.isInstanceOf(e,this.javaLangClass().handle))return this.getClassName(e);if(!this.isInstanceOf(e,this.javaLangReflectGenericArrayType().handle))return"[Ljava.lang.Object;";{const n=t(this.handle,e,this.javaLangReflectGenericArrayType().getGenericComponentType);this.throwIfExceptionPending();try{return"[L"+this.getTypeName(n)+";"}finally{this.deleteLocalRef(n)}}},_.prototype.stringFromJni=function(e){const t=this.getStringChars(e);if(t.isNull())throw new Error("Unable to access string");try{const n=this.getStringLength(e);return t.readUtf16String(n)}finally{this.releaseStringChars(e,t)}};const W=65542,K=Process.pointerSize,Q=Process.getCurrentThreadId(),X=new Map,Y=new Map;function ee(e){const t=e.vm;let n=null,r=null,o=null;function i(e){const t=Y.get(e);return void 0===t?null:t[0]}this.handle=t,this.perform=function(e){const t=Process.getCurrentThreadId(),n=i(t);if(null!==n)return e(n);let r=this._tryGetEnv();const o=null!==r;o||(r=this.attachCurrentThread(),X.set(t,!0)),this.link(t,r);try{return e(r)}finally{const e=t===Q;if(e||this.unlink(t),!o&&!e){const e=X.get(t);X.delete(t),e&&this.detachCurrentThread()}}},this.attachCurrentThread=function(){const e=Memory.alloc(K);return s("VM::AttachCurrentThread",n(t,e,NULL)),new _(e.readPointer(),this)},this.detachCurrentThread=function(){s("VM::DetachCurrentThread",r(t))},this.preventDetachDueToClassLoader=function(){const e=Process.getCurrentThreadId();X.has(e)&&X.set(e,!1)},this.getEnv=function(){const e=i(Process.getCurrentThreadId());if(null!==e)return e;const n=Memory.alloc(K),r=o(t,n,W);if(-2===r)throw new Error("Current thread is not attached to the Java VM; please move this code inside a Java.perform() callback");return s("VM::GetEnv",r),new _(n.readPointer(),this)},this.tryGetEnv=function(){const e=i(Process.getCurrentThreadId());return null!==e?e:this._tryGetEnv()},this._tryGetEnv=function(){const e=this.tryGetEnvHandle(W);return null===e?null:new _(e,this)},this.tryGetEnvHandle=function(e){const n=Memory.alloc(K);return o(t,n,e)!==a?null:n.readPointer()},this.makeHandleDestructor=function(e){return()=>{this.perform(t=>{t.deleteGlobalRef(e)})}},this.link=function(e,t){const n=Y.get(e);void 0===n?Y.set(e,[t,1]):n[1]++},this.unlink=function(e){const t=Y.get(e);1===t[1]?Y.delete(e):t[1]--},function(){const e=t.readPointer(),i={exceptions:"propagate"};n=new NativeFunction(e.add(4*K).readPointer(),"int32",["pointer","pointer","pointer"],i),r=new NativeFunction(e.add(5*K).readPointer(),"int32",["pointer"],i),o=new NativeFunction(e.add(6*K).readPointer(),"int32",["pointer","pointer","int32"],i)}.call(this)}ee.dispose=function(e){!0===X.get(Q)&&(X.delete(Q),e.detachCurrentThread())};const te=4,ne=Process.pointerSize,{readU32:re,readPointer:oe,writeU32:ie,writePointer:ae}=NativePointer.prototype,se=0,le=3,ce=5,de=ptr(1).not(),ue=17*ne,pe=18*ne,he=12,fe=2147483648,me=3*ne,_e=3*ne,ge=m(function(e){const t=e.vm,n=e.artRuntime,r=4===ne?200:384,o=r+100*ne,i=Le(),a=Ee(),{isApiLevel34OrApexEquivalent:s}=e;let l=null;for(let e=r;e!==o;e+=ne)if(n.add(e).readPointer().equals(t)){let t,r=null;i>=33||"Tiramisu"===a||s?(t=[e-4*ne],r=e-ne):i>=30||"R"===a?(t=[e-3*ne,e-4*ne],r=e-ne):t=i>=29?[e-2*ne]:i>=27?[e-me-3*ne]:[e-me-2*ne];for(const e of t){const t=e-ne,o=t-ne;let a;a=s?o-9*ne:i>=24?o-8*ne:i>=23?o-7*ne:o-4*ne;const c={offset:{heap:a,threadList:o,internTable:t,classLinker:e,jniIdManager:r}};if(null!==tt(n,c)){l=c;break}}break}if(null===l)throw new Error("Unable to determine Runtime field offsets");const c=je()>=36e7;return l.offset.instrumentation=c?function(e){const t=e["art::Runtime::DeoptimizeBootImage"];return void 0===t?null:f(t,Qe[Process.arch],{limit:30})}(e):function(e){const t=e["art::Runtime::DeoptimizeBootImage"];return void 0===t?null:f(t,We[Process.arch],{limit:30})}(e),l.offset.jniIdsIndirection=function(e){const t=e.find("_ZN3art7Runtime12SetJniIdTypeENS_9JniIdTypeE");if(null===t)return null;const n=f(t,Ye[Process.arch],{limit:20});if(null===n)throw new Error("Unable to determine Runtime.jni_ids_indirection_ offset");return n}(e),l}),ve=m(function(){const e={"4-21":136,"4-22":136,"4-23":172,"4-24":196,"4-25":196,"4-26":196,"4-27":196,"4-28":212,"4-29":172,"4-30":180,"4-31":180,"8-21":224,"8-22":224,"8-23":296,"8-24":344,"8-25":344,"8-26":352,"8-27":352,"8-28":392,"8-29":328,"8-30":336,"8-31":336}[`${ne}-${Le()}`];if(void 0===e)throw new Error("Unable to determine Instrumentation field offsets");return{offset:{forcedInterpretOnly:4,deoptimizationEnabled:e}}}),ye=m(function(e){const t=Be();let n;return e.perform(e=>{const r=e.findClass("android/os/Process"),o=Pt(e.getStaticMethodId(r,"getElapsedCpuTime","()J"));e.deleteLocalRef(r);const i=Process.getModuleByName("libandroid_runtime.so"),a=i.base,s=a.add(i.size),l=Le(),c=l<=21?8:ne;let d=null,u=null,p=2;for(let e=0;64!==e&&0!==p;e+=4){const t=o.add(e);if(null===d){const n=t.readPointer();n.compare(a)>=0&&n.compare(s)<0&&(d=e,p--)}null===u&&281==(2950692863&t.readU32())&&(u=e,p--)}if(0!==p)throw new Error("Unable to determine ArtMethod field offsets");const h=d+c;n={size:l<=21?h+32:h+ne,offset:{jniCode:d,quickCode:h,accessFlags:u}},"artInterpreterToCompiledCodeBridge"in t&&(n.offset.interpreterCode=d-c)}),n}),be=m(function(e){const t=Le();let n;return e.perform(e=>{const r=st(e),o=e.handle;let i=null,a=null,s=null,l=null,c=null,d=null;for(let e=144;256!==e;e+=ne)if(r.add(e).readPointer().equals(o)){a=e-6*ne,c=e-4*ne,d=e+2*ne,t<=22&&(a-=ne,i=a-ne-72-12,s=e+6*ne,c-=ne,d-=ne),l=e+9*ne,t<=22&&(l+=2*ne+4,8===ne&&(l+=4)),t>=23&&(l+=ne);break}if(null===l)throw new Error("Unable to determine ArtThread field offsets");n={offset:{isExceptionReportedToInstrumentation:i,exception:a,throwLocation:s,topHandleScope:l,managedStack:c,self:d}}}),n}),Ce=m(function(){return Le()>=23?{offset:{topQuickFrame:0,link:ne}}:{offset:{topQuickFrame:2*ne,link:0}}}),we=m(function(e,t){return Kt(e,t,new NativeCallback(ht,"void",["pointer"]))}),Se=m(function(){return ut("ro.build.version.release")}),Ee=m(function(){return ut("ro.build.version.codename")}),Le=m(function(){return parseInt(ut("ro.build.version.sdk"),10)}),je=m(function(){try{const e=File.readAllText("/proc/self/mountinfo");let t=null;const n=new Map;for(const r of e.trimEnd().split("\n")){const e=r.split(" "),o=e[4];if(!o.startsWith("/apex/com.android.art"))continue;const i=e[10];o.includes("@")?n.set(i,o.split("@")[1]):t=i}const r=n.get(t);return void 0!==r?parseInt(r):lt()}catch{return lt()}}),Ne=m(function(e){let t=NULL;switch(Process.arch){case"ia32":t=Ct(32,t=>{t.putMovRegRegOffsetPtr("ecx","esp",4),t.putMovRegRegOffsetPtr("edx","esp",8),t.putCallAddressWithArguments(e,["ecx","edx"]),t.putMovRegReg("esp","ebp"),t.putPopReg("ebp"),t.putRet()});break;case"x64":t=Ct(32,t=>{t.putPushReg("rdi"),t.putCallAddressWithArguments(e,["rsi"]),t.putPopReg("rdi"),t.putMovRegPtrReg("rdi","rax"),t.putMovRegOffsetPtrReg("rdi",8,"edx"),t.putRet()});break;case"arm":t=Ct(16,t=>{t.putCallAddressWithArguments(e,["r0","r1"]),t.putPopRegs(["r0","lr"]),t.putMovRegReg("pc","lr")});break;case"arm64":t=Ct(64,t=>{t.putPushRegReg("x0","lr"),t.putCallAddressWithArguments(e,["x1"]),t.putPopRegReg("x2","lr"),t.putStrRegRegOffset("x0","x2",0),t.putStrRegRegOffset("w1","x2",8),t.putRet()})}return new NativeFunction(t,"void",["pointer","pointer"],ke)}),Ae="ia32"===Process.arch?function(e,t){const n=new NativeFunction(e,"void",["pointer"].concat(t),ke);return function(){const e=Memory.alloc(ne);return n(e,...arguments),e.readPointer()}}:function(e,t){return new NativeFunction(e,"pointer",t,ke)},ke={exceptions:"propagate"},Me={};let Pe=null,Ie=null,Re=null,xe=null;const Te=[],Ue=new Map,Oe=[];let De=null,ze=0,Je=!1,Fe=!1,Ve=null;const $e=[];let Ge=null,Ze=null;function Be(){return null===Pe&&(Pe=function(){const e=Process.enumerateModules().filter(e=>/^lib(art|dvm).so$/.test(e.name)).filter(e=>!/\/system\/fake-libs/.test(e.path));if(0===e.length)return null;const t=e[0],n=-1!==t.name.indexOf("art")?"art":"dalvik",r="art"===n,o={module:t,find(e){const{module:t}=this;let n=t.findExportByName(e);return null===n&&(n=t.findSymbolByName(e)),n},flavor:n,addLocalReference:null};o.isApiLevel34OrApexEquivalent=r&&(null!==o.find("_ZN3art7AppInfo29GetPrimaryApkReferenceProfileEv")||null!==o.find("_ZN3art6Thread15RunFlipFunctionEPS0_"));const i=r?{functions:{JNI_GetCreatedJavaVMs:["JNI_GetCreatedJavaVMs","int",["pointer","int","pointer"]],artInterpreterToCompiledCodeBridge:function(e){this.artInterpreterToCompiledCodeBridge=e},_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadENS_6ObjPtrINS_6mirror6ObjectEEE:["art::JavaVMExt::AddGlobalRef","pointer",["pointer","pointer","pointer"]],_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadEPNS_6mirror6ObjectE:["art::JavaVMExt::AddGlobalRef","pointer",["pointer","pointer","pointer"]],_ZN3art17ReaderWriterMutex13ExclusiveLockEPNS_6ThreadE:["art::ReaderWriterMutex::ExclusiveLock","void",["pointer","pointer"]],_ZN3art17ReaderWriterMutex15ExclusiveUnlockEPNS_6ThreadE:["art::ReaderWriterMutex::ExclusiveUnlock","void",["pointer","pointer"]],_ZN3art22IndirectReferenceTable3AddEjPNS_6mirror6ObjectE:function(e){this["art::IndirectReferenceTable::Add"]=new NativeFunction(e,"pointer",["pointer","uint","pointer"],ke)},_ZN3art22IndirectReferenceTable3AddENS_15IRTSegmentStateENS_6ObjPtrINS_6mirror6ObjectEEE:function(e){this["art::IndirectReferenceTable::Add"]=new NativeFunction(e,"pointer",["pointer","uint","pointer"],ke)},_ZN3art9JavaVMExt12DecodeGlobalEPv:function(e){let t;t=Le()>=26?Ae(e,["pointer","pointer"]):new NativeFunction(e,"pointer",["pointer","pointer"],ke),this["art::JavaVMExt::DecodeGlobal"]=function(e,n,r){return t(e,r)}},_ZN3art9JavaVMExt12DecodeGlobalEPNS_6ThreadEPv:["art::JavaVMExt::DecodeGlobal","pointer",["pointer","pointer","pointer"]],_ZNK3art6Thread19DecodeGlobalJObjectEP8_jobject:["art::Thread::DecodeJObject","pointer",["pointer","pointer"]],_ZNK3art6Thread13DecodeJObjectEP8_jobject:["art::Thread::DecodeJObject","pointer",["pointer","pointer"]],_ZN3art10ThreadList10SuspendAllEPKcb:["art::ThreadList::SuspendAll","void",["pointer","pointer","bool"]],_ZN3art10ThreadList10SuspendAllEv:function(e){const t=new NativeFunction(e,"void",["pointer"],ke);this["art::ThreadList::SuspendAll"]=function(e,n,r){return t(e)}},_ZN3art10ThreadList9ResumeAllEv:["art::ThreadList::ResumeAll","void",["pointer"]],_ZN3art11ClassLinker12VisitClassesEPNS_12ClassVisitorE:["art::ClassLinker::VisitClasses","void",["pointer","pointer"]],_ZN3art11ClassLinker12VisitClassesEPFbPNS_6mirror5ClassEPvES4_:function(e){const t=new NativeFunction(e,"void",["pointer","pointer","pointer"],ke);this["art::ClassLinker::VisitClasses"]=function(e,n){t(e,n,NULL)}},_ZNK3art11ClassLinker17VisitClassLoadersEPNS_18ClassLoaderVisitorE:["art::ClassLinker::VisitClassLoaders","void",["pointer","pointer"]],_ZN3art2gc4Heap12VisitObjectsEPFvPNS_6mirror6ObjectEPvES5_:["art::gc::Heap::VisitObjects","void",["pointer","pointer","pointer"]],_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE:["art::gc::Heap::GetInstances","void",["pointer","pointer","pointer","int","pointer"]],_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEbiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE:function(e){const t=new NativeFunction(e,"void",["pointer","pointer","pointer","bool","int","pointer"],ke);this["art::gc::Heap::GetInstances"]=function(e,n,r,o,i){t(e,n,r,0,o,i)}},_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEjb:["art::StackVisitor::StackVisitor","void",["pointer","pointer","pointer","uint","uint","bool"]],_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEmb:["art::StackVisitor::StackVisitor","void",["pointer","pointer","pointer","uint","size_t","bool"]],_ZN3art12StackVisitor9WalkStackILNS0_16CountTransitionsE0EEEvb:["art::StackVisitor::WalkStack","void",["pointer","bool"]],_ZNK3art12StackVisitor9GetMethodEv:["art::StackVisitor::GetMethod","pointer",["pointer"]],_ZNK3art12StackVisitor16DescribeLocationEv:function(e){this["art::StackVisitor::DescribeLocation"]=en(e,["pointer"])},_ZNK3art12StackVisitor24GetCurrentQuickFrameInfoEv:function(e){var t;this["art::StackVisitor::GetCurrentQuickFrameInfo"]=(t=e,function(e){const n=Memory.alloc(12);return Ne(t)(n,e),{frameSizeInBytes:n.readU32(),coreSpillMask:n.add(4).readU32(),fpSpillMask:n.add(8).readU32()}})},_ZN3art7Context6CreateEv:["art::Context::Create","pointer",[]],_ZN3art6Thread18GetLongJumpContextEv:["art::Thread::GetLongJumpContext","pointer",["pointer"]],_ZN3art6mirror5Class13GetDescriptorEPNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE:function(e){this["art::mirror::Class::GetDescriptor"]=e},_ZN3art6mirror5Class11GetLocationEv:function(e){this["art::mirror::Class::GetLocation"]=en(e,["pointer"])},_ZN3art9ArtMethod12PrettyMethodEb:function(e){this["art::ArtMethod::PrettyMethod"]=en(e,["pointer","bool"])},_ZN3art12PrettyMethodEPNS_9ArtMethodEb:function(e){this["art::ArtMethod::PrettyMethodNullSafe"]=en(e,["pointer","bool"])},_ZN3art6Thread14CurrentFromGdbEv:["art::Thread::CurrentFromGdb","pointer",[]],_ZN3art6mirror6Object5CloneEPNS_6ThreadE:function(e){this["art::mirror::Object::Clone"]=new NativeFunction(e,"pointer",["pointer","pointer"],ke)},_ZN3art6mirror6Object5CloneEPNS_6ThreadEm:function(e){const t=new NativeFunction(e,"pointer",["pointer","pointer","pointer"],ke);this["art::mirror::Object::Clone"]=function(e,n){const r=NULL;return t(e,n,r)}},_ZN3art6mirror6Object5CloneEPNS_6ThreadEj:function(e){const t=new NativeFunction(e,"pointer",["pointer","pointer","uint"],ke);this["art::mirror::Object::Clone"]=function(e,n){return t(e,n,0)}},_ZN3art3Dbg14SetJdwpAllowedEb:["art::Dbg::SetJdwpAllowed","void",["bool"]],_ZN3art3Dbg13ConfigureJdwpERKNS_4JDWP11JdwpOptionsE:["art::Dbg::ConfigureJdwp","void",["pointer"]],_ZN3art31InternalDebuggerControlCallback13StartDebuggerEv:["art::InternalDebuggerControlCallback::StartDebugger","void",["pointer"]],_ZN3art3Dbg9StartJdwpEv:["art::Dbg::StartJdwp","void",[]],_ZN3art3Dbg8GoActiveEv:["art::Dbg::GoActive","void",[]],_ZN3art3Dbg21RequestDeoptimizationERKNS_21DeoptimizationRequestE:["art::Dbg::RequestDeoptimization","void",["pointer"]],_ZN3art3Dbg20ManageDeoptimizationEv:["art::Dbg::ManageDeoptimization","void",[]],_ZN3art15instrumentation15Instrumentation20EnableDeoptimizationEv:["art::Instrumentation::EnableDeoptimization","void",["pointer"]],_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEPKc:["art::Instrumentation::DeoptimizeEverything","void",["pointer","pointer"]],_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEv:function(e){const t=new NativeFunction(e,"void",["pointer"],ke);this["art::Instrumentation::DeoptimizeEverything"]=function(e,n){t(e)}},_ZN3art7Runtime19DeoptimizeBootImageEv:["art::Runtime::DeoptimizeBootImage","void",["pointer"]],_ZN3art15instrumentation15Instrumentation10DeoptimizeEPNS_9ArtMethodE:["art::Instrumentation::Deoptimize","void",["pointer","pointer"]],_ZN3art3jni12JniIdManager14DecodeMethodIdEP10_jmethodID:["art::jni::JniIdManager::DecodeMethodId","pointer",["pointer","pointer"]],_ZN3art3jni12JniIdManager13DecodeFieldIdEP9_jfieldID:["art::jni::JniIdManager::DecodeFieldId","pointer",["pointer","pointer"]],_ZN3art11interpreter18GetNterpEntryPointEv:["art::interpreter::GetNterpEntryPoint","pointer",[]],_ZN3art7Monitor17TranslateLocationEPNS_9ArtMethodEjPPKcPi:["art::Monitor::TranslateLocation","void",["pointer","uint32","pointer","pointer"]]},variables:{_ZN3art3Dbg9gRegistryE:function(e){this.isJdwpStarted=()=>!e.readPointer().isNull()},_ZN3art3Dbg15gDebuggerActiveE:function(e){this.isDebuggerActive=()=>!!e.readU8()}},optionals:new Set(["artInterpreterToCompiledCodeBridge","_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadENS_6ObjPtrINS_6mirror6ObjectEEE","_ZN3art9JavaVMExt12AddGlobalRefEPNS_6ThreadEPNS_6mirror6ObjectE","_ZN3art9JavaVMExt12DecodeGlobalEPv","_ZN3art9JavaVMExt12DecodeGlobalEPNS_6ThreadEPv","_ZNK3art6Thread19DecodeGlobalJObjectEP8_jobject","_ZNK3art6Thread13DecodeJObjectEP8_jobject","_ZN3art10ThreadList10SuspendAllEPKcb","_ZN3art10ThreadList10SuspendAllEv","_ZN3art11ClassLinker12VisitClassesEPNS_12ClassVisitorE","_ZN3art11ClassLinker12VisitClassesEPFbPNS_6mirror5ClassEPvES4_","_ZNK3art11ClassLinker17VisitClassLoadersEPNS_18ClassLoaderVisitorE","_ZN3art6mirror6Object5CloneEPNS_6ThreadE","_ZN3art6mirror6Object5CloneEPNS_6ThreadEm","_ZN3art6mirror6Object5CloneEPNS_6ThreadEj","_ZN3art22IndirectReferenceTable3AddEjPNS_6mirror6ObjectE","_ZN3art22IndirectReferenceTable3AddENS_15IRTSegmentStateENS_6ObjPtrINS_6mirror6ObjectEEE","_ZN3art2gc4Heap12VisitObjectsEPFvPNS_6mirror6ObjectEPvES5_","_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE","_ZN3art2gc4Heap12GetInstancesERNS_24VariableSizedHandleScopeENS_6HandleINS_6mirror5ClassEEEbiRNSt3__16vectorINS4_INS5_6ObjectEEENS8_9allocatorISB_EEEE","_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEjb","_ZN3art12StackVisitorC2EPNS_6ThreadEPNS_7ContextENS0_13StackWalkKindEmb","_ZN3art12StackVisitor9WalkStackILNS0_16CountTransitionsE0EEEvb","_ZNK3art12StackVisitor9GetMethodEv","_ZNK3art12StackVisitor16DescribeLocationEv","_ZNK3art12StackVisitor24GetCurrentQuickFrameInfoEv","_ZN3art7Context6CreateEv","_ZN3art6Thread18GetLongJumpContextEv","_ZN3art6mirror5Class13GetDescriptorEPNSt3__112basic_stringIcNS2_11char_traitsIcEENS2_9allocatorIcEEEE","_ZN3art6mirror5Class11GetLocationEv","_ZN3art9ArtMethod12PrettyMethodEb","_ZN3art12PrettyMethodEPNS_9ArtMethodEb","_ZN3art3Dbg13ConfigureJdwpERKNS_4JDWP11JdwpOptionsE","_ZN3art31InternalDebuggerControlCallback13StartDebuggerEv","_ZN3art3Dbg15gDebuggerActiveE","_ZN3art15instrumentation15Instrumentation20EnableDeoptimizationEv","_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEPKc","_ZN3art15instrumentation15Instrumentation20DeoptimizeEverythingEv","_ZN3art7Runtime19DeoptimizeBootImageEv","_ZN3art15instrumentation15Instrumentation10DeoptimizeEPNS_9ArtMethodE","_ZN3art3Dbg9StartJdwpEv","_ZN3art3Dbg8GoActiveEv","_ZN3art3Dbg21RequestDeoptimizationERKNS_21DeoptimizationRequestE","_ZN3art3Dbg20ManageDeoptimizationEv","_ZN3art3Dbg9gRegistryE","_ZN3art3jni12JniIdManager14DecodeMethodIdEP10_jmethodID","_ZN3art3jni12JniIdManager13DecodeFieldIdEP9_jfieldID","_ZN3art11interpreter18GetNterpEntryPointEv","_ZN3art7Monitor17TranslateLocationEPNS_9ArtMethodEjPPKcPi"])}:{functions:{_Z20dvmDecodeIndirectRefP6ThreadP8_jobject:["dvmDecodeIndirectRef","pointer",["pointer","pointer"]],_Z15dvmUseJNIBridgeP6MethodPv:["dvmUseJNIBridge","void",["pointer","pointer"]],_Z20dvmHeapSourceGetBasev:["dvmHeapSourceGetBase","pointer",[]],_Z21dvmHeapSourceGetLimitv:["dvmHeapSourceGetLimit","pointer",[]],_Z16dvmIsValidObjectPK6Object:["dvmIsValidObject","uint8",["pointer"]],JNI_GetCreatedJavaVMs:["JNI_GetCreatedJavaVMs","int",["pointer","int","pointer"]]},variables:{gDvmJni:function(e){this.gDvmJni=e},gDvm:function(e){this.gDvm=e}}},{functions:a={},variables:l={},optionals:c=new Set}=i,d=[];for(const[e,t]of Object.entries(a)){const n=o.find(e);null!==n?"function"==typeof t?t.call(o,n):o[t[0]]=new NativeFunction(n,t[1],t[2],ke):c.has(e)||d.push(e)}for(const[e,t]of Object.entries(l)){const n=o.find(e);null!==n?t.call(o,n):c.has(e)||d.push(e)}if(d.length>0)throw new Error("Java API only partially available; please file a bug. Missing: "+d.join(", "));const u=Memory.alloc(ne),p=Memory.alloc(te);if(s("JNI_GetCreatedJavaVMs",o.JNI_GetCreatedJavaVMs(u,1,p)),0===p.readInt())return null;if(o.vm=u.readPointer(),r){const e=Le();let t;t=e>=27?33554432:e>=24?16777216:0,o.kAccCompileDontBother=t;const n=o.vm.add(ne).readPointer();o.artRuntime=n;const r=ge(o),i=r.offset,a=i.instrumentation;o.artInstrumentation=null!==a?n.add(a):null,je()>=36e7&&null!=o.artInstrumentation&&(o.artInstrumentation=o.artInstrumentation.readPointer()),o.artHeap=n.add(i.heap).readPointer(),o.artThreadList=n.add(i.threadList).readPointer();const s=n.add(i.classLinker).readPointer(),l=function(e,t){const n=tt(e,t);if(null===n)throw new Error("Unable to determine ClassLinker field offsets");return n}(n,r).offset,c=s.add(l.quickResolutionTrampoline).readPointer(),d=s.add(l.quickImtConflictTrampoline).readPointer(),u=s.add(l.quickGenericJniTrampoline).readPointer(),p=s.add(l.quickToInterpreterBridgeTrampoline).readPointer();o.artClassLinker={address:s,quickResolutionTrampoline:c,quickImtConflictTrampoline:d,quickGenericJniTrampoline:u,quickToInterpreterBridgeTrampoline:p};const h=new ee(o);o.artQuickGenericJniTrampoline=it(u,h),o.artQuickToInterpreterBridge=it(p,h),o.artQuickResolutionTrampoline=it(c,h),void 0===o["art::JavaVMExt::AddGlobalRef"]&&(o["art::JavaVMExt::AddGlobalRef"]=function(e){const t=4===ne?{globalsLock:32,globals:72}:{globalsLock:64,globals:112},n=e.vm.add(t.globalsLock),r=e.vm.add(t.globals),o=e["art::IndirectReferenceTable::Add"],i=e["art::ReaderWriterMutex::ExclusiveLock"],a=e["art::ReaderWriterMutex::ExclusiveUnlock"];return function(e,t,s){i(n,t);try{return o(r,0,s)}finally{a(n,t)}}}(o)),void 0===o["art::JavaVMExt::DecodeGlobal"]&&(o["art::JavaVMExt::DecodeGlobal"]=function(e){const t=e["art::Thread::DecodeJObject"];if(void 0===t)throw new Error("art::Thread::DecodeJObject is not available; please file a bug");return function(e,n,r){return t(n,r)}}(o)),void 0===o["art::ArtMethod::PrettyMethod"]&&(o["art::ArtMethod::PrettyMethod"]=o["art::ArtMethod::PrettyMethodNullSafe"]),void 0!==o["art::interpreter::GetNterpEntryPoint"]?o.artNterpEntryPoint=o["art::interpreter::GetNterpEntryPoint"]():o.artNterpEntryPoint=o.find("ExecuteNterpImpl"),xe=function(e,t){const n=be(t).offset,r=Ce().offset,o=`\n#include <gum/guminterceptor.h>\n\nextern GMutex lock;\nextern GHashTable * methods;\nextern GHashTable * replacements;\nextern gpointer last_seen_art_method;\n\nextern gpointer get_oat_quick_method_header_impl (gpointer method, gpointer pc);\n\nvoid\ninit (void)\n{\n  g_mutex_init (&lock);\n  methods = g_hash_table_new_full (NULL, NULL, NULL, NULL);\n  replacements = g_hash_table_new_full (NULL, NULL, NULL, NULL);\n}\n\nvoid\nfinalize (void)\n{\n  g_hash_table_unref (replacements);\n  g_hash_table_unref (methods);\n  g_mutex_clear (&lock);\n}\n\ngboolean\nis_replacement_method (gpointer method)\n{\n  gboolean is_replacement;\n\n  g_mutex_lock (&lock);\n\n  is_replacement = g_hash_table_contains (replacements, method);\n\n  g_mutex_unlock (&lock);\n\n  return is_replacement;\n}\n\ngpointer\nget_replacement_method (gpointer original_method)\n{\n  gpointer replacement_method;\n\n  g_mutex_lock (&lock);\n\n  replacement_method = g_hash_table_lookup (methods, original_method);\n\n  g_mutex_unlock (&lock);\n\n  return replacement_method;\n}\n\nvoid\nset_replacement_method (gpointer original_method,\n                        gpointer replacement_method)\n{\n  g_mutex_lock (&lock);\n\n  g_hash_table_insert (methods, original_method, replacement_method);\n  g_hash_table_insert (replacements, replacement_method, original_method);\n\n  g_mutex_unlock (&lock);\n}\n\nvoid\nsynchronize_replacement_methods (guint quick_code_offset,\n                                 void * nterp_entrypoint,\n                                 void * quick_to_interpreter_bridge)\n{\n  GHashTableIter iter;\n  gpointer hooked_method, replacement_method;\n\n  g_mutex_lock (&lock);\n\n  g_hash_table_iter_init (&iter, methods);\n  while (g_hash_table_iter_next (&iter, &hooked_method, &replacement_method))\n  {\n    void ** quick_code;\n\n    *((uint32_t *) replacement_method) = *((uint32_t *) hooked_method);\n\n    quick_code = hooked_method + quick_code_offset;\n    if (*quick_code == nterp_entrypoint)\n      *quick_code = quick_to_interpreter_bridge;\n  }\n\n  g_mutex_unlock (&lock);\n}\n\nvoid\ndelete_replacement_method (gpointer original_method)\n{\n  gpointer replacement_method;\n\n  g_mutex_lock (&lock);\n\n  replacement_method = g_hash_table_lookup (methods, original_method);\n  if (replacement_method != NULL)\n  {\n    g_hash_table_remove (methods, original_method);\n    g_hash_table_remove (replacements, replacement_method);\n  }\n\n  g_mutex_unlock (&lock);\n}\n\ngpointer\ntranslate_method (gpointer method)\n{\n  gpointer translated_method;\n\n  g_mutex_lock (&lock);\n\n  translated_method = g_hash_table_lookup (replacements, method);\n\n  g_mutex_unlock (&lock);\n\n  return (translated_method != NULL) ? translated_method : method;\n}\n\ngpointer\nfind_replacement_method_from_quick_code (gpointer method,\n                                         gpointer thread)\n{\n  gpointer replacement_method;\n  gpointer managed_stack;\n  gpointer top_quick_frame;\n  gpointer link_managed_stack;\n  gpointer * link_top_quick_frame;\n\n  replacement_method = get_replacement_method (method);\n  if (replacement_method == NULL)\n    return NULL;\n\n  /*\n   * Stack check.\n   *\n   * Return NULL to indicate that the original method should be invoked, otherwise\n   * return a pointer to the replacement ArtMethod.\n   *\n   * If the caller is our own JNI replacement stub, then a stack transition must\n   * have been pushed onto the current thread's linked list.\n   *\n   * Therefore, we invoke the original method if the following conditions are met:\n   *   1- The current managed stack is empty.\n   *   2- The ArtMethod * inside the linked managed stack's top quick frame is the\n   *      same as our replacement.\n   */\n  managed_stack = thread + ${n.managedStack};\n  top_quick_frame = *((gpointer *) (managed_stack + ${r.topQuickFrame}));\n  if (top_quick_frame != NULL)\n    return replacement_method;\n\n  link_managed_stack = *((gpointer *) (managed_stack + ${r.link}));\n  if (link_managed_stack == NULL)\n    return replacement_method;\n\n  link_top_quick_frame = GSIZE_TO_POINTER (*((gsize *) (link_managed_stack + ${r.topQuickFrame})) & ~((gsize) 1));\n  if (link_top_quick_frame == NULL || *link_top_quick_frame != replacement_method)\n    return replacement_method;\n\n  return NULL;\n}\n\nvoid\non_interpreter_do_call (GumInvocationContext * ic)\n{\n  gpointer method, replacement_method;\n\n  method = gum_invocation_context_get_nth_argument (ic, 0);\n\n  replacement_method = get_replacement_method (method);\n  if (replacement_method != NULL)\n    gum_invocation_context_replace_nth_argument (ic, 0, replacement_method);\n}\n\ngpointer\non_art_method_get_oat_quick_method_header (gpointer method,\n                                           gpointer pc)\n{\n  if (is_replacement_method (method))\n    return NULL;\n\n  return get_oat_quick_method_header_impl (method, pc);\n}\n\nvoid\non_art_method_pretty_method (GumInvocationContext * ic)\n{\n  const guint this_arg_index = ${"arm64"===Process.arch?0:1};\n  gpointer method;\n\n  method = gum_invocation_context_get_nth_argument (ic, this_arg_index);\n  if (method == NULL)\n    gum_invocation_context_replace_nth_argument (ic, this_arg_index, last_seen_art_method);\n  else\n    last_seen_art_method = method;\n}\n\nvoid\non_leave_gc_concurrent_copying_copying_phase (GumInvocationContext * ic)\n{\n  GHashTableIter iter;\n  gpointer hooked_method, replacement_method;\n\n  g_mutex_lock (&lock);\n\n  g_hash_table_iter_init (&iter, methods);\n  while (g_hash_table_iter_next (&iter, &hooked_method, &replacement_method))\n    *((uint32_t *) replacement_method) = *((uint32_t *) hooked_method);\n\n  g_mutex_unlock (&lock);\n}\n`,i=ne,a=ne,s=ne,l=Memory.alloc(8+i+a+s),c=l.add(8),d=c.add(i),u=d.add(a),p=e.find(4===ne?"_ZN3art9ArtMethod23GetOatQuickMethodHeaderEj":"_ZN3art9ArtMethod23GetOatQuickMethodHeaderEm"),h=new CModule(o,{lock:l,methods:c,replacements:d,last_seen_art_method:u,get_oat_quick_method_header_impl:p??ptr("0xdeadbeef")}),f={exceptions:"propagate",scheduling:"exclusive"};return{handle:h,replacedMethods:{isReplacement:new NativeFunction(h.is_replacement_method,"bool",["pointer"],f),get:new NativeFunction(h.get_replacement_method,"pointer",["pointer"],f),set:new NativeFunction(h.set_replacement_method,"void",["pointer","pointer"],f),synchronize:new NativeFunction(h.synchronize_replacement_methods,"void",["uint","pointer","pointer"],f),delete:new NativeFunction(h.delete_replacement_method,"void",["pointer"],f),translate:new NativeFunction(h.translate_method,"pointer",["pointer"],f),findReplacementFromQuickCode:h.find_replacement_method_from_quick_code},getOatQuickMethodHeaderImpl:p,hooks:{Interpreter:{doCall:h.on_interpreter_do_call},ArtMethod:{getOatQuickMethodHeader:h.on_art_method_get_oat_quick_method_header,prettyMethod:h.on_art_method_pretty_method},Gc:{copyingPhase:{onLeave:h.on_leave_gc_concurrent_copying_copying_phase},runFlip:{onEnter:h.on_leave_gc_concurrent_copying_copying_phase}}}}}(o,h),function(e){const t=e["art::ArtMethod::PrettyMethod"];void 0!==t&&(Interceptor.attach(t.impl,xe.hooks.ArtMethod.prettyMethod),Interceptor.flush())}(o);let f=null;Object.defineProperty(o,"jvmti",{get(){return null===f&&(f=[qe(h,this.artRuntime)]),f[0]}})}const h=t.enumerateImports().filter(e=>0===e.name.indexOf("_Z")).reduce((e,t)=>(e[t.name]=t.address,e),{});return o.$new=new NativeFunction(h._Znwm||h._Znwj,"pointer",["ulong"],ke),o.$delete=new NativeFunction(h._ZdlPv,"void",["pointer"],ke),Re=r?zt:Vt,o}()),Pe}function qe(e,t){let n=null;return e.perform(()=>{const r=Be().find("_ZN3art7Runtime18EnsurePluginLoadedEPKcPNSt3__112basic_stringIcNS3_11char_traitsIcEENS3_9allocatorIcEEEE");if(null===r)return;const o=new NativeFunction(r,"bool",["pointer","pointer","pointer"]),i=Memory.alloc(ne);if(!o(t,Memory.allocUtf8String("libopenjdkjvmti.so"),i))return;const s=1073741824|l.v1_2,d=e.tryGetEnvHandle(s);if(null===d)return;n=new p(d,e);const u=Memory.alloc(8);u.writeU64(c.canTagObjects),n.addCapabilities(u)!==a&&(n=null)}),n}function He(e,t){"art"===Be().flavor&&e.getClassName(t)}const We={ia32:Ke,x64:Ke,arm:function(e){if("add.w"!==e.mnemonic)return null;const t=e.operands;if(3!==t.length)return null;const n=t[2];return"imm"!==n.type?null:n.value},arm64:function(e){if("add"!==e.mnemonic)return null;const t=e.operands;if(3!==t.length)return null;if("sp"===t[0].value||"sp"===t[1].value)return null;const n=t[2];if("imm"!==n.type)return null;const r=n.value.valueOf();return r<256||r>1024?null:r}};function Ke(e){if("lea"!==e.mnemonic)return null;const t=e.operands[1].value.disp;return t<256||t>1024?null:t}const Qe={ia32:Xe,x64:Xe,arm:function(e){return null},arm64:function(e){if("ldr"!==e.mnemonic)return null;const t=e.operands;if("x0"===t[0].value)return null;const n=t[1].value;if("x0"!==n.base)return null;const r=n.disp;return r<256||r>1024?null:r}};function Xe(e){if("mov"!==e.mnemonic)return null;const t=e.operands;if("rax"!==t[0].value)return null;const n=t[1];if("mem"!==n.type)return null;const r=n.value;if("rdi"!==r.base)return null;const o=r.disp;return o<256||o>1024?null:o}const Ye={ia32:et,x64:et,arm:function(e){return"ldr.w"===e.mnemonic?e.operands[1].value.disp:null},arm64:function(e,t){if(null===t)return null;const{mnemonic:n}=e,{mnemonic:r}=t;return"cmp"===n&&"ldr"===r||"bl"===n&&"str"===r?t.operands[1].value.disp:null}};function et(e){return"cmp"===e.mnemonic?e.operands[0].value.disp:null}function tt(e,t){if(null!==Ie)return Ie;const{classLinker:n,internTable:r}=t.offset,o=e.add(n).readPointer(),i=e.add(r).readPointer(),a=4===ne?100:200,s=a+100*ne,l=Le();let c=null;for(let e=a;e!==s;e+=ne)if(o.add(e).readPointer().equals(i)){let t;t=l>=30||"R"===Ee()?6:l>=29?4:l>=23?3:5;const n=e+t*ne;let r;r=l>=23?n-2*ne:n-3*ne,c={offset:{quickResolutionTrampoline:r,quickImtConflictTrampoline:n-ne,quickGenericJniTrampoline:n,quickToInterpreterBridgeTrampoline:n+ne}};break}return null!==c&&(Ie=c),c}function nt(e){let t=null;return e.perform(n=>{const r=rt(),o=ye(e),i={artArrayLengthSize:4,artArrayEntrySize:r.size,artArrayMax:50},a={artArrayLengthSize:ne,artArrayEntrySize:o.size,artArrayMax:100},s=(e,t,n)=>{const r=e.add(t).readPointer();if(r.isNull())return null;const o=4===n?r.readU32():r.readU64().valueOf();return o<=0?null:{length:o,data:r.add(n)}},l=(e,t,n,r)=>{try{const o=s(e,t,r.artArrayLengthSize);if(null===o)return!1;const i=Math.min(o.length,r.artArrayMax);for(let e=0;e!==i;e++)if(o.data.add(e*r.artArrayEntrySize).equals(n))return!0}catch{}return!1},c=n.findClass("java/lang/Thread"),d=n.newGlobalRef(c);try{let r;pt(e,n,t=>{r=Be()["art::JavaVMExt::DecodeGlobal"](e,t,d)});const o=It(n.getFieldId(d,"name","Ljava/lang/String;")),c=It(n.getStaticFieldId(d,"MAX_PRIORITY","I"));let u=-1,p=-1;for(let e=0;256!==e;e+=4)-1===u&&l(r,e,c,i)&&(u=e),-1===p&&l(r,e,o,i)&&(p=e);if(-1===p||-1===u)throw new Error("Unable to find fields in java/lang/Thread; please file a bug");const h=p!==u?u:0,f=p;let m=-1;const _=Pt(n.getMethodId(d,"getName","()Ljava/lang/String;"));for(let e=0;256!==e;e+=4)-1===m&&l(r,e,_,a)&&(m=e);if(-1===m)throw new Error("Unable to find methods in java/lang/Thread; please file a bug");let g=-1;const v=s(r,m,a.artArrayLengthSize).length;for(let e=m;256!==e;e+=4)if(r.add(e).readU16()===v){g=e;break}if(-1===g)throw new Error("Unable to find copied methods in java/lang/Thread; please file a bug");t={offset:{ifields:f,methods:m,sfields:h,copiedMethodsOffset:g}}}finally{n.deleteLocalRef(c),n.deleteGlobalRef(d)}}),t}function rt(e){const t=Le();return t>=23?{size:16,offset:{accessFlags:4}}:t>=21?{size:24,offset:{accessFlags:12}}:null}const ot={ia32:at,x64:at,arm:function(e){return"ldr.w"===e.mnemonic?e.operands[1].value.disp:null},arm64:function(e){return"ldr"===e.mnemonic?e.operands[1].value.disp:null}};function it(e,t){let n;return t.perform(t=>{const r=st(t),o=(0,ot[Process.arch])(Instruction.parse(e));n=null!==o?r.add(o).readPointer():e}),n}function at(e){return"jmp"===e.mnemonic?e.operands[0].value.disp:null}function st(e){return e.handle.add(ne).readPointer()}function lt(){return 1e7*Le()}let ct=null;const dt=92;function ut(e){null===ct&&(ct=new NativeFunction(Process.getModuleByName("libc.so").getExportByName("__system_property_get"),"int",["pointer","pointer"],ke));const t=Memory.alloc(dt);return ct(Memory.allocUtf8String(e),t),t.readUtf8String()}function pt(e,t,n){const r=we(e,t),o=st(t).toString();if(Me[o]=n,r(t.handle),void 0!==Me[o])throw delete Me[o],new Error("Unable to perform state transition; please file a bug")}function ht(e){const t=e.toString(),n=Me[t];delete Me[t],n(e)}function ft(e){const t=Be(),n=t.artThreadList;t["art::ThreadList::SuspendAll"](n,Memory.allocUtf8String("frida"),0);try{e()}finally{t["art::ThreadList::ResumeAll"](n)}}class mt{constructor(e){const t=Memory.alloc(4*ne),n=t.add(ne);t.writePointer(n);const r=new NativeCallback((t,n)=>!0===e(n)?1:0,"bool",["pointer","pointer"]);n.add(2*ne).writePointer(r),this.handle=t,this._onVisit=r}}function _t(e){return Be()["art::ClassLinker::VisitClasses"]instanceof NativeFunction?new mt(e):new NativeCallback(t=>!0===e(t)?1:0,"bool",["pointer","pointer"])}class gt{constructor(e){const t=Memory.alloc(4*ne),n=t.add(ne);t.writePointer(n);const r=new NativeCallback((t,n)=>{e(n)},"void",["pointer","pointer"]);n.add(2*ne).writePointer(r),this.handle=t,this._onVisit=r}}function vt(e){return new gt(e)}const yt={ia32:globalThis.X86Relocator,x64:globalThis.X86Relocator,arm:globalThis.ThumbRelocator,arm64:globalThis.Arm64Relocator},bt={ia32:globalThis.X86Writer,x64:globalThis.X86Writer,arm:globalThis.ThumbWriter,arm64:globalThis.Arm64Writer};function Ct(e,t){null===De&&(De=Memory.alloc(Process.pageSize));const n=De.add(ze),r=Process.arch,o=bt[r];return Memory.patchCode(n,e,r=>{const i=new o(r,{pc:n});if(t(i),i.flush(),i.offset>e)throw new Error(`Wrote ${i.offset}, exceeding maximum of ${e}`)}),ze+=e,"arm"===r?n.or(1):n}const wt={arm:{signatures:[{pattern:["b0 68","01 30","0c d0","1b 98",":","c0 ff","c0 ff","00 ff","00 2f"],validateMatch:St},{pattern:["d8 f8 08 00","01 30","0c d0","1b 98",":","f0 ff ff 0f","ff ff","00 ff","00 2f"],validateMatch:St},{pattern:["b0 68","01 30","40 f0 c3 80","00 25",":","c0 ff","c0 ff","c0 fb 00 d0","ff f8"],validateMatch:St}],instrument:function({address:e,size:t,validationResult:n}){const{methodReg:r,target:o}=n,i=Memory.alloc(Process.pageSize);let a=t;Memory.patchCode(i,256,t=>{const n=new ThumbWriter(t,{pc:i}),s=new ThumbRelocator(e,n);for(let e=0;2!==e;e++)s.readOne();s.writeAll(),s.readOne(),s.skipOne(),n.putBCondLabel("eq","runtime_or_replacement_method"),n.putBytes([45,237,16,10]);const l=["r0","r1","r2","r3"];n.putPushRegs(l),n.putCallAddressWithArguments(xe.replacedMethods.isReplacement,[r]),n.putCmpRegImm("r0",0),n.putPopRegs(l),n.putBytes([189,236,16,10]),n.putBCondLabel("ne","runtime_or_replacement_method"),n.putBLabel("regular_method"),s.readOne();const c=s.input.address.equals(o.whenRegularMethod);for(n.putLabel(c?"regular_method":"runtime_or_replacement_method"),s.writeOne();a<10;){const e=s.readOne();if(0===e){a=10;break}a=e}s.writeAll(),n.putBranchAddress(e.add(a+1)),n.putLabel(c?"runtime_or_replacement_method":"regular_method"),n.putBranchAddress(o.whenTrue),n.flush()}),Te.push(new jt(e,a,i)),Memory.patchCode(e,a,t=>{const n=new ThumbWriter(t,{pc:e});n.putLdrRegAddress("pc",i.or(1)),n.flush()})}},arm64:{signatures:[{pattern:["0a 40 b9","1f 05 00 31","40 01 00 54","88 39 00 f0",":","fc ff ff","1f fc ff ff","1f 00 00 ff","00 00 00 9f"],offset:1,validateMatch:Et},{pattern:["0a 40 b9","1f 05 00 31","40 01 00 54","00 0e 40 f9",":","fc ff ff","1f fc ff ff","1f 00 00 ff","00 fc ff ff"],offset:1,validateMatch:Et},{pattern:["0a 40 b9","1f 05 00 31","01 34 00 54","e0 03 1f aa",":","fc ff ff","1f fc ff ff","1f 00 00 ff","e0 ff ff ff"],offset:1,validateMatch:Et}],instrument:function({address:e,size:t,validationResult:n}){const{methodReg:r,scratchReg:o,target:i}=n,a=Memory.alloc(Process.pageSize);Memory.patchCode(a,256,t=>{const n=new Arm64Writer(t,{pc:a}),o=new Arm64Relocator(e,n);for(let e=0;2!==e;e++)o.readOne();o.writeAll(),o.readOne(),o.skipOne(),n.putBCondLabel("eq","runtime_or_replacement_method");const s=["d0","d1","d2","d3","d4","d5","d6","d7","x0","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17"],l=s.length;for(let e=0;e!==l;e+=2)n.putPushRegReg(s[e],s[e+1]);n.putCallAddressWithArguments(xe.replacedMethods.isReplacement,[r]),n.putCmpRegReg("x0","xzr");for(let e=l-2;e>=0;e-=2)n.putPopRegReg(s[e],s[e+1]);n.putBCondLabel("ne","runtime_or_replacement_method"),n.putBLabel("regular_method"),o.readOne();const c=o.input,d=c.address.equals(i.whenRegularMethod);n.putLabel(d?"regular_method":"runtime_or_replacement_method"),o.writeOne(),n.putBranchAddress(c.next),n.putLabel(d?"runtime_or_replacement_method":"regular_method"),n.putBranchAddress(i.whenTrue),n.flush()}),Te.push(new jt(e,t,a)),Memory.patchCode(e,t,t=>{const n=new Arm64Writer(t,{pc:e});n.putLdrRegAddress(o,a),n.putBrReg(o),n.flush()})}}};function St({address:e,size:t}){const n=Instruction.parse(e.or(1)),[r,o]=n.operands,i=o.value.base,a=r.value,s=Instruction.parse(n.next.add(2)),l=ptr(s.operands[0].value),c=s.address.add(s.size);let d,u;return"beq"===s.mnemonic?(d=c,u=l):(d=l,u=c),f(d.or(1),function(e){const{mnemonic:t}=e;if("ldr"!==t&&"ldr.w"!==t)return null;const{base:n,disp:r}=e.operands[1].value;return n!==i||20!==r?null:{methodReg:i,scratchReg:a,target:{whenTrue:l,whenRegularMethod:d,whenRuntimeMethod:u}}},{limit:3})}function Et({address:e,size:t}){const[n,r]=Instruction.parse(e).operands,o=r.value.base,i="x"+n.value.substring(1),a=Instruction.parse(e.add(8)),s=ptr(a.operands[0].value),l=e.add(12);let c,d;return"b.eq"===a.mnemonic?(c=l,d=s):(c=s,d=l),f(c,function(e){if("ldr"!==e.mnemonic)return null;const{base:t,disp:n}=e.operands[1].value;return t!==o||24!==n?null:{methodReg:o,scratchReg:i,target:{whenTrue:s,whenRegularMethod:c,whenRuntimeMethod:d}}},{limit:3})}function Lt(){return{}}class jt{constructor(e,t,n){this.address=e,this.size=t,this.originalCode=e.readByteArray(t),this.trampoline=n}revert(){Memory.patchCode(this.address,this.size,e=>{e.writeByteArray(this.originalCode)})}}function Nt(e){return new Re(e)}function At(e,t={}){const{limit:n=16}=t,r=e.getEnv();return null===Ve&&(Ve=function(e,t){const n=Be(),r=Memory.alloc(Process.pointerSize),o=new CModule("\n#include <glib.h>\n#include <stdbool.h>\n#include <string.h>\n#include <gum/gumtls.h>\n#include <json-glib/json-glib.h>\n\ntypedef struct _ArtBacktrace ArtBacktrace;\ntypedef struct _ArtStackFrame ArtStackFrame;\n\ntypedef struct _ArtStackVisitor ArtStackVisitor;\ntypedef struct _ArtStackVisitorVTable ArtStackVisitorVTable;\n\ntypedef struct _ArtClass ArtClass;\ntypedef struct _ArtMethod ArtMethod;\ntypedef struct _ArtThread ArtThread;\ntypedef struct _ArtContext ArtContext;\n\ntypedef struct _JNIEnv JNIEnv;\n\ntypedef struct _StdString StdString;\ntypedef struct _StdTinyString StdTinyString;\ntypedef struct _StdLargeString StdLargeString;\n\ntypedef enum {\n  STACK_WALK_INCLUDE_INLINED_FRAMES,\n  STACK_WALK_SKIP_INLINED_FRAMES,\n} StackWalkKind;\n\nstruct _StdTinyString\n{\n  guint8 unused;\n  gchar data[(3 * sizeof (gpointer)) - 1];\n};\n\nstruct _StdLargeString\n{\n  gsize capacity;\n  gsize size;\n  gchar * data;\n};\n\nstruct _StdString\n{\n  union\n  {\n    guint8 flags;\n    StdTinyString tiny;\n    StdLargeString large;\n  };\n};\n\nstruct _ArtBacktrace\n{\n  GChecksum * id;\n  GArray * frames;\n  gchar * frames_json;\n};\n\nstruct _ArtStackFrame\n{\n  ArtMethod * method;\n  gsize dexpc;\n  StdString description;\n};\n\nstruct _ArtStackVisitorVTable\n{\n  void (* unused1) (void);\n  void (* unused2) (void);\n  bool (* visit) (ArtStackVisitor * visitor);\n};\n\nstruct _ArtStackVisitor\n{\n  ArtStackVisitorVTable * vtable;\n\n  guint8 padding[512];\n\n  ArtStackVisitorVTable vtable_storage;\n\n  ArtBacktrace * backtrace;\n};\n\nstruct _ArtMethod\n{\n  guint32 declaring_class;\n  guint32 access_flags;\n};\n\nextern GumTlsKey current_backtrace;\n\nextern void (* perform_art_thread_state_transition) (JNIEnv * env);\n\nextern ArtContext * art_make_context (ArtThread * thread);\n\nextern void art_stack_visitor_init (ArtStackVisitor * visitor, ArtThread * thread, void * context, StackWalkKind walk_kind,\n    size_t num_frames, bool check_suspended);\nextern void art_stack_visitor_walk_stack (ArtStackVisitor * visitor, bool include_transitions);\nextern ArtMethod * art_stack_visitor_get_method (ArtStackVisitor * visitor);\nextern void art_stack_visitor_describe_location (StdString * description, ArtStackVisitor * visitor);\nextern ArtMethod * translate_method (ArtMethod * method);\nextern void translate_location (ArtMethod * method, guint32 pc, const gchar ** source_file, gint32 * line_number);\nextern void get_class_location (StdString * result, ArtClass * klass);\nextern void cxx_delete (void * mem);\nextern unsigned long strtoul (const char * str, char ** endptr, int base);\n\nstatic bool visit_frame (ArtStackVisitor * visitor);\nstatic void art_stack_frame_destroy (ArtStackFrame * frame);\n\nstatic void append_jni_type_name (GString * s, const gchar * name, gsize length);\n\nstatic void std_string_destroy (StdString * str);\nstatic gchar * std_string_get_data (StdString * str);\n\nvoid\ninit (void)\n{\n  current_backtrace = gum_tls_key_new ();\n}\n\nvoid\nfinalize (void)\n{\n  gum_tls_key_free (current_backtrace);\n}\n\nArtBacktrace *\n_create (JNIEnv * env,\n         guint limit)\n{\n  ArtBacktrace * bt;\n\n  bt = g_new (ArtBacktrace, 1);\n  bt->id = g_checksum_new (G_CHECKSUM_SHA1);\n  bt->frames = (limit != 0)\n      ? g_array_sized_new (FALSE, FALSE, sizeof (ArtStackFrame), limit)\n      : g_array_new (FALSE, FALSE, sizeof (ArtStackFrame));\n  g_array_set_clear_func (bt->frames, (GDestroyNotify) art_stack_frame_destroy);\n  bt->frames_json = NULL;\n\n  gum_tls_key_set_value (current_backtrace, bt);\n\n  perform_art_thread_state_transition (env);\n\n  gum_tls_key_set_value (current_backtrace, NULL);\n\n  return bt;\n}\n\nvoid\n_on_thread_state_transition_complete (ArtThread * thread)\n{\n  ArtContext * context;\n  ArtStackVisitor visitor = {\n    .vtable_storage = {\n      .visit = visit_frame,\n    },\n  };\n\n  context = art_make_context (thread);\n\n  art_stack_visitor_init (&visitor, thread, context, STACK_WALK_SKIP_INLINED_FRAMES, 0, true);\n  visitor.vtable = &visitor.vtable_storage;\n  visitor.backtrace = gum_tls_key_get_value (current_backtrace);\n\n  art_stack_visitor_walk_stack (&visitor, false);\n\n  cxx_delete (context);\n}\n\nstatic bool\nvisit_frame (ArtStackVisitor * visitor)\n{\n  ArtBacktrace * bt = visitor->backtrace;\n  ArtStackFrame frame;\n  const gchar * description, * dexpc_part;\n\n  frame.method = art_stack_visitor_get_method (visitor);\n\n  art_stack_visitor_describe_location (&frame.description, visitor);\n\n  description = std_string_get_data (&frame.description);\n  if (strstr (description, \" '<\") != NULL)\n    goto skip;\n\n  dexpc_part = strstr (description, \" at dex PC 0x\");\n  if (dexpc_part == NULL)\n    goto skip;\n  frame.dexpc = strtoul (dexpc_part + 13, NULL, 16);\n\n  g_array_append_val (bt->frames, frame);\n\n  g_checksum_update (bt->id, (guchar *) &frame.method, sizeof (frame.method));\n  g_checksum_update (bt->id, (guchar *) &frame.dexpc, sizeof (frame.dexpc));\n\n  return true;\n\nskip:\n  std_string_destroy (&frame.description);\n  return true;\n}\n\nstatic void\nart_stack_frame_destroy (ArtStackFrame * frame)\n{\n  std_string_destroy (&frame->description);\n}\n\nvoid\n_destroy (ArtBacktrace * backtrace)\n{\n  g_free (backtrace->frames_json);\n  g_array_free (backtrace->frames, TRUE);\n  g_checksum_free (backtrace->id);\n  g_free (backtrace);\n}\n\nconst gchar *\n_get_id (ArtBacktrace * backtrace)\n{\n  return g_checksum_get_string (backtrace->id);\n}\n\nconst gchar *\n_get_frames (ArtBacktrace * backtrace)\n{\n  GArray * frames = backtrace->frames;\n  JsonBuilder * b;\n  guint i;\n  JsonNode * root;\n\n  if (backtrace->frames_json != NULL)\n    return backtrace->frames_json;\n\n  b = json_builder_new_immutable ();\n\n  json_builder_begin_array (b);\n\n  for (i = 0; i != frames->len; i++)\n  {\n    ArtStackFrame * frame = &g_array_index (frames, ArtStackFrame, i);\n    gchar * description, * ret_type, * paren_open, * paren_close, * arg_types, * token, * method_name, * class_name;\n    GString * signature;\n    gchar * cursor;\n    ArtMethod * translated_method;\n    StdString location;\n    gsize dexpc;\n    const gchar * source_file;\n    gint32 line_number;\n\n    description = std_string_get_data (&frame->description);\n\n    ret_type = strchr (description, '\\'') + 1;\n\n    paren_open = strchr (ret_type, '(');\n    paren_close = strchr (paren_open, ')');\n    *paren_open = '\\0';\n    *paren_close = '\\0';\n\n    arg_types = paren_open + 1;\n\n    token = strrchr (ret_type, '.');\n    *token = '\\0';\n\n    method_name = token + 1;\n\n    token = strrchr (ret_type, ' ');\n    *token = '\\0';\n\n    class_name = token + 1;\n\n    signature = g_string_sized_new (128);\n\n    append_jni_type_name (signature, class_name, method_name - class_name - 1);\n    g_string_append_c (signature, ',');\n    g_string_append (signature, method_name);\n    g_string_append (signature, \",(\");\n\n    if (arg_types != paren_close)\n    {\n      for (cursor = arg_types; cursor != NULL;)\n      {\n        gsize length;\n        gchar * next;\n\n        token = strstr (cursor, \", \");\n        if (token != NULL)\n        {\n          length = token - cursor;\n          next = token + 2;\n        }\n        else\n        {\n          length = paren_close - cursor;\n          next = NULL;\n        }\n\n        append_jni_type_name (signature, cursor, length);\n\n        cursor = next;\n      }\n    }\n\n    g_string_append_c (signature, ')');\n\n    append_jni_type_name (signature, ret_type, class_name - ret_type - 1);\n\n    translated_method = translate_method (frame->method);\n    dexpc = (translated_method == frame->method) ? frame->dexpc : 0;\n\n    get_class_location (&location, GSIZE_TO_POINTER (translated_method->declaring_class));\n\n    translate_location (translated_method, dexpc, &source_file, &line_number);\n\n    json_builder_begin_object (b);\n\n    json_builder_set_member_name (b, \"signature\");\n    json_builder_add_string_value (b, signature->str);\n\n    json_builder_set_member_name (b, \"origin\");\n    json_builder_add_string_value (b, std_string_get_data (&location));\n\n    json_builder_set_member_name (b, \"className\");\n    json_builder_add_string_value (b, class_name);\n\n    json_builder_set_member_name (b, \"methodName\");\n    json_builder_add_string_value (b, method_name);\n\n    json_builder_set_member_name (b, \"methodFlags\");\n    json_builder_add_int_value (b, translated_method->access_flags);\n\n    json_builder_set_member_name (b, \"fileName\");\n    json_builder_add_string_value (b, source_file);\n\n    json_builder_set_member_name (b, \"lineNumber\");\n    json_builder_add_int_value (b, line_number);\n\n    json_builder_end_object (b);\n\n    std_string_destroy (&location);\n    g_string_free (signature, TRUE);\n  }\n\n  json_builder_end_array (b);\n\n  root = json_builder_get_root (b);\n  backtrace->frames_json = json_to_string (root, FALSE);\n  json_node_unref (root);\n\n  return backtrace->frames_json;\n}\n\nstatic void\nappend_jni_type_name (GString * s,\n                      const gchar * name,\n                      gsize length)\n{\n  gchar shorty = '\\0';\n  gsize i;\n\n  switch (name[0])\n  {\n    case 'b':\n      if (strncmp (name, \"boolean\", length) == 0)\n        shorty = 'Z';\n      else if (strncmp (name, \"byte\", length) == 0)\n        shorty = 'B';\n      break;\n    case 'c':\n      if (strncmp (name, \"char\", length) == 0)\n        shorty = 'C';\n      break;\n    case 'd':\n      if (strncmp (name, \"double\", length) == 0)\n        shorty = 'D';\n      break;\n    case 'f':\n      if (strncmp (name, \"float\", length) == 0)\n        shorty = 'F';\n      break;\n    case 'i':\n      if (strncmp (name, \"int\", length) == 0)\n        shorty = 'I';\n      break;\n    case 'l':\n      if (strncmp (name, \"long\", length) == 0)\n        shorty = 'J';\n      break;\n    case 's':\n      if (strncmp (name, \"short\", length) == 0)\n        shorty = 'S';\n      break;\n    case 'v':\n      if (strncmp (name, \"void\", length) == 0)\n        shorty = 'V';\n      break;\n  }\n\n  if (shorty != '\\0')\n  {\n    g_string_append_c (s, shorty);\n\n    return;\n  }\n\n  if (length > 2 && name[length - 2] == '[' && name[length - 1] == ']')\n  {\n    g_string_append_c (s, '[');\n    append_jni_type_name (s, name, length - 2);\n\n    return;\n  }\n\n  g_string_append_c (s, 'L');\n\n  for (i = 0; i != length; i++)\n  {\n    gchar ch = name[i];\n    if (ch != '.')\n      g_string_append_c (s, ch);\n    else\n      g_string_append_c (s, '/');\n  }\n\n  g_string_append_c (s, ';');\n}\n\nstatic void\nstd_string_destroy (StdString * str)\n{\n  bool is_large = (str->flags & 1) != 0;\n  if (is_large)\n    cxx_delete (str->large.data);\n}\n\nstatic gchar *\nstd_string_get_data (StdString * str)\n{\n  bool is_large = (str->flags & 1) != 0;\n  return is_large ? str->large.data : str->tiny.data;\n}\n",{current_backtrace:Memory.alloc(Process.pointerSize),perform_art_thread_state_transition:r,art_make_context:n["art::Thread::GetLongJumpContext"]??n["art::Context::Create"],art_stack_visitor_init:n["art::StackVisitor::StackVisitor"],art_stack_visitor_walk_stack:n["art::StackVisitor::WalkStack"],art_stack_visitor_get_method:n["art::StackVisitor::GetMethod"],art_stack_visitor_describe_location:n["art::StackVisitor::DescribeLocation"],translate_method:xe.replacedMethods.translate,translate_location:n["art::Monitor::TranslateLocation"],get_class_location:n["art::mirror::Class::GetLocation"],cxx_delete:n.$delete,strtoul:Process.getModuleByName("libc.so").getExportByName("strtoul")}),i=new NativeFunction(o._create,"pointer",["pointer","uint"],ke),a=new NativeFunction(o._destroy,"void",["pointer"],ke),s={exceptions:"propagate",scheduling:"exclusive"},l=new NativeFunction(o._get_id,"pointer",["pointer"],s),c=new NativeFunction(o._get_frames,"pointer",["pointer"],s),d=Kt(e,t,o._on_thread_state_transition_complete);function u(e){a(e)}return o._performData=d,r.writePointer(d),o.backtrace=(e,t)=>{const n=i(e,t),r=new kt(n);return Script.bindWeak(r,u.bind(null,n)),r},o.getId=e=>l(e).readUtf8String(),o.getFrames=e=>JSON.parse(c(e).readUtf8String()),o}(e,r)),Ve.backtrace(r,n)}class kt{constructor(e){this.handle=e}get id(){return Ve.getId(this.handle)}get frames(){return Ve.getFrames(this.handle)}}function Mt(){Ue.forEach(e=>{e.vtablePtr.writePointer(e.vtable),e.vtableCountPtr.writeS32(e.vtableCount)}),Ue.clear();for(const e of Oe.splice(0))e.deactivate();for(const e of Te.splice(0))e.revert()}function Pt(e){return Rt(e,"art::jni::JniIdManager::DecodeMethodId")}function It(e){return Rt(e,"art::jni::JniIdManager::DecodeFieldId")}function Rt(e,t){const n=Be(),r=ge(n).offset,o=r.jniIdManager,i=r.jniIdsIndirection;if(null!==o&&null!==i){const r=n.artRuntime;if(r.add(i).readInt()!==se){const i=r.add(o).readPointer();return n[t](i,e)}}return e}const xt={ia32:function(e,t,n,r,o){const i=be(o).offset,a=ye(o).offset;let s;return Memory.patchCode(e,128,r=>{const o=new X86Writer(r,{pc:e}),l=new X86Relocator(t,o);o.putPushax(),o.putMovRegReg("ebp","esp"),o.putAndRegU32("esp",4294967280),o.putSubRegImm("esp",512),o.putBytes([15,174,4,36]),o.putMovRegFsU32Ptr("ebx",i.self),o.putCallAddressWithAlignedArguments(xe.replacedMethods.findReplacementFromQuickCode,["eax","ebx"]),o.putTestRegReg("eax","eax"),o.putJccShortLabel("je","restore_registers","no-hint"),o.putMovRegOffsetPtrReg("ebp",28,"eax"),o.putLabel("restore_registers"),o.putBytes([15,174,12,36]),o.putMovRegReg("esp","ebp"),o.putPopax(),o.putJccShortLabel("jne","invoke_replacement","no-hint");do{s=l.readOne()}while(s<n&&!l.eoi);l.writeAll(),l.eoi||o.putJmpAddress(t.add(s)),o.putLabel("invoke_replacement"),o.putJmpRegOffsetPtr("eax",a.quickCode),o.flush()}),s},x64:function(e,t,n,r,o){const i=be(o).offset,a=ye(o).offset;let s;return Memory.patchCode(e,256,r=>{const o=new X86Writer(r,{pc:e}),l=new X86Relocator(t,o);o.putPushax(),o.putMovRegReg("rbp","rsp"),o.putAndRegU32("rsp",4294967280),o.putSubRegImm("rsp",512),o.putBytes([15,174,4,36]),o.putMovRegGsU32Ptr("rbx",i.self),o.putCallAddressWithAlignedArguments(xe.replacedMethods.findReplacementFromQuickCode,["rdi","rbx"]),o.putTestRegReg("rax","rax"),o.putJccShortLabel("je","restore_registers","no-hint"),o.putMovRegOffsetPtrReg("rbp",64,"rax"),o.putLabel("restore_registers"),o.putBytes([15,174,12,36]),o.putMovRegReg("rsp","rbp"),o.putPopax(),o.putJccShortLabel("jne","invoke_replacement","no-hint");do{s=l.readOne()}while(s<n&&!l.eoi);l.writeAll(),l.eoi||o.putJmpAddress(t.add(s)),o.putLabel("invoke_replacement"),o.putJmpRegOffsetPtr("rdi",a.quickCode),o.flush()}),s},arm:function(e,t,n,r,o){const i=ye(o).offset,a=t.and(de);let s;return Memory.patchCode(e,128,r=>{const o=new ThumbWriter(r,{pc:e}),l=new ThumbRelocator(a,o);o.putPushRegs(["r1","r2","r3","r5","r6","r7","r8","r10","r11","lr"]),o.putBytes([45,237,16,10]),o.putSubRegRegImm("sp","sp",8),o.putStrRegRegOffset("r0","sp",0),o.putCallAddressWithArguments(xe.replacedMethods.findReplacementFromQuickCode,["r0","r9"]),o.putCmpRegImm("r0",0),o.putBCondLabel("eq","restore_registers"),o.putStrRegRegOffset("r0","sp",0),o.putLabel("restore_registers"),o.putLdrRegRegOffset("r0","sp",0),o.putAddRegRegImm("sp","sp",8),o.putBytes([189,236,16,10]),o.putPopRegs(["lr","r11","r10","r8","r7","r6","r5","r3","r2","r1"]),o.putBCondLabel("ne","invoke_replacement");do{s=l.readOne()}while(s<n&&!l.eoi);l.writeAll(),l.eoi||o.putLdrRegAddress("pc",t.add(s)),o.putLabel("invoke_replacement"),o.putLdrRegRegOffset("pc","r0",i.quickCode),o.flush()}),s},arm64:function(e,t,n,{availableScratchRegs:r},o){const i=ye(o).offset;let a;return Memory.patchCode(e,256,o=>{const s=new Arm64Writer(o,{pc:e}),l=new Arm64Relocator(t,s);s.putPushRegReg("d0","d1"),s.putPushRegReg("d2","d3"),s.putPushRegReg("d4","d5"),s.putPushRegReg("d6","d7"),s.putPushRegReg("x1","x2"),s.putPushRegReg("x3","x4"),s.putPushRegReg("x5","x6"),s.putPushRegReg("x7","x20"),s.putPushRegReg("x21","x22"),s.putPushRegReg("x23","x24"),s.putPushRegReg("x25","x26"),s.putPushRegReg("x27","x28"),s.putPushRegReg("x29","lr"),s.putSubRegRegImm("sp","sp",16),s.putStrRegRegOffset("x0","sp",0),s.putCallAddressWithArguments(xe.replacedMethods.findReplacementFromQuickCode,["x0","x19"]),s.putCmpRegReg("x0","xzr"),s.putBCondLabel("eq","restore_registers"),s.putStrRegRegOffset("x0","sp",0),s.putLabel("restore_registers"),s.putLdrRegRegOffset("x0","sp",0),s.putAddRegRegImm("sp","sp",16),s.putPopRegReg("x29","lr"),s.putPopRegReg("x27","x28"),s.putPopRegReg("x25","x26"),s.putPopRegReg("x23","x24"),s.putPopRegReg("x21","x22"),s.putPopRegReg("x7","x20"),s.putPopRegReg("x5","x6"),s.putPopRegReg("x3","x4"),s.putPopRegReg("x1","x2"),s.putPopRegReg("d6","d7"),s.putPopRegReg("d4","d5"),s.putPopRegReg("d2","d3"),s.putPopRegReg("d0","d1"),s.putBCondLabel("ne","invoke_replacement");do{a=l.readOne()}while(a<n&&!l.eoi);if(l.writeAll(),!l.eoi){const e=Array.from(r)[0];s.putLdrRegAddress(e,t.add(a)),s.putBrReg(e)}s.putLabel("invoke_replacement"),s.putLdrRegRegOffset("x16","x0",i.quickCode),s.putBrReg("x16"),s.flush()}),a}},Tt={ia32:Ut,x64:Ut,arm:function(e,t,n){const r=e.and(de);Memory.patchCode(r,16,e=>{const n=new ThumbWriter(e,{pc:r});n.putLdrRegAddress("pc",t.or(1)),n.flush()})},arm64:function(e,t,n){Memory.patchCode(e,16,r=>{const o=new Arm64Writer(r,{pc:e});16===n?o.putLdrRegAddress("x16",t):o.putAdrpRegAddress("x16",t),o.putBrReg("x16"),o.flush()})}};function Ut(e,t,n){Memory.patchCode(e,16,n=>{const r=new X86Writer(n,{pc:e});r.putJmpAddress(t),r.flush()})}const Ot={ia32:5,x64:16,arm:8,arm64:16};class Dt{constructor(e){this.quickCode=e,this.quickCodeAddress="arm"===Process.arch?e.and(de):e,this.redirectSize=0,this.trampoline=null,this.overwrittenPrologue=null,this.overwrittenPrologueLength=0}_canRelocateCode(e,t){const n=bt[Process.arch],r=yt[Process.arch],{quickCodeAddress:o}=this,i=new r(o,new n(o));let a;if("arm64"===Process.arch){let n=new Set(["x16","x17"]);do{const e=i.readOne(),t=new Set(n),{read:r,written:o}=i.input.regsAccessed;for(const e of[r,o])for(const n of e){let e;e=n.startsWith("w")?"x"+n.substring(1):n,t.delete(e)}if(0===t.size)break;a=e,n=t}while(a<e&&!i.eoi);t.availableScratchRegs=n}else do{a=i.readOne()}while(a<e&&!i.eoi);return a>=e}_allocateTrampoline(){null===Ze&&(Ze=new o(4===ne?128:256));const e=Ot[Process.arch];let t,n,r=1;const i={};if(4===ne||this._canRelocateCode(e,i))t=e,n={};else{let e;"x64"===Process.arch?(t=5,e=2147467263):"arm64"===Process.arch&&(t=8,e=4294963200,r=4096),n={near:this.quickCodeAddress,maxDistance:e}}return this.redirectSize=t,this.trampoline=Ze.allocateSlice(n,r),i}_destroyTrampoline(){Ze.freeSlice(this.trampoline)}activate(e){const t=this._allocateTrampoline(),{trampoline:n,quickCode:r,redirectSize:o}=this,i=(0,xt[Process.arch])(n,r,o,t,e);this.overwrittenPrologueLength=i,this.overwrittenPrologue=Memory.dup(this.quickCodeAddress,i),(0,Tt[Process.arch])(r,n,o)}deactivate(){const{quickCodeAddress:e,overwrittenPrologueLength:t}=this,n=bt[Process.arch];Memory.patchCode(e,t,r=>{const o=new n(r,{pc:e}),{overwrittenPrologue:i}=this;o.putBytes(i.readByteArray(t)),o.flush()}),this._destroyTrampoline()}}class zt{constructor(e){const t=Pt(e);this.methodId=t,this.originalMethod=null,this.hookedMethodId=t,this.replacementMethodId=null,this.interceptor=null}replace(e,t,n,r,o){const{kAccCompileDontBother:i,artNterpEntryPoint:a}=o;this.originalMethod=Jt(this.methodId,r);const s=this.originalMethod.accessFlags;if(268435456&s&&Le()<28){const e=this.originalMethod.jniCode;this.hookedMethodId=e.add(2*ne).readPointer(),this.originalMethod=Jt(this.hookedMethodId,r)}const{hookedMethodId:l}=this,c=function(e,t){const n=Be();if(Le()<23){const t=n["art::Thread::CurrentFromGdb"]();return n["art::mirror::Object::Clone"](e,t)}return Memory.dup(e,ye(t).size)}(l,r);this.replacementMethodId=c,Ft(c,{jniCode:e,accessFlags:(-3670017&s|256|i)>>>0,quickCode:o.artClassLinker.quickGenericJniTrampoline,interpreterCode:o.artInterpreterToCompiledCodeBridge},r);let d=1209008128;!(256&s)&&(d|=524288),Ft(l,{accessFlags:(s&~d|i)>>>0},r);const u=this.originalMethod.quickCode;if(null!==a&&u.equals(a)&&Ft(l,{quickCode:o.artQuickToInterpreterBridge},r),!function(e){const t=Be(),{module:n,artClassLinker:r}=t;return e.equals(r.quickGenericJniTrampoline)||e.equals(r.quickToInterpreterBridgeTrampoline)||e.equals(r.quickResolutionTrampoline)||e.equals(r.quickImtConflictTrampoline)||e.compare(n.base)>=0&&e.compare(n.base.add(n.size))<0}(u)){const e=new Dt(u);e.activate(r),this.interceptor=e}xe.replacedMethods.set(l,c),function(e,t){!function(e){Fe||(Fe=!0,function(e){const t=Be();[t.artQuickGenericJniTrampoline,t.artQuickToInterpreterBridge,t.artQuickResolutionTrampoline].forEach(t=>{Memory.protect(t,32,"rwx");const n=new Dt(t);n.activate(e),Oe.push(n)})}(e),function(){const e=Be(),t=Le(),{isApiLevel34OrApexEquivalent:n}=e;let r;if(t<=22)r=/^_ZN3art11interpreter6DoCallILb[0-1]ELb[0-1]EEEbPNS_6mirror9ArtMethodEPNS_6ThreadERNS_11ShadowFrameEPKNS_11InstructionEtPNS_6JValueE$/;else if(t<=33&&!n)r=/^_ZN3art11interpreter6DoCallILb[0-1]ELb[0-1]EEEbPNS_9ArtMethodEPNS_6ThreadERNS_11ShadowFrameEPKNS_11InstructionEtPNS_6JValueE$/;else{if(!n)throw new Error("Unable to find method invocation in ART; please file a bug");r=/^_ZN3art11interpreter6DoCallILb[0-1]EEEbPNS_9ArtMethodEPNS_6ThreadERNS_11ShadowFrameEPKNS_11InstructionEtbPNS_6JValueE$/}const o=e.module,i=[...o.enumerateExports(),...o.enumerateSymbols()].filter(e=>r.test(e.name));if(0===i.length)throw new Error("Unable to find method invocation in ART; please file a bug");for(const e of i)Interceptor.attach(e.address,xe.hooks.Interpreter.doCall)}(),function(){const e=Be(),t=e.module.findSymbolByName("_ZN3art2gc4Heap22CollectGarbageInternalENS0_9collector6GcTypeENS0_7GcCauseEbj");if(null===t)return;const{artNterpEntryPoint:n,artQuickToInterpreterBridge:r}=e,o=ye(e.vm).offset.quickCode;Interceptor.attach(t,{onLeave(){xe.replacedMethods.synchronize(o,n,r)}})}(),function(){const e=[["_ZN3art11ClassLinker26VisiblyInitializedCallback22MarkVisiblyInitializedEPNS_6ThreadE","e90340f8 : ff0ff0ff"],["_ZN3art11ClassLinker26VisiblyInitializedCallback29AdjustThreadVisibilityCounterEPNS_6ThreadEl","7f0f00f9 : 1ffcffff"]],t=Be(),n=t.module;for(const[r,o]of e){const e=n.findSymbolByName(r);if(null===e)continue;const i=Memory.scanSync(e,8192,o);if(0===i.length)return;const{artNterpEntryPoint:a,artQuickToInterpreterBridge:s}=t,l=ye(t.vm).offset.quickCode;return void Interceptor.attach(i[0].address,function(){xe.replacedMethods.synchronize(l,a,s)})}}())}(t),function(){if(Je)return;if(Je=!0,!function(){if(Le()<31)return!1;const e=wt[Process.arch];if(void 0===e)return!1;const t=e.signatures.map(({pattern:e,offset:t=0,validateMatch:n=Lt})=>({pattern:new MatchPattern(e.join("")),offset:t,validateMatch:n})),n=[];for(const{base:e,size:r}of Be().module.enumerateRanges("--x"))for(const{pattern:o,offset:i,validateMatch:a}of t){const t=Memory.scanSync(e,r,o).map(({address:e,size:t})=>({address:e.sub(i),size:t+i})).filter(e=>{const t=a(e);return null!==t&&(e.validationResult=t,!0)});n.push(...t)}return 0!==n.length&&(n.forEach(e.instrument),!0)}()){const{getOatQuickMethodHeaderImpl:e}=xe;if(null===e)return;try{Interceptor.replace(e,xe.hooks.ArtMethod.getOatQuickMethodHeader)}catch(e){}}const e=Le();let t=null;const n=Be();e>28?t=n.find("_ZN3art2gc9collector17ConcurrentCopying12CopyingPhaseEv"):e>22&&(t=n.find("_ZN3art2gc9collector17ConcurrentCopying12MarkingPhaseEv")),null!==t&&Interceptor.attach(t,xe.hooks.Gc.copyingPhase);let r=null;r=n.find("_ZN3art6Thread15RunFlipFunctionEPS0_"),null===r&&(r=n.find("_ZN3art6Thread15RunFlipFunctionEPS0_b")),null!==r&&Interceptor.attach(r,xe.hooks.Gc.runFlip)}()}(0,r)}revert(e){const{hookedMethodId:t,interceptor:n}=this;Ft(t,this.originalMethod,e),xe.replacedMethods.delete(t),null!==n&&(n.deactivate(),this.interceptor=null)}resolveTarget(e,t,n,r){return this.hookedMethodId}}function Jt(e,t){const n=ye(t).offset;return["jniCode","accessFlags","quickCode","interpreterCode"].reduce((t,r)=>{const o=n[r];if(void 0===o)return t;const i=e.add(o),a="accessFlags"===r?re:oe;return t[r]=a.call(i),t},{})}function Ft(e,t,n){const r=ye(n).offset;Object.keys(t).forEach(n=>{const o=r[n];if(void 0===o)return;const i=e.add(o);("accessFlags"===n?ie:ae).call(i,t[n])})}class Vt{constructor(e){this.methodId=e,this.originalMethod=null}replace(e,t,n,r,o){const{methodId:i}=this;this.originalMethod=Memory.dup(i,56);let a=n.reduce((e,t)=>e+t.size,0);t&&a++;const s=(256|i.add(4).readU32())>>>0,l=a,c=a;i.add(4).writeU32(s),i.add(10).writeU16(l),i.add(12).writeU16(0),i.add(14).writeU16(c),i.add(36).writeU32(function(e){if("ia32"!==Process.arch)return fe;const t=e.add(28).readPointer().readCString();if(null===t||0===t.length||t.length>65535)return fe;let n;switch(t[0]){case"V":n=0;break;case"F":n=1;break;case"D":n=2;break;case"J":n=3;break;case"Z":case"B":n=7;break;case"C":n=6;break;case"S":n=5;break;default:n=4}let r=0;for(let e=t.length-1;e>0;e--){const n=t[e];r+="D"===n||"J"===n?2:1}return n<<28|r}(i)),o.dvmUseJNIBridge(i,e)}revert(e){Memory.copy(this.methodId,this.originalMethod,56)}resolveTarget(e,t,n,r){const o=n.handle.add(he).readPointer();let i,a;if(t)i=r.dvmDecodeIndirectRef(o,e.$h);else{const t=e.$borrowClassHandle(n);i=r.dvmDecodeIndirectRef(o,t.value),t.unref(n)}a=t?i.add(0).readPointer():i;const s=a.toString(16);let l=Ue.get(s);if(void 0===l){const e=a.add(116),t=a.add(112),n=e.readPointer(),r=t.readS32(),o=r*ne,i=Memory.alloc(2*o);Memory.copy(i,n,o),e.writePointer(i),l={classObject:a,vtablePtr:e,vtableCountPtr:t,vtable:n,vtableCount:r,shadowVtable:i,shadowVtableCount:r,targetMethods:new Map},Ue.set(s,l)}const c=this.methodId.toString(16);let d=l.targetMethods.get(c);if(void 0===d){d=Memory.dup(this.originalMethod,56);const e=l.shadowVtableCount++;l.shadowVtable.add(e*ne).writePointer(d),d.add(8).writeU16(e),l.vtableCountPtr.writeS32(l.shadowVtableCount),l.targetMethods.set(c,d)}return d}}function $t(e,t,n){Bt(e,t,ce,n)}function Gt(e,t){Bt(e,t,le)}function Zt(e,t){const n=Be();if(Le()<26)throw new Error("This API is only available on Android >= 8.0");pt(e,t,e=>{n["art::Runtime::DeoptimizeBootImage"](n.artRuntime)})}function Bt(e,t,n,r){const o=Be();if(Le()<24)throw new Error("This API is only available on Android >= 7.0");pt(e,t,e=>{if(Le()<30){if(!o.isJdwpStarted()){const e=function(e){const t=new qt;e["art::Dbg::SetJdwpAllowed"](1);const n=function(){const e=Le()<28?2:3,t=8+me+2,n=Memory.alloc(t);return n.writeU32(e).add(4).writeU8(1).add(1).writeU8(0).add(1).add(me).writeU16(0),n}();e["art::Dbg::ConfigureJdwp"](n);const r=e["art::InternalDebuggerControlCallback::StartDebugger"];return void 0!==r?r(NULL):e["art::Dbg::StartJdwp"](),t}(o);$e.push(e)}o.isDebuggerActive()||o["art::Dbg::GoActive"]();const e=Memory.alloc(8+ne);switch(e.writeU32(n),n){case le:break;case ce:e.add(8).writePointer(r);break;default:throw new Error("Unsupported deoptimization kind")}o["art::Dbg::RequestDeoptimization"](e),o["art::Dbg::ManageDeoptimization"]()}else{const e=o.artInstrumentation;if(null===e)throw new Error("Unable to find Instrumentation class in ART; please file a bug");const t=o["art::Instrumentation::EnableDeoptimization"];switch(void 0!==t&&(e.add(ve().offset.deoptimizationEnabled).readU8()||t(e)),n){case le:o["art::Instrumentation::DeoptimizeEverything"](e,Memory.allocUtf8String("frida"));break;case ce:o["art::Instrumentation::Deoptimize"](e,r);break;default:throw new Error("Unsupported deoptimization kind")}}})}class qt{constructor(){const e=Process.getModuleByName("libart.so"),t=e.getExportByName("_ZN3art4JDWP12JdwpAdbState6AcceptEv"),n=e.getExportByName("_ZN3art4JDWP12JdwpAdbState15ReceiveClientFdEv"),r=Ht(),o=Ht();this._controlFd=r[0],this._clientFd=o[0];let i=null;i=Interceptor.attach(t,function(e){const t=e[0];Memory.scanSync(t.add(8252),256,"00 ff ff ff ff 00")[0].address.add(1).writeS32(r[1]),i.detach()}),Interceptor.replace(n,new NativeCallback(function(e){return Interceptor.revert(n),o[1]},"int",["pointer"])),Interceptor.flush(),this._handshakeRequest=this._performHandshake()}async _performHandshake(){const e=new UnixInputStream(this._clientFd,{autoClose:!1}),t=new UnixOutputStream(this._clientFd,{autoClose:!1}),n=[74,68,87,80,45,72,97,110,100,115,104,97,107,101];try{await t.writeAll(n),await e.readAll(n.length)}catch(e){}}}function Ht(){null===Ge&&(Ge=new NativeFunction(Process.getModuleByName("libc.so").getExportByName("socketpair"),"int",["int","int","int","pointer"]));const e=Memory.alloc(8);if(-1===Ge(1,1,0,e))throw new Error("Unable to create socketpair for JDWP");return[e.readS32(),e.add(4).readS32()]}const Wt={ia32:Qt,x64:Qt,arm:function(e,t,n,r,o,i,a){const s={},l=new Set,c=ptr(1).not(),d=[n];for(;d.length>0;){let e=d.shift();const t=Object.values(s).some(({begin:t,end:n})=>e.compare(t)>=0&&e.compare(n)<0);if(t)continue;const n=e.and(c),o=n.toString(),i=e.and(1);let a={begin:n},u=null,p=!1,h=0;do{if(e.equals(r)){p=!0;break}const t=Instruction.parse(e),{mnemonic:n}=t;u=t;const f=e.and(c).toString(),m=s[f];if(void 0!==m){delete s[m.begin.toString()],s[o]=m,m.begin=a.begin,a=null;break}const _=0===h;let g=null;switch(n){case"b":g=ptr(t.operands[0].value),p=_;break;case"beq.w":case"beq":case"bne":case"bne.w":case"bgt":g=ptr(t.operands[0].value);break;case"cbz":case"cbnz":g=ptr(t.operands[1].value);break;case"pop.w":_&&(p=1===t.operands.filter(e=>"pc"===e.value).length)}switch(n){case"it":h=1;break;case"itt":h=2;break;case"ittt":h=3;break;case"itttt":h=4;break;default:h>0&&h--}null!==g&&(l.add(g.toString()),d.push(g.or(i)),d.sort((e,t)=>e.compare(t))),e=t.next}while(!p);null!==a&&(a.end=u.address.add(u.size),s[o]=a)}const u=Object.keys(s).map(e=>s[e]);u.sort((e,t)=>e.begin.compare(t.begin));const p=s[n.and(c).toString()];u.splice(u.indexOf(p),1),u.unshift(p);const h=new ThumbWriter(e,{pc:t});let f=!1,m=null,_=null;return u.forEach(e=>{const t=new ThumbRelocator(e.begin,h);let n=e.begin;const r=e.end;let s=0;do{if(0===t.readOne())throw new Error("Unexpected end of block");const e=t.input;n=e.address,s=e.size;const{mnemonic:r}=e,c=n.toString();l.has(c)&&h.putLabel(c);let d=!0;switch(r){case"b":h.putBLabel(Yt(e.operands[0])),d=!1;break;case"beq.w":h.putBCondLabelWide("eq",Yt(e.operands[0])),d=!1;break;case"bne.w":h.putBCondLabelWide("ne",Yt(e.operands[0])),d=!1;break;case"beq":case"bne":case"bgt":h.putBCondLabelWide(r.substr(1),Yt(e.operands[0])),d=!1;break;case"cbz":{const t=e.operands;h.putCbzRegLabel(t[0].value,Yt(t[1])),d=!1;break}case"cbnz":{const t=e.operands;h.putCbnzRegLabel(t[0].value,Yt(t[1])),d=!1;break}case"str":case"str.w":{const t=e.operands[1].value,n=t.disp;if(n===o){m=t.base;const e="r4"!==m?"r4":"r5",n=["r0","r1","r2","r3",e,"r9","r12","lr"];h.putPushRegs(n),h.putMrsRegReg(e,"apsr-nzcvq"),h.putCallAddressWithArguments(a,[m]),h.putMsrRegReg("apsr-nzcvq",e),h.putPopRegs(n),f=!0,d=!1}else i.has(n)&&t.base===m&&(d=!1);break}case"ldr":{const[t,n]=e.operands;if("mem"===n.type){const e=n.value;"r"===e.base[0]&&e.disp===ue&&(_=t.value)}break}case"blx":e.operands[0].value===_&&(h.putLdrRegRegOffset("r0","r0",4),h.putCallAddressWithArguments(a,["r0"]),f=!0,_=null,d=!1)}d?t.writeAll():t.skipOne()}while(!n.add(s).equals(r));t.dispose()}),h.dispose(),f||Xt(),new NativeFunction(t.or(1),"void",["pointer"],ke)},arm64:function(e,t,n,r,o,i,a){const s={},l=new Set,c=[n];for(;c.length>0;){let e=c.shift();if(Object.values(s).some(({begin:t,end:n})=>e.compare(t)>=0&&e.compare(n)<0))continue;const t=e.toString();let n={begin:e},o=null,i=!1;do{if(e.equals(r)){i=!0;break}let a;try{a=Instruction.parse(e)}catch(t){if(0===e.readU32()){i=!0;break}throw t}o=a;const d=s[a.address.toString()];if(void 0!==d){delete s[d.begin.toString()],s[t]=d,d.begin=n.begin,n=null;break}let u=null;switch(a.mnemonic){case"b":u=ptr(a.operands[0].value),i=!0;break;case"b.eq":case"b.ne":case"b.le":case"b.gt":u=ptr(a.operands[0].value);break;case"cbz":case"cbnz":u=ptr(a.operands[1].value);break;case"tbz":case"tbnz":u=ptr(a.operands[2].value);break;case"ret":i=!0}null!==u&&(l.add(u.toString()),c.push(u),c.sort((e,t)=>e.compare(t))),e=a.next}while(!i);null!==n&&(n.end=o.address.add(o.size),s[t]=n)}const d=Object.keys(s).map(e=>s[e]);d.sort((e,t)=>e.begin.compare(t.begin));const u=s[n.toString()];d.splice(d.indexOf(u),1),d.unshift(u);const p=new Arm64Writer(e,{pc:t});p.putBLabel("performTransition");const h=t.add(p.offset);p.putPushAllXRegisters(),p.putCallAddressWithArguments(a,["x0"]),p.putPopAllXRegisters(),p.putRet(),p.putLabel("performTransition");let f=!1,m=null,_=null;return d.forEach(e=>{const t=e.end.sub(e.begin).toInt32(),n=new Arm64Relocator(e.begin,p);let r;for(;0!==(r=n.readOne());){const e=n.input,{mnemonic:s}=e,c=e.address.toString();l.has(c)&&p.putLabel(c);let d=!0;switch(s){case"b":p.putBLabel(Yt(e.operands[0])),d=!1;break;case"b.eq":case"b.ne":case"b.le":case"b.gt":p.putBCondLabel(s.substr(2),Yt(e.operands[0])),d=!1;break;case"cbz":{const t=e.operands;p.putCbzRegLabel(t[0].value,Yt(t[1])),d=!1;break}case"cbnz":{const t=e.operands;p.putCbnzRegLabel(t[0].value,Yt(t[1])),d=!1;break}case"tbz":{const t=e.operands;p.putTbzRegImmLabel(t[0].value,t[1].value.valueOf(),Yt(t[2])),d=!1;break}case"tbnz":{const t=e.operands;p.putTbnzRegImmLabel(t[0].value,t[1].value.valueOf(),Yt(t[2])),d=!1;break}case"str":{const t=e.operands,n=t[0].value,r=t[1].value,a=r.disp;"xzr"===n&&a===o?(m=r.base,p.putPushRegReg("x0","lr"),p.putMovRegReg("x0",m),p.putBlImm(h),p.putPopRegReg("x0","lr"),f=!0,d=!1):i.has(a)&&r.base===m&&(d=!1);break}case"ldr":{const t=e.operands,n=t[1].value;"x"===n.base[0]&&n.disp===ue&&(_=t[0].value);break}case"blr":e.operands[0].value===_&&(p.putLdrRegRegOffset("x0","x0",8),p.putCallAddressWithArguments(a,["x0"]),f=!0,_=null,d=!1)}if(d?n.writeAll():n.skipOne(),r===t)break}n.dispose()}),p.dispose(),f||Xt(),new NativeFunction(t,"void",["pointer"],ke)}};function Kt(e,t,n){const r=Be(),o=t.handle.readPointer();let i;const a=r.find("_ZN3art3JNIILb1EE14ExceptionClearEP7_JNIEnv");let s;i=null!==a?a:o.add(ue).readPointer();const l=r.find("_ZN3art3JNIILb1EE10FatalErrorEP7_JNIEnvPKc");s=null!==l?l:o.add(pe).readPointer();const c=Wt[Process.arch];if(void 0===c)throw new Error("Not yet implemented for "+Process.arch);let d=null;const u=be(e).offset,p=u.exception,h=new Set,f=u.isExceptionReportedToInstrumentation;null!==f&&h.add(f);const m=u.throwLocation;null!==m&&(h.add(m),h.add(m+ne),h.add(m+2*ne));const _=Memory.alloc(65536);return Memory.patchCode(_,65536,e=>{d=c(e,_,i,s,p,h,n)}),d._code=_,d._callback=n,d}function Qt(e,t,n,r,o,i,a){const s={},l=new Set,c=[n];for(;c.length>0;){let e=c.shift();if(Object.values(s).some(({begin:t,end:n})=>e.compare(t)>=0&&e.compare(n)<0))continue;const t=e.toString();let n={begin:e},o=null,i=!1;do{if(e.equals(r)){i=!0;break}const a=Instruction.parse(e);o=a;const d=s[a.address.toString()];if(void 0!==d){delete s[d.begin.toString()],s[t]=d,d.begin=n.begin,n=null;break}let u=null;switch(a.mnemonic){case"jmp":u=ptr(a.operands[0].value),i=!0;break;case"je":case"jg":case"jle":case"jne":case"js":u=ptr(a.operands[0].value);break;case"ret":i=!0}null!==u&&(l.add(u.toString()),c.push(u),c.sort((e,t)=>e.compare(t))),e=a.next}while(!i);null!==n&&(n.end=o.address.add(o.size),s[t]=n)}const d=Object.keys(s).map(e=>s[e]);d.sort((e,t)=>e.begin.compare(t.begin));const u=s[n.toString()];d.splice(d.indexOf(u),1),d.unshift(u);const p=new X86Writer(e,{pc:t});let h=!1,f=null;return d.forEach(e=>{const t=e.end.sub(e.begin).toInt32(),n=new X86Relocator(e.begin,p);let r;for(;0!==(r=n.readOne());){const e=n.input,{mnemonic:s}=e,c=e.address.toString();l.has(c)&&p.putLabel(c);let d=!0;switch(s){case"jmp":p.putJmpNearLabel(Yt(e.operands[0])),d=!1;break;case"je":case"jg":case"jle":case"jne":case"js":p.putJccNearLabel(s,Yt(e.operands[0]),"no-hint"),d=!1;break;case"mov":{const[t,n]=e.operands;if("mem"===t.type&&"imm"===n.type){const e=t.value,r=e.disp;if(r===o&&0===n.value.valueOf()){if(f=e.base,p.putPushfx(),p.putPushax(),p.putMovRegReg("xbp","xsp"),4===ne)p.putAndRegU32("esp",4294967280);else{const e="rdi"!==f?"rdi":"rsi";p.putMovRegU64(e,uint64("0xfffffffffffffff0")),p.putAndRegReg("rsp",e)}p.putCallAddressWithAlignedArguments(a,[f]),p.putMovRegReg("xsp","xbp"),p.putPopax(),p.putPopfx(),h=!0,d=!1}else i.has(r)&&e.base===f&&(d=!1)}break}case"call":{const t=e.operands[0];"mem"===t.type&&t.value.disp===ue&&(4===ne?(p.putPopReg("eax"),p.putMovRegRegOffsetPtr("eax","eax",4),p.putPushReg("eax")):p.putMovRegRegOffsetPtr("rdi","rdi",8),p.putCallAddressWithArguments(a,[]),h=!0,d=!1);break}}if(d?n.writeAll():n.skipOne(),r===t)break}n.dispose()}),p.dispose(),h||Xt(),new NativeFunction(t,"void",["pointer"],ke)}function Xt(){throw new Error("Unable to parse ART internals; please file a bug")}function Yt(e){return ptr(e.value).toString()}function en(e,t){const{arch:n}=Process;switch(n){case"ia32":case"arm64":{let r;r="ia32"===n?Ct(64,n=>{const r=1+t.length,o=4*r;n.putSubRegImm("esp",o);for(let e=0;e!==r;e++){const t=4*e;n.putMovRegRegOffsetPtr("eax","esp",o+4+t),n.putMovRegOffsetPtrReg("esp",t,"eax")}n.putCallAddress(e),n.putAddRegImm("esp",o-4),n.putRet()}):Ct(32,n=>{n.putMovRegReg("x8","x0"),t.forEach((e,t)=>{n.putMovRegReg("x"+t,"x"+(t+1))}),n.putLdrRegAddress("x7",e),n.putBrReg("x7")});const o=new NativeFunction(r,"void",["pointer"].concat(t),ke),i=function(...e){o(...e)};return i.handle=r,i.impl=e,i}default:{const n=new NativeFunction(e,"void",["pointer"].concat(t),ke);return n.impl=e,n}}}class tn{$delete(){this.dispose(),Be().$delete(this)}constructor(e,t){this.handle=e,this._begin=e,this._end=e.add(ne),this._storage=e.add(2*ne),this._elementSize=t}init(){this.begin=NULL,this.end=NULL,this.storage=NULL}dispose(){Be().$delete(this.begin)}get begin(){return this._begin.readPointer()}set begin(e){this._begin.writePointer(e)}get end(){return this._end.readPointer()}set end(e){this._end.writePointer(e)}get storage(){return this._storage.readPointer()}set storage(e){this._storage.writePointer(e)}get size(){return this.end.sub(this.begin).toInt32()/this._elementSize}}class nn extends tn{static $new(){const e=new nn(Be().$new(_e));return e.init(),e}constructor(e){super(e,ne)}get handles(){const e=[];let t=this.begin;const n=this.end;for(;!t.equals(n);)e.push(t.readPointer()),t=t.add(ne);return e}}const rn=ne,on=rn+4;class an{$delete(){this.dispose(),Be().$delete(this)}constructor(e){this.handle=e,this._link=e.add(0),this._numberOfReferences=e.add(rn)}init(e,t){this.link=e,this.numberOfReferences=t}dispose(){}get link(){return new an(this._link.readPointer())}set link(e){this._link.writePointer(e)}get numberOfReferences(){return this._numberOfReferences.readS32()}set numberOfReferences(e){this._numberOfReferences.writeS32(e)}}const sn=function(e){const t=e%ne;return 0!==t?e+ne-t:e}(on),ln=sn+ne,cn=ln+ne;class dn extends an{static $new(e,t){const n=new dn(Be().$new(cn));return n.init(e,t),n}constructor(e){super(e),this._self=e.add(sn),this._currentScope=e.add(ln);const t=(64-ne-4-4)/4;this._scopeLayout=un.layoutForCapacity(t),this._topHandleScopePtr=null}init(e,t){const n=e.add(be(t).offset.topHandleScope);this._topHandleScopePtr=n,super.init(n.readPointer(),-1),this.self=e,this.currentScope=un.$new(this._scopeLayout),n.writePointer(this)}dispose(){let e;for(this._topHandleScopePtr.writePointer(this.link);null!==(e=this.currentScope);){const t=e.link;e.$delete(),this.currentScope=t}}get self(){return this._self.readPointer()}set self(e){this._self.writePointer(e)}get currentScope(){const e=this._currentScope.readPointer();return e.isNull()?null:new un(e,this._scopeLayout)}set currentScope(e){this._currentScope.writePointer(e)}newHandle(e){return this.currentScope.newHandle(e)}}class un extends an{static $new(e){const t=new un(Be().$new(e.size),e);return t.init(),t}constructor(e,t){super(e);const{offset:n}=t;this._refsStorage=e.add(n.refsStorage),this._pos=e.add(n.pos),this._layout=t}init(){super.init(NULL,this._layout.numberOfReferences),this.pos=0}get pos(){return this._pos.readU32()}set pos(e){this._pos.writeU32(e)}newHandle(e){const t=this.pos,n=this._refsStorage.add(4*t);return n.writeS32(e.toInt32()),this.pos=t+1,n}static layoutForCapacity(e){const t=on+4*e;return{size:t+4,numberOfReferences:e,offset:{refsStorage:on,pos:t}}}}const pn={arm:function(e,t){const n=Process.pageSize,r=Memory.alloc(n);Memory.protect(r,n,"rwx");const o=new NativeCallback(t,"void",["pointer"]);r._onMatchCallback=o;const i=[26625,18947,17041,53505,19202,18200,18288,48896],a=2*i.length,s=a+4,l=s+4;return Memory.patchCode(r,l,function(t){i.forEach((e,n)=>{t.add(2*n).writeU16(e)}),t.add(a).writeS32(e),t.add(s).writePointer(o)}),r.or(1)},arm64:function(e,t){const n=Process.pageSize,r=Memory.alloc(n);Memory.protect(r,n,"rwx");const o=new NativeCallback(t,"void",["pointer"]);r._onMatchCallback=o;const i=[3107979265,402653378,1795293247,1409286241,1476395139,3592355936,3596551104],a=4*i.length,s=a+4,l=s+8;return Memory.patchCode(r,l,function(t){i.forEach((e,n)=>{t.add(4*n).writeU32(e)}),t.add(a).writeS32(e),t.add(s).writePointer(o)}),r}};function hn(e,t){return(pn[Process.arch]||fn)(e,t)}function fn(e,t){return new NativeCallback(n=>{n.readS32()===e&&t(n)},"void",["pointer","pointer"])}const{pointerSize:mn}=Process,_n={exceptions:"propagate"},gn=m(function(){const e=En(),{version:t}=e;let n;n=t>=17?"method:early":t>=9&&t<=16?"const-method":"method:late";const r=e["Method::size"](1)*mn,o=4*mn,i="method:early"===n?mn:0,a=o+i,s=a+4,l=s+4+8,c=0!==i?o:l+mn,d=8+mn,u=d+mn,p="const-method"===n?mn:0,h=u+p;return{getAdapterPointer:0!==p?function(e,t){return t.add(u)}:function(e,t){return e.add(c)},method:{size:r,constMethodOffset:mn,methodDataOffset:2*mn,methodCountersOffset:3*mn,accessFlagsOffset:a,vtableIndexOffset:s,i2iEntryOffset:l,nativeFunctionOffset:r-2*mn,signatureHandlerOffset:r-mn},constMethod:{constantPoolOffset:8,stackmapDataOffset:d,sizeOffset:h,methodIdnumOffset:h+14},constantPool:{cacheOffset:2*mn,instanceKlassOffset:3*mn}}}),vn=m(function(){const{version:e,createNewDefaultVtableIndices:t}=En(),n=Tn[Process.arch];if(void 0===n)throw new Error(`Missing vtable offset parser for ${Process.arch}`);const r=f(t,n,{limit:32});if(null===r)throw new Error("Unable to deduce vtable offset");return{vtableOffset:r,methodsOffset:r-7*mn,memberNamesOffset:r-17*mn,oopMapCacheOffset:r-(e>=10&&e<=11||e>=15?17:18)*mn}}),yn=m(function(){const{vtableRedefineClasses:e,redefineClassesDoIt:t,redefineClassesDoItPrologue:n,redefineClassesDoItEpilogue:r,redefineClassesOnError:o,redefineClassesAllow:i,redefineClassesDispose0:a,redefineClassesDispose1:s,"VMThread::execute":l}=En(),c=e.add(2*mn),d=15*mn,u=Memory.dup(c,d),p=new NativeCallback(()=>{},"void",["pointer"]);let h,f,m;for(let e=0;e!==d;e+=mn){const l=u.add(e),c=l.readPointer();void 0!==o&&c.equals(o)||void 0!==a&&c.equals(a)||void 0!==s&&c.equals(s)?l.writePointer(p):c.equals(t)?h=e:c.equals(n)?(f=e,l.writePointer(i)):c.equals(r)&&(m=e,l.writePointer(p))}return{execute:l,emptyCallback:p,vtable:u,vtableSize:d,doItOffset:h,prologueOffset:f,epilogueOffset:m}});let bn=null,Cn=!1;const wn=new Map,Sn=new Map;function En(){return null===bn&&(bn=function(){const e=Process.enumerateModules().filter(e=>/jvm.(dll|dylib|so)$/.test(e.name));if(0===e.length)return null;const t=e[0],n={flavor:"jvm"},r="windows"===Process.platform?[{module:t,functions:{JNI_GetCreatedJavaVMs:["JNI_GetCreatedJavaVMs","int",["pointer","int","pointer"]],JVM_Sleep:["JVM_Sleep","void",["pointer","pointer","long"]],"VMThread::execute":["VMThread::execute","void",["pointer"]],"Method::size":["Method::size","int",["int"]],"Method::set_native_function":["Method::set_native_function","void",["pointer","pointer","int"]],"Method::clear_native_function":["Method::clear_native_function","void",["pointer"]],"Method::jmethod_id":["Method::jmethod_id","pointer",["pointer"]],"ClassLoaderDataGraph::classes_do":["ClassLoaderDataGraph::classes_do","void",["pointer"]],"NMethodSweeper::sweep_code_cache":["NMethodSweeper::sweep_code_cache","void",[]],"OopMapCache::flush_obsolete_entries":["OopMapCache::flush_obsolete_entries","void",["pointer"]]},variables:{"VM_RedefineClasses::`vftable'":function(e){this.vtableRedefineClasses=e},"VM_RedefineClasses::doit":function(e){this.redefineClassesDoIt=e},"VM_RedefineClasses::doit_prologue":function(e){this.redefineClassesDoItPrologue=e},"VM_RedefineClasses::doit_epilogue":function(e){this.redefineClassesDoItEpilogue=e},"VM_RedefineClasses::allow_nested_vm_operations":function(e){this.redefineClassesAllow=e},"NMethodSweeper::_traversals":function(e){this.traversals=e},"NMethodSweeper::_should_sweep":function(e){this.shouldSweep=e}},optionals:[]}]:[{module:t,functions:{JNI_GetCreatedJavaVMs:["JNI_GetCreatedJavaVMs","int",["pointer","int","pointer"]],_ZN6Method4sizeEb:["Method::size","int",["int"]],_ZN6Method19set_native_functionEPhb:["Method::set_native_function","void",["pointer","pointer","int"]],_ZN6Method21clear_native_functionEv:["Method::clear_native_function","void",["pointer"]],_ZN6Method24restore_unshareable_infoEP10JavaThread:["Method::restore_unshareable_info","void",["pointer","pointer"]],_ZN6Method24restore_unshareable_infoEP6Thread:["Method::restore_unshareable_info","void",["pointer","pointer"]],_ZN6Method11link_methodERK12methodHandleP10JavaThread:["Method::link_method","void",["pointer","pointer","pointer"]],_ZN6Method10jmethod_idEv:["Method::jmethod_id","pointer",["pointer"]],_ZN6Method10clear_codeEv:function(e){const t=new NativeFunction(e,"void",["pointer"],_n);this["Method::clear_code"]=function(e){t(e)}},_ZN6Method10clear_codeEb:function(e){const t=new NativeFunction(e,"void",["pointer","int"],_n);this["Method::clear_code"]=function(e){t(e,0)}},_ZN18VM_RedefineClasses19mark_dependent_codeEP13InstanceKlass:["VM_RedefineClasses::mark_dependent_code","void",["pointer","pointer"]],_ZN18VM_RedefineClasses20flush_dependent_codeEv:["VM_RedefineClasses::flush_dependent_code","void",[]],_ZN18VM_RedefineClasses20flush_dependent_codeEP13InstanceKlassP6Thread:["VM_RedefineClasses::flush_dependent_code","void",["pointer","pointer","pointer"]],_ZN18VM_RedefineClasses20flush_dependent_codeE19instanceKlassHandleP6Thread:["VM_RedefineClasses::flush_dependent_code","void",["pointer","pointer","pointer"]],_ZN19ResolvedMethodTable21adjust_method_entriesEPb:["ResolvedMethodTable::adjust_method_entries","void",["pointer"]],_ZN15MemberNameTable21adjust_method_entriesEP13InstanceKlassPb:["MemberNameTable::adjust_method_entries","void",["pointer","pointer","pointer"]],_ZN17ConstantPoolCache21adjust_method_entriesEPb:function(e){const t=new NativeFunction(e,"void",["pointer","pointer"],_n);this["ConstantPoolCache::adjust_method_entries"]=function(e,n,r){t(e,r)}},_ZN17ConstantPoolCache21adjust_method_entriesEP13InstanceKlassPb:function(e){const t=new NativeFunction(e,"void",["pointer","pointer","pointer"],_n);this["ConstantPoolCache::adjust_method_entries"]=function(e,n,r){t(e,n,r)}},_ZN20ClassLoaderDataGraph10classes_doEP12KlassClosure:["ClassLoaderDataGraph::classes_do","void",["pointer"]],_ZN20ClassLoaderDataGraph22clean_deallocate_listsEb:["ClassLoaderDataGraph::clean_deallocate_lists","void",["int"]],_ZN10JavaThread27thread_from_jni_environmentEP7JNIEnv_:["JavaThread::thread_from_jni_environment","pointer",["pointer"]],_ZN8VMThread7executeEP12VM_Operation:["VMThread::execute","void",["pointer"]],_ZN11OopMapCache22flush_obsolete_entriesEv:["OopMapCache::flush_obsolete_entries","void",["pointer"]],_ZN14NMethodSweeper11force_sweepEv:["NMethodSweeper::force_sweep","void",[]],_ZN14NMethodSweeper16sweep_code_cacheEv:["NMethodSweeper::sweep_code_cache","void",[]],_ZN14NMethodSweeper17sweep_in_progressEv:["NMethodSweeper::sweep_in_progress","bool",[]],JVM_Sleep:["JVM_Sleep","void",["pointer","pointer","long"]]},variables:{_ZN18VM_RedefineClasses14_the_class_oopE:function(e){this.redefineClass=e},_ZN18VM_RedefineClasses10_the_classE:function(e){this.redefineClass=e},_ZN18VM_RedefineClasses25AdjustCpoolCacheAndVtable8do_klassEP5Klass:function(e){this.doKlass=e},_ZN18VM_RedefineClasses22AdjustAndCleanMetadata8do_klassEP5Klass:function(e){this.doKlass=e},_ZTV18VM_RedefineClasses:function(e){this.vtableRedefineClasses=e},_ZN18VM_RedefineClasses4doitEv:function(e){this.redefineClassesDoIt=e},_ZN18VM_RedefineClasses13doit_prologueEv:function(e){this.redefineClassesDoItPrologue=e},_ZN18VM_RedefineClasses13doit_epilogueEv:function(e){this.redefineClassesDoItEpilogue=e},_ZN18VM_RedefineClassesD0Ev:function(e){this.redefineClassesDispose0=e},_ZN18VM_RedefineClassesD1Ev:function(e){this.redefineClassesDispose1=e},_ZNK18VM_RedefineClasses26allow_nested_vm_operationsEv:function(e){this.redefineClassesAllow=e},_ZNK18VM_RedefineClasses14print_on_errorEP12outputStream:function(e){this.redefineClassesOnError=e},_ZN13InstanceKlass33create_new_default_vtable_indicesEiP10JavaThread:function(e){this.createNewDefaultVtableIndices=e},_ZN13InstanceKlass33create_new_default_vtable_indicesEiP6Thread:function(e){this.createNewDefaultVtableIndices=e},_ZN19Abstract_VM_Version19jre_release_versionEv:function(e){const t=new NativeFunction(e,"pointer",[],_n)().readCString();this.version=t.startsWith("1.8")?8:t.startsWith("9.")?9:parseInt(t.slice(0,2),10),this.versionS=t},_ZN14NMethodSweeper11_traversalsE:function(e){this.traversals=e},_ZN14NMethodSweeper21_sweep_fractions_leftE:function(e){this.fractions=e},_ZN14NMethodSweeper13_should_sweepE:function(e){this.shouldSweep=e}},optionals:["_ZN6Method24restore_unshareable_infoEP10JavaThread","_ZN6Method24restore_unshareable_infoEP6Thread","_ZN6Method11link_methodERK12methodHandleP10JavaThread","_ZN6Method10clear_codeEv","_ZN6Method10clear_codeEb","_ZN18VM_RedefineClasses19mark_dependent_codeEP13InstanceKlass","_ZN18VM_RedefineClasses20flush_dependent_codeEv","_ZN18VM_RedefineClasses20flush_dependent_codeEP13InstanceKlassP6Thread","_ZN18VM_RedefineClasses20flush_dependent_codeE19instanceKlassHandleP6Thread","_ZN19ResolvedMethodTable21adjust_method_entriesEPb","_ZN15MemberNameTable21adjust_method_entriesEP13InstanceKlassPb","_ZN17ConstantPoolCache21adjust_method_entriesEPb","_ZN17ConstantPoolCache21adjust_method_entriesEP13InstanceKlassPb","_ZN20ClassLoaderDataGraph22clean_deallocate_listsEb","_ZN10JavaThread27thread_from_jni_environmentEP7JNIEnv_","_ZN14NMethodSweeper11force_sweepEv","_ZN14NMethodSweeper17sweep_in_progressEv","_ZN18VM_RedefineClasses14_the_class_oopE","_ZN18VM_RedefineClasses10_the_classE","_ZN18VM_RedefineClasses25AdjustCpoolCacheAndVtable8do_klassEP5Klass","_ZN18VM_RedefineClasses22AdjustAndCleanMetadata8do_klassEP5Klass","_ZN18VM_RedefineClassesD0Ev","_ZN18VM_RedefineClassesD1Ev","_ZNK18VM_RedefineClasses14print_on_errorEP12outputStream","_ZN13InstanceKlass33create_new_default_vtable_indicesEiP10JavaThread","_ZN13InstanceKlass33create_new_default_vtable_indicesEiP6Thread","_ZN14NMethodSweeper21_sweep_fractions_leftE"]}],o=[];if(r.forEach(function(e){const t=e.module,r=e.functions||{},i=e.variables||{},a=new Set(e.optionals||[]),s=t.enumerateExports().reduce(function(e,t){return e[t.name]=t,e},{}),l=t.enumerateSymbols().reduce(function(e,t){return e[t.name]=t,e},s);Object.keys(r).forEach(function(e){const t=l[e];if(void 0!==t){const o=r[e];"function"==typeof o?o.call(n,t.address):n[o[0]]=new NativeFunction(t.address,o[1],o[2],_n)}else a.has(e)||o.push(e)}),Object.keys(i).forEach(function(e){const t=l[e];void 0!==t?i[e].call(n,t.address):a.has(e)||o.push(e)})}),o.length>0)throw new Error("Java API only partially available; please file a bug. Missing: "+o.join(", "));const i=Memory.alloc(mn),a=Memory.alloc(4);if(s("JNI_GetCreatedJavaVMs",n.JNI_GetCreatedJavaVMs(i,1,a)),0===a.readInt())return null;n.vm=i.readPointer();const d="windows"===Process.platform?{$new:["??2@YAPEAX_K@Z","pointer",["ulong"]],$delete:["??3@YAXPEAX@Z","void",["pointer"]]}:{$new:["_Znwm","pointer",["ulong"]],$delete:["_ZdlPv","void",["pointer"]]};for(const[e,[t,r,o]]of Object.entries(d)){let i=Module.findGlobalExportByName(t);if(null===i&&(i=DebugSymbol.fromName(t).address,i.isNull()))throw new Error(`unable to find C++ allocator API, missing: '${t}'`);n[e]=new NativeFunction(i,r,o,_n)}return n.jvmti=function(e){const t=new ee(e);let n;return t.perform(()=>{const e=t.tryGetEnvHandle(l.v1_0);if(null===e)throw new Error("JVMTI not available");n=new p(e,t);const r=Memory.alloc(8);r.writeU64(c.canTagObjects),s("getEnvJvmti::AddCapabilities",n.addCapabilities(r))}),n}(n),void 0===n["JavaThread::thread_from_jni_environment"]&&(n["JavaThread::thread_from_jni_environment"]=function(e){let t=null;const n=Ln[Process.arch];if(void 0!==n){const r=new ee(e).perform(e=>e.handle.readPointer().add(6*mn).readPointer());t=f(r,n,{limit:11})}return null===t?()=>{throw new Error("Unable to make thread_from_jni_environment() helper for the current architecture")}:e=>e.add(t)}(n)),n}()),bn}const Ln={x64:function(e){if("lea"!==e.mnemonic)return null;const{base:t,disp:n}=e.operands[1].value;return"rdi"===t&&n<0?n:null}};function jn(e,t){}class Nn{constructor(e){this.methodId=e,this.method=e.readPointer(),this.originalMethod=null,this.newMethod=null,this.resolved=null,this.impl=null,this.key=e.toString(16)}replace(e,t,n,r,o){const{key:i}=this,a=Sn.get(i);void 0!==a&&(Sn.delete(i),this.method=a.method,this.originalMethod=a.originalMethod,this.newMethod=a.newMethod,this.resolved=a.resolved),this.impl=e,wn.set(i,this),An(r)}revert(e){const{key:t}=this;wn.delete(t),Sn.set(t,this),An(e)}resolveTarget(e,t,n,r){const{resolved:o,originalMethod:i,methodId:a}=this;if(null!==o)return o;if(null===i)return a;i.oldMethod.vtableIndexPtr.writeS32(-2);const s=Memory.alloc(mn);return s.writePointer(this.method),this.resolved=s,s}}function An(e){Cn||(Cn=!0,Script.nextTick(kn,e))}function kn(e){const t=new Map(wn),n=new Map(Sn);wn.clear(),Sn.clear(),Cn=!1,e.perform(e=>{const r=En(),o=r["JavaThread::thread_from_jni_environment"](e.handle);let i=!1;Mn(()=>{t.forEach(e=>{const{method:t,originalMethod:n,impl:i,methodId:a,newMethod:s}=e;null===n?(e.originalMethod=Rn(t),e.newMethod=function(e,t,n){const r=En(),o=Rn(e);o.constPtr.writePointer(o.const);const i=(234881280|o.accessFlags)>>>0;if(o.accessFlagsPtr.writeU32(i),o.signatureHandler.writePointer(NULL),o.adapter.writePointer(NULL),o.i2iEntry.writePointer(NULL),r["Method::clear_code"](o.method),o.dataPtr.writePointer(NULL),o.countersPtr.writePointer(NULL),o.stackmapPtr.writePointer(NULL),r["Method::clear_native_function"](o.method),r["Method::set_native_function"](o.method,t,0),r["Method::restore_unshareable_info"](o.method,n),r.version>=17){const e=Memory.alloc(2*mn);e.writePointer(o.method),e.add(mn).writePointer(n),r["Method::link_method"](o.method,e,n)}return o}(t,i,o),In(e.newMethod,a,o)):r["Method::set_native_function"](s.method,i,0)}),n.forEach(e=>{const{originalMethod:t,methodId:n,newMethod:r}=e;if(null!==t){!function(e){const{oldMethod:t}=e;t.accessFlagsPtr.writeU32(t.accessFlags),t.vtableIndexPtr.writeS32(t.vtableIndex)}(t);const e=t.oldMethod;e.oldMethod=r,In(e,n,o),i=!0}})}),i&&function(e){const{fractions:t,shouldSweep:n,traversals:r,"NMethodSweeper::sweep_code_cache":o,"NMethodSweeper::sweep_in_progress":i,"NMethodSweeper::force_sweep":a,JVM_Sleep:s}=En();if(void 0!==a)Thread.sleep(.05),a(),Thread.sleep(.05),a();else{let a=r.readS64();const l=a+2;for(;l>a;)t.writeS32(1),s(e,NULL,50),i()||Mn(()=>{Thread.sleep(.05)}),0===n.readU8()&&(t.writeS32(1),o()),a=r.readS64()}}(e.handle)})}function Mn(e,t,n){const{execute:r,vtable:o,vtableSize:i,doItOffset:a,prologueOffset:s,epilogueOffset:l}=yn(),c=Memory.dup(o,i),d=Memory.alloc(25*mn);d.writePointer(c);const u=new NativeCallback(e,"void",["pointer"]);c.add(a).writePointer(u);let p=null;void 0!==t&&(p=new NativeCallback(t,"int",["pointer"]),c.add(s).writePointer(p));let h=null;void 0!==n&&(h=new NativeCallback(n,"void",["pointer"]),c.add(l).writePointer(h)),r(d)}function Pn(e){return new Nn(e)}function In(e,t,n){const{method:r,oldMethod:o}=e,i=En();e.methodsArray.add(e.methodIndex*mn).writePointer(r),e.vtableIndex>=0&&e.vtable.add(e.vtableIndex*mn).writePointer(r),t.writePointer(r),o.accessFlagsPtr.writeU32((196608|o.accessFlags)>>>0);const a=i["OopMapCache::flush_obsolete_entries"];if(void 0!==a){const{oopMapCache:t}=e;t.isNull()||a(t)}const s=i["VM_RedefineClasses::mark_dependent_code"],l=i["VM_RedefineClasses::flush_dependent_code"];void 0!==s?(s(NULL,e.instanceKlass),l()):l(NULL,e.instanceKlass,n);const c=Memory.alloc(1);c.writeU8(1),i["ConstantPoolCache::adjust_method_entries"](e.cache,e.instanceKlass,c);const d=Memory.alloc(3*mn),u=Memory.alloc(mn);u.writePointer(i.doKlass),d.writePointer(u),d.add(mn).writePointer(n),d.add(2*mn).writePointer(n),void 0!==i.redefineClass&&i.redefineClass.writePointer(e.instanceKlass),i["ClassLoaderDataGraph::classes_do"](d);const p=i["ResolvedMethodTable::adjust_method_entries"];if(void 0!==p)p(c);else{const{memberNames:t}=e;if(!t.isNull()){const n=i["MemberNameTable::adjust_method_entries"];void 0!==n&&n(t,e.instanceKlass,c)}}const h=i["ClassLoaderDataGraph::clean_deallocate_lists"];void 0!==h&&h(0)}function Rn(e){const t=gn(),n=e.add(t.method.constMethodOffset).readPointer(),r=n.add(t.constMethod.sizeOffset).readS32()*mn,o=Memory.alloc(r+t.method.size);Memory.copy(o,n,r);const i=o.add(r);Memory.copy(i,e,t.method.size);const a=xn(i,o,r),s=xn(e,n,r);return a.oldMethod=s,a}function xn(e,t,n){const r=En(),o=gn(),i=e.add(o.method.constMethodOffset),a=e.add(o.method.methodDataOffset),s=e.add(o.method.methodCountersOffset),l=e.add(o.method.accessFlagsOffset),c=l.readU32(),d=o.getAdapterPointer(e,t),u=e.add(o.method.i2iEntryOffset),p=e.add(o.method.signatureHandlerOffset),h=t.add(o.constMethod.constantPoolOffset).readPointer(),f=t.add(o.constMethod.stackmapDataOffset),m=h.add(o.constantPool.instanceKlassOffset).readPointer(),_=h.add(o.constantPool.cacheOffset).readPointer(),g=vn(),v=m.add(g.methodsOffset).readPointer(),y=v.readS32(),b=v.add(mn),C=t.add(o.constMethod.methodIdnumOffset).readU16(),w=e.add(o.method.vtableIndexOffset),S=w.readS32(),E=m.add(g.vtableOffset),L=m.add(g.oopMapCacheOffset).readPointer(),j=r.version>=10?m.add(g.memberNamesOffset).readPointer():NULL;return{method:e,methodSize:o.method.size,const:t,constSize:n,constPtr:i,dataPtr:a,countersPtr:s,stackmapPtr:f,instanceKlass:m,methodsArray:b,methodsCount:y,methodIndex:C,vtableIndex:S,vtableIndexPtr:w,vtable:E,accessFlags:c,accessFlagsPtr:l,adapter:d,i2iEntry:u,signatureHandler:p,memberNames:j,cache:_,oopMapCache:L}}const Tn={x64:function(e){if("mov"!==e.mnemonic)return null;const t=e.operands[0];if("mem"!==t.type)return null;const{value:n}=t;if(1!==n.scale)return null;const{disp:r}=n;return r<256?null:r+16}};let Un=Be;try{Se()}catch(e){Un=En}const On=Un,Dn=/(.+)!([^/]+)\/?([isu]+)?/;let zn=null,Jn=null;class Fn{static build(e,t){return Vn(t),Jn(e,t,n=>new Fn(zn.new(e,n,t)))}static enumerateMethods(e,t,n){Vn(n);const r=e.match(Dn);if(null===r)throw new Error("Invalid query; format is: class!method -- see documentation of Java.enumerateMethods(query) for details");const o=Memory.allocUtf8String(r[1]),i=Memory.allocUtf8String(r[2]);let a=!1,s=!1,l=!1;const c=r[3];let d;if(void 0!==c&&(a=-1!==c.indexOf("s"),s=-1!==c.indexOf("i"),l=-1!==c.indexOf("u")),null!==t.jvmti){const e=zn.enumerateMethodsJvm(o,i,Gn(a),Gn(s),Gn(l),n);try{d=JSON.parse(e.readUtf8String()).map(e=>{const t=ptr(e.loader);return e.loader=t.isNull()?null:t,e})}finally{zn.dealloc(e)}}else pt(n.vm,n,e=>{const n=zn.enumerateMethodsArt(o,i,Gn(a),Gn(s),Gn(l));try{const r=t["art::JavaVMExt::AddGlobalRef"],{vm:o}=t;d=JSON.parse(n.readUtf8String()).map(t=>{const n=t.loader;return t.loader=0!==n?r(o,e,ptr(n)):null,t})}finally{zn.dealloc(n)}});return d}constructor(e){this.handle=e}has(e){return 0!==zn.has(this.handle,Memory.allocUtf8String(e))}find(e){return zn.find(this.handle,Memory.allocUtf8String(e)).readUtf8String()}list(){const e=zn.list(this.handle);try{return JSON.parse(e.readUtf8String())}finally{zn.dealloc(e)}}}function Vn(e){null===zn&&(zn=function(e){const t=Be(),{jvmti:n}=t,{pointerSize:r}=Process,o=r,i=7*r,a=8+o+i+(40+5*r),s=Memory.alloc(a),l=s.add(8),c=l.add(o),{getDeclaredMethods:d,getDeclaredFields:u}=e.javaLangClass(),p=e.javaLangReflectMethod(),h=e.javaLangReflectField();let f=c;[n,d,u,p.getName,p.getModifiers,h.getName,h.getModifiers].forEach(e=>{f=f.writePointer(e).add(r)});const m=c.add(i),{vm:_}=e;if("art"===t.flavor){let e;if(null!==n)e=[0,0,0,0];else{const t=nt(_).offset;e=[t.ifields,t.methods,t.sfields,t.copiedMethodsOffset]}const o=ye(_),i=rt();let a=m;[1,...e,o.size,o.offset.accessFlags,i.size,i.offset.accessFlags,4294967295].forEach(e=>{a=a.writeUInt(e).add(4)}),[t.artClassLinker.address,t["art::ClassLinker::VisitClasses"],t["art::mirror::Class::GetDescriptor"],t["art::ArtMethod::PrettyMethod"],Process.getModuleByName("libc.so").getExportByName("free")].forEach((e,t)=>{void 0===e&&(e=NULL),a=a.writePointer(e).add(r)})}const g=new CModule("#include <json-glib/json-glib.h>\n#include <string.h>\n\n#define kAccStatic 0x0008\n#define kAccConstructor 0x00010000\n\ntypedef struct _Model Model;\ntypedef struct _EnumerateMethodsContext EnumerateMethodsContext;\n\ntypedef struct _JavaApi JavaApi;\ntypedef struct _JavaClassApi JavaClassApi;\ntypedef struct _JavaMethodApi JavaMethodApi;\ntypedef struct _JavaFieldApi JavaFieldApi;\n\ntypedef struct _JNIEnv JNIEnv;\ntypedef guint8 jboolean;\ntypedef gint32 jint;\ntypedef jint jsize;\ntypedef gpointer jobject;\ntypedef jobject jclass;\ntypedef jobject jstring;\ntypedef jobject jarray;\ntypedef jarray jobjectArray;\ntypedef gpointer jfieldID;\ntypedef gpointer jmethodID;\n\ntypedef struct _jvmtiEnv jvmtiEnv;\ntypedef enum\n{\n  JVMTI_ERROR_NONE = 0\n} jvmtiError;\n\ntypedef struct _ArtApi ArtApi;\ntypedef guint32 ArtHeapReference;\ntypedef struct _ArtObject ArtObject;\ntypedef struct _ArtClass ArtClass;\ntypedef struct _ArtClassLinker ArtClassLinker;\ntypedef struct _ArtClassVisitor ArtClassVisitor;\ntypedef struct _ArtClassVisitorVTable ArtClassVisitorVTable;\ntypedef struct _ArtMethod ArtMethod;\ntypedef struct _ArtString ArtString;\n\ntypedef union _StdString StdString;\ntypedef struct _StdStringShort StdStringShort;\ntypedef struct _StdStringLong StdStringLong;\n\ntypedef void (* ArtVisitClassesFunc) (ArtClassLinker * linker, ArtClassVisitor * visitor);\ntypedef const char * (* ArtGetClassDescriptorFunc) (ArtClass * klass, StdString * storage);\ntypedef void (* ArtPrettyMethodFunc) (StdString * result, ArtMethod * method, jboolean with_signature);\n\nstruct _Model\n{\n  GHashTable * members;\n};\n\nstruct _EnumerateMethodsContext\n{\n  GPatternSpec * class_query;\n  GPatternSpec * method_query;\n  jboolean include_signature;\n  jboolean ignore_case;\n  jboolean skip_system_classes;\n  GHashTable * groups;\n};\n\nstruct _JavaClassApi\n{\n  jmethodID get_declared_methods;\n  jmethodID get_declared_fields;\n};\n\nstruct _JavaMethodApi\n{\n  jmethodID get_name;\n  jmethodID get_modifiers;\n};\n\nstruct _JavaFieldApi\n{\n  jmethodID get_name;\n  jmethodID get_modifiers;\n};\n\nstruct _JavaApi\n{\n  jvmtiEnv * jvmti;\n  JavaClassApi clazz;\n  JavaMethodApi method;\n  JavaFieldApi field;\n};\n\nstruct _JNIEnv\n{\n  gpointer * functions;\n};\n\nstruct _jvmtiEnv\n{\n  gpointer * functions;\n};\n\nstruct _ArtApi\n{\n  gboolean available;\n\n  guint class_offset_ifields;\n  guint class_offset_methods;\n  guint class_offset_sfields;\n  guint class_offset_copied_methods_offset;\n\n  guint method_size;\n  guint method_offset_access_flags;\n\n  guint field_size;\n  guint field_offset_access_flags;\n\n  guint alignment_padding;\n\n  ArtClassLinker * linker;\n  ArtVisitClassesFunc visit_classes;\n  ArtGetClassDescriptorFunc get_class_descriptor;\n  ArtPrettyMethodFunc pretty_method;\n\n  void (* free) (gpointer mem);\n};\n\nstruct _ArtObject\n{\n  ArtHeapReference klass;\n  ArtHeapReference monitor;\n};\n\nstruct _ArtClass\n{\n  ArtObject parent;\n\n  ArtHeapReference class_loader;\n};\n\nstruct _ArtClassVisitor\n{\n  ArtClassVisitorVTable * vtable;\n  gpointer user_data;\n};\n\nstruct _ArtClassVisitorVTable\n{\n  void (* reserved1) (ArtClassVisitor * self);\n  void (* reserved2) (ArtClassVisitor * self);\n  jboolean (* visit) (ArtClassVisitor * self, ArtClass * klass);\n};\n\nstruct _ArtString\n{\n  ArtObject parent;\n\n  gint32 count;\n  guint32 hash_code;\n\n  union\n  {\n    guint16 value[0];\n    guint8 value_compressed[0];\n  };\n};\n\nstruct _StdStringShort\n{\n  guint8 size;\n  gchar data[(3 * sizeof (gpointer)) - sizeof (guint8)];\n};\n\nstruct _StdStringLong\n{\n  gsize capacity;\n  gsize size;\n  gchar * data;\n};\n\nunion _StdString\n{\n  StdStringShort s;\n  StdStringLong l;\n};\n\nstatic void model_add_method (Model * self, const gchar * name, jmethodID id, jint modifiers);\nstatic void model_add_field (Model * self, const gchar * name, jfieldID id, jint modifiers);\nstatic void model_free (Model * model);\n\nstatic jboolean collect_matching_class_methods (ArtClassVisitor * self, ArtClass * klass);\nstatic gchar * finalize_method_groups_to_json (GHashTable * groups);\nstatic GPatternSpec * make_pattern_spec (const gchar * pattern, jboolean ignore_case);\nstatic gchar * class_name_from_signature (const gchar * signature);\nstatic gchar * format_method_signature (const gchar * name, const gchar * signature);\nstatic void append_type (GString * output, const gchar ** type);\n\nstatic gpointer read_art_array (gpointer object_base, guint field_offset, guint length_size, guint * length);\n\nstatic void std_string_destroy (StdString * str);\nstatic gchar * std_string_c_str (StdString * self);\n\nextern GMutex lock;\nextern GArray * models;\nextern JavaApi java_api;\nextern ArtApi art_api;\n\nvoid\ninit (void)\n{\n  g_mutex_init (&lock);\n  models = g_array_new (FALSE, FALSE, sizeof (Model *));\n}\n\nvoid\nfinalize (void)\n{\n  guint n, i;\n\n  n = models->len;\n  for (i = 0; i != n; i++)\n  {\n    Model * model = g_array_index (models, Model *, i);\n    model_free (model);\n  }\n\n  g_array_unref (models);\n  g_mutex_clear (&lock);\n}\n\nModel *\nmodel_new (jclass class_handle,\n           gpointer class_object,\n           JNIEnv * env)\n{\n  Model * model;\n  GHashTable * members;\n  jvmtiEnv * jvmti = java_api.jvmti;\n  gpointer * funcs = env->functions;\n  jmethodID (* from_reflected_method) (JNIEnv *, jobject) = funcs[7];\n  jfieldID (* from_reflected_field) (JNIEnv *, jobject) = funcs[8];\n  jobject (* to_reflected_method) (JNIEnv *, jclass, jmethodID, jboolean) = funcs[9];\n  jobject (* to_reflected_field) (JNIEnv *, jclass, jfieldID, jboolean) = funcs[12];\n  void (* delete_local_ref) (JNIEnv *, jobject) = funcs[23];\n  jobject (* call_object_method) (JNIEnv *, jobject, jmethodID, ...) = funcs[34];\n  jint (* call_int_method) (JNIEnv *, jobject, jmethodID, ...) = funcs[49];\n  const char * (* get_string_utf_chars) (JNIEnv *, jstring, jboolean *) = funcs[169];\n  void (* release_string_utf_chars) (JNIEnv *, jstring, const char *) = funcs[170];\n  jsize (* get_array_length) (JNIEnv *, jarray) = funcs[171];\n  jobject (* get_object_array_element) (JNIEnv *, jobjectArray, jsize) = funcs[173];\n  jsize n, i;\n\n  model = g_new (Model, 1);\n\n  members = g_hash_table_new_full (g_str_hash, g_str_equal, g_free, g_free);\n  model->members = members;\n\n  if (jvmti != NULL)\n  {\n    gpointer * jf = jvmti->functions - 1;\n    jvmtiError (* deallocate) (jvmtiEnv *, void * mem) = jf[47];\n    jvmtiError (* get_class_methods) (jvmtiEnv *, jclass, jint *, jmethodID **) = jf[52];\n    jvmtiError (* get_class_fields) (jvmtiEnv *, jclass, jint *, jfieldID **) = jf[53];\n    jvmtiError (* get_field_name) (jvmtiEnv *, jclass, jfieldID, char **, char **, char **) = jf[60];\n    jvmtiError (* get_field_modifiers) (jvmtiEnv *, jclass, jfieldID, jint *) = jf[62];\n    jvmtiError (* get_method_name) (jvmtiEnv *, jmethodID, char **, char **, char **) = jf[64];\n    jvmtiError (* get_method_modifiers) (jvmtiEnv *, jmethodID, jint *) = jf[66];\n    jint method_count;\n    jmethodID * methods;\n    jint field_count;\n    jfieldID * fields;\n    char * name;\n    jint modifiers;\n\n    get_class_methods (jvmti, class_handle, &method_count, &methods);\n    for (i = 0; i != method_count; i++)\n    {\n      jmethodID method = methods[i];\n\n      get_method_name (jvmti, method, &name, NULL, NULL);\n      get_method_modifiers (jvmti, method, &modifiers);\n\n      model_add_method (model, name, method, modifiers);\n\n      deallocate (jvmti, name);\n    }\n    deallocate (jvmti, methods);\n\n    get_class_fields (jvmti, class_handle, &field_count, &fields);\n    for (i = 0; i != field_count; i++)\n    {\n      jfieldID field = fields[i];\n\n      get_field_name (jvmti, class_handle, field, &name, NULL, NULL);\n      get_field_modifiers (jvmti, class_handle, field, &modifiers);\n\n      model_add_field (model, name, field, modifiers);\n\n      deallocate (jvmti, name);\n    }\n    deallocate (jvmti, fields);\n  }\n  else if (art_api.available)\n  {\n    gpointer elements;\n    guint n, i;\n    const guint field_arrays[] = {\n      art_api.class_offset_ifields,\n      art_api.class_offset_sfields\n    };\n    guint field_array_cursor;\n    gboolean merged_fields = art_api.class_offset_sfields == 0;\n\n    elements = read_art_array (class_object, art_api.class_offset_methods, sizeof (gsize), NULL);\n    n = *(guint16 *) (class_object + art_api.class_offset_copied_methods_offset);\n    for (i = 0; i != n; i++)\n    {\n      jmethodID id;\n      guint32 access_flags;\n      jboolean is_static;\n      jobject method, name;\n      const char * name_str;\n      jint modifiers;\n\n      id = elements + (i * art_api.method_size);\n\n      access_flags = *(guint32 *) (id + art_api.method_offset_access_flags);\n      if ((access_flags & kAccConstructor) != 0)\n        continue;\n      is_static = (access_flags & kAccStatic) != 0;\n      method = to_reflected_method (env, class_handle, id, is_static);\n      name = call_object_method (env, method, java_api.method.get_name);\n      name_str = get_string_utf_chars (env, name, NULL);\n      modifiers = access_flags & 0xffff;\n\n      model_add_method (model, name_str, id, modifiers);\n\n      release_string_utf_chars (env, name, name_str);\n      delete_local_ref (env, name);\n      delete_local_ref (env, method);\n    }\n\n    for (field_array_cursor = 0; field_array_cursor != G_N_ELEMENTS (field_arrays); field_array_cursor++)\n    {\n      jboolean is_static;\n\n      if (field_arrays[field_array_cursor] == 0)\n        continue;\n\n      if (!merged_fields)\n        is_static = field_array_cursor == 1;\n\n      elements = read_art_array (class_object, field_arrays[field_array_cursor], sizeof (guint32), &n);\n      for (i = 0; i != n; i++)\n      {\n        jfieldID id;\n        guint32 access_flags;\n        jobject field, name;\n        const char * name_str;\n        jint modifiers;\n\n        id = elements + (i * art_api.field_size);\n\n        access_flags = *(guint32 *) (id + art_api.field_offset_access_flags);\n        if (merged_fields)\n          is_static = (access_flags & kAccStatic) != 0;\n        field = to_reflected_field (env, class_handle, id, is_static);\n        name = call_object_method (env, field, java_api.field.get_name);\n        name_str = get_string_utf_chars (env, name, NULL);\n        modifiers = access_flags & 0xffff;\n\n        model_add_field (model, name_str, id, modifiers);\n\n        release_string_utf_chars (env, name, name_str);\n        delete_local_ref (env, name);\n        delete_local_ref (env, field);\n      }\n    }\n  }\n  else\n  {\n    jobject elements;\n\n    elements = call_object_method (env, class_handle, java_api.clazz.get_declared_methods);\n    n = get_array_length (env, elements);\n    for (i = 0; i != n; i++)\n    {\n      jobject method, name;\n      const char * name_str;\n      jmethodID id;\n      jint modifiers;\n\n      method = get_object_array_element (env, elements, i);\n      name = call_object_method (env, method, java_api.method.get_name);\n      name_str = get_string_utf_chars (env, name, NULL);\n      id = from_reflected_method (env, method);\n      modifiers = call_int_method (env, method, java_api.method.get_modifiers);\n\n      model_add_method (model, name_str, id, modifiers);\n\n      release_string_utf_chars (env, name, name_str);\n      delete_local_ref (env, name);\n      delete_local_ref (env, method);\n    }\n    delete_local_ref (env, elements);\n\n    elements = call_object_method (env, class_handle, java_api.clazz.get_declared_fields);\n    n = get_array_length (env, elements);\n    for (i = 0; i != n; i++)\n    {\n      jobject field, name;\n      const char * name_str;\n      jfieldID id;\n      jint modifiers;\n\n      field = get_object_array_element (env, elements, i);\n      name = call_object_method (env, field, java_api.field.get_name);\n      name_str = get_string_utf_chars (env, name, NULL);\n      id = from_reflected_field (env, field);\n      modifiers = call_int_method (env, field, java_api.field.get_modifiers);\n\n      model_add_field (model, name_str, id, modifiers);\n\n      release_string_utf_chars (env, name, name_str);\n      delete_local_ref (env, name);\n      delete_local_ref (env, field);\n    }\n    delete_local_ref (env, elements);\n  }\n\n  g_mutex_lock (&lock);\n  g_array_append_val (models, model);\n  g_mutex_unlock (&lock);\n\n  return model;\n}\n\nstatic void\nmodel_add_method (Model * self,\n                  const gchar * name,\n                  jmethodID id,\n                  jint modifiers)\n{\n  GHashTable * members = self->members;\n  gchar * key, type;\n  const gchar * value;\n\n  if (name[0] == '$')\n    key = g_strdup_printf (\"_%s\", name);\n  else\n    key = g_strdup (name);\n\n  type = (modifiers & kAccStatic) != 0 ? 's' : 'i';\n\n  value = g_hash_table_lookup (members, key);\n  if (value == NULL)\n    g_hash_table_insert (members, key, g_strdup_printf (\"m:%c0x%zx\", type, id));\n  else\n    g_hash_table_insert (members, key, g_strdup_printf (\"%s:%c0x%zx\", value, type, id));\n}\n\nstatic void\nmodel_add_field (Model * self,\n                 const gchar * name,\n                 jfieldID id,\n                 jint modifiers)\n{\n  GHashTable * members = self->members;\n  gchar * key, type;\n\n  if (name[0] == '$')\n    key = g_strdup_printf (\"_%s\", name);\n  else\n    key = g_strdup (name);\n  while (g_hash_table_contains (members, key))\n  {\n    gchar * new_key = g_strdup_printf (\"_%s\", key);\n    g_free (key);\n    key = new_key;\n  }\n\n  type = (modifiers & kAccStatic) != 0 ? 's' : 'i';\n\n  g_hash_table_insert (members, key, g_strdup_printf (\"f:%c0x%zx\", type, id));\n}\n\nstatic void\nmodel_free (Model * model)\n{\n  g_hash_table_unref (model->members);\n\n  g_free (model);\n}\n\ngboolean\nmodel_has (Model * self,\n           const gchar * member)\n{\n  return g_hash_table_contains (self->members, member);\n}\n\nconst gchar *\nmodel_find (Model * self,\n            const gchar * member)\n{\n  return g_hash_table_lookup (self->members, member);\n}\n\ngchar *\nmodel_list (Model * self)\n{\n  GString * result;\n  GHashTableIter iter;\n  guint i;\n  const gchar * name;\n\n  result = g_string_sized_new (128);\n\n  g_string_append_c (result, '[');\n\n  g_hash_table_iter_init (&iter, self->members);\n  for (i = 0; g_hash_table_iter_next (&iter, (gpointer *) &name, NULL); i++)\n  {\n    if (i > 0)\n      g_string_append_c (result, ',');\n\n    g_string_append_c (result, '\"');\n    g_string_append (result, name);\n    g_string_append_c (result, '\"');\n  }\n\n  g_string_append_c (result, ']');\n\n  return g_string_free (result, FALSE);\n}\n\ngchar *\nenumerate_methods_art (const gchar * class_query,\n                       const gchar * method_query,\n                       jboolean include_signature,\n                       jboolean ignore_case,\n                       jboolean skip_system_classes)\n{\n  gchar * result;\n  EnumerateMethodsContext ctx;\n  ArtClassVisitor visitor;\n  ArtClassVisitorVTable visitor_vtable = { NULL, };\n\n  ctx.class_query = make_pattern_spec (class_query, ignore_case);\n  ctx.method_query = make_pattern_spec (method_query, ignore_case);\n  ctx.include_signature = include_signature;\n  ctx.ignore_case = ignore_case;\n  ctx.skip_system_classes = skip_system_classes;\n  ctx.groups = g_hash_table_new_full (NULL, NULL, NULL, NULL);\n\n  visitor.vtable = &visitor_vtable;\n  visitor.user_data = &ctx;\n\n  visitor_vtable.visit = collect_matching_class_methods;\n\n  art_api.visit_classes (art_api.linker, &visitor);\n\n  result = finalize_method_groups_to_json (ctx.groups);\n\n  g_hash_table_unref (ctx.groups);\n  g_pattern_spec_free (ctx.method_query);\n  g_pattern_spec_free (ctx.class_query);\n\n  return result;\n}\n\nstatic jboolean\ncollect_matching_class_methods (ArtClassVisitor * self,\n                                ArtClass * klass)\n{\n  EnumerateMethodsContext * ctx = self->user_data;\n  const char * descriptor;\n  StdString descriptor_storage = { 0, };\n  gchar * class_name = NULL;\n  gchar * class_name_copy = NULL;\n  const gchar * normalized_class_name;\n  JsonBuilder * group;\n  size_t class_name_length;\n  GHashTable * seen_method_names;\n  gpointer elements;\n  guint n, i;\n\n  if (ctx->skip_system_classes && klass->class_loader == 0)\n    goto skip_class;\n\n  descriptor = art_api.get_class_descriptor (klass, &descriptor_storage);\n  if (descriptor[0] != 'L')\n    goto skip_class;\n\n  class_name = class_name_from_signature (descriptor);\n\n  if (ctx->ignore_case)\n  {\n    class_name_copy = g_utf8_strdown (class_name, -1);\n    normalized_class_name = class_name_copy;\n  }\n  else\n  {\n    normalized_class_name = class_name;\n  }\n\n  if (!g_pattern_match_string (ctx->class_query, normalized_class_name))\n    goto skip_class;\n\n  group = NULL;\n  class_name_length = strlen (class_name);\n  seen_method_names = ctx->include_signature ? NULL : g_hash_table_new_full (g_str_hash, g_str_equal, g_free, NULL);\n\n  elements = read_art_array (klass, art_api.class_offset_methods, sizeof (gsize), NULL);\n  n = *(guint16 *) ((gpointer) klass + art_api.class_offset_copied_methods_offset);\n  for (i = 0; i != n; i++)\n  {\n    ArtMethod * method;\n    guint32 access_flags;\n    jboolean is_constructor;\n    StdString method_name = { 0, };\n    const gchar * bare_method_name;\n    gchar * bare_method_name_copy = NULL;\n    const gchar * normalized_method_name;\n    gchar * normalized_method_name_copy = NULL;\n\n    method = elements + (i * art_api.method_size);\n\n    access_flags = *(guint32 *) ((gpointer) method + art_api.method_offset_access_flags);\n    is_constructor = (access_flags & kAccConstructor) != 0;\n\n    art_api.pretty_method (&method_name, method, ctx->include_signature);\n    bare_method_name = std_string_c_str (&method_name);\n    if (ctx->include_signature)\n    {\n      const gchar * return_type_end, * name_begin;\n      GString * name;\n\n      return_type_end = strchr (bare_method_name, ' ');\n      name_begin = return_type_end + 1 + class_name_length + 1;\n      if (is_constructor && g_str_has_prefix (name_begin, \"<clinit>\"))\n        goto skip_method;\n\n      name = g_string_sized_new (64);\n\n      if (is_constructor)\n      {\n        g_string_append (name, \"$init\");\n        g_string_append (name, strchr (name_begin, '>') + 1);\n      }\n      else\n      {\n        g_string_append (name, name_begin);\n      }\n      g_string_append (name, \": \");\n      g_string_append_len (name, bare_method_name, return_type_end - bare_method_name);\n\n      bare_method_name_copy = g_string_free (name, FALSE);\n      bare_method_name = bare_method_name_copy;\n    }\n    else\n    {\n      const gchar * name_begin;\n\n      name_begin = bare_method_name + class_name_length + 1;\n      if (is_constructor && strcmp (name_begin, \"<clinit>\") == 0)\n        goto skip_method;\n\n      if (is_constructor)\n        bare_method_name = \"$init\";\n      else\n        bare_method_name += class_name_length + 1;\n    }\n\n    if (seen_method_names != NULL && g_hash_table_contains (seen_method_names, bare_method_name))\n      goto skip_method;\n\n    if (ctx->ignore_case)\n    {\n      normalized_method_name_copy = g_utf8_strdown (bare_method_name, -1);\n      normalized_method_name = normalized_method_name_copy;\n    }\n    else\n    {\n      normalized_method_name = bare_method_name;\n    }\n\n    if (!g_pattern_match_string (ctx->method_query, normalized_method_name))\n      goto skip_method;\n\n    if (group == NULL)\n    {\n      group = g_hash_table_lookup (ctx->groups, GUINT_TO_POINTER (klass->class_loader));\n      if (group == NULL)\n      {\n        group = json_builder_new_immutable ();\n        g_hash_table_insert (ctx->groups, GUINT_TO_POINTER (klass->class_loader), group);\n\n        json_builder_begin_object (group);\n\n        json_builder_set_member_name (group, \"loader\");\n        json_builder_add_int_value (group, klass->class_loader);\n\n        json_builder_set_member_name (group, \"classes\");\n        json_builder_begin_array (group);\n      }\n\n      json_builder_begin_object (group);\n\n      json_builder_set_member_name (group, \"name\");\n      json_builder_add_string_value (group, class_name);\n\n      json_builder_set_member_name (group, \"methods\");\n      json_builder_begin_array (group);\n    }\n\n    json_builder_add_string_value (group, bare_method_name);\n\n    if (seen_method_names != NULL)\n      g_hash_table_add (seen_method_names, g_strdup (bare_method_name));\n\nskip_method:\n    g_free (normalized_method_name_copy);\n    g_free (bare_method_name_copy);\n    std_string_destroy (&method_name);\n  }\n\n  if (seen_method_names != NULL)\n    g_hash_table_unref (seen_method_names);\n\n  if (group == NULL)\n    goto skip_class;\n\n  json_builder_end_array (group);\n  json_builder_end_object (group);\n\nskip_class:\n  g_free (class_name_copy);\n  g_free (class_name);\n  std_string_destroy (&descriptor_storage);\n\n  return TRUE;\n}\n\ngchar *\nenumerate_methods_jvm (const gchar * class_query,\n                       const gchar * method_query,\n                       jboolean include_signature,\n                       jboolean ignore_case,\n                       jboolean skip_system_classes,\n                       JNIEnv * env)\n{\n  gchar * result;\n  GPatternSpec * class_pattern, * method_pattern;\n  GHashTable * groups;\n  gpointer * ef = env->functions;\n  jobject (* new_global_ref) (JNIEnv *, jobject) = ef[21];\n  void (* delete_local_ref) (JNIEnv *, jobject) = ef[23];\n  jboolean (* is_same_object) (JNIEnv *, jobject, jobject) = ef[24];\n  jvmtiEnv * jvmti = java_api.jvmti;\n  gpointer * jf = jvmti->functions - 1;\n  jvmtiError (* deallocate) (jvmtiEnv *, void * mem) = jf[47];\n  jvmtiError (* get_class_signature) (jvmtiEnv *, jclass, char **, char **) = jf[48];\n  jvmtiError (* get_class_methods) (jvmtiEnv *, jclass, jint *, jmethodID **) = jf[52];\n  jvmtiError (* get_class_loader) (jvmtiEnv *, jclass, jobject *) = jf[57];\n  jvmtiError (* get_method_name) (jvmtiEnv *, jmethodID, char **, char **, char **) = jf[64];\n  jvmtiError (* get_loaded_classes) (jvmtiEnv *, jint *, jclass **) = jf[78];\n  jint class_count, class_index;\n  jclass * classes;\n\n  class_pattern = make_pattern_spec (class_query, ignore_case);\n  method_pattern = make_pattern_spec (method_query, ignore_case);\n  groups = g_hash_table_new_full (NULL, NULL, NULL, NULL);\n\n  if (get_loaded_classes (jvmti, &class_count, &classes) != JVMTI_ERROR_NONE)\n    goto emit_results;\n\n  for (class_index = 0; class_index != class_count; class_index++)\n  {\n    jclass klass = classes[class_index];\n    jobject loader = NULL;\n    gboolean have_loader = FALSE;\n    char * signature = NULL;\n    gchar * class_name = NULL;\n    gchar * class_name_copy = NULL;\n    const gchar * normalized_class_name;\n    jint method_count, method_index;\n    jmethodID * methods = NULL;\n    JsonBuilder * group = NULL;\n    GHashTable * seen_method_names = NULL;\n\n    if (skip_system_classes)\n    {\n      if (get_class_loader (jvmti, klass, &loader) != JVMTI_ERROR_NONE)\n        goto skip_class;\n      have_loader = TRUE;\n\n      if (loader == NULL)\n        goto skip_class;\n    }\n\n    if (get_class_signature (jvmti, klass, &signature, NULL) != JVMTI_ERROR_NONE)\n      goto skip_class;\n\n    class_name = class_name_from_signature (signature);\n\n    if (ignore_case)\n    {\n      class_name_copy = g_utf8_strdown (class_name, -1);\n      normalized_class_name = class_name_copy;\n    }\n    else\n    {\n      normalized_class_name = class_name;\n    }\n\n    if (!g_pattern_match_string (class_pattern, normalized_class_name))\n      goto skip_class;\n\n    if (get_class_methods (jvmti, klass, &method_count, &methods) != JVMTI_ERROR_NONE)\n      goto skip_class;\n\n    if (!include_signature)\n      seen_method_names = g_hash_table_new_full (g_str_hash, g_str_equal, g_free, NULL);\n\n    for (method_index = 0; method_index != method_count; method_index++)\n    {\n      jmethodID method = methods[method_index];\n      const gchar * method_name;\n      char * method_name_value = NULL;\n      char * method_signature_value = NULL;\n      gchar * method_name_copy = NULL;\n      const gchar * normalized_method_name;\n      gchar * normalized_method_name_copy = NULL;\n\n      if (get_method_name (jvmti, method, &method_name_value, include_signature ? &method_signature_value : NULL, NULL) != JVMTI_ERROR_NONE)\n        goto skip_method;\n      method_name = method_name_value;\n\n      if (method_name[0] == '<')\n      {\n        if (strcmp (method_name, \"<init>\") == 0)\n          method_name = \"$init\";\n        else if (strcmp (method_name, \"<clinit>\") == 0)\n          goto skip_method;\n      }\n\n      if (include_signature)\n      {\n        method_name_copy = format_method_signature (method_name, method_signature_value);\n        method_name = method_name_copy;\n      }\n\n      if (seen_method_names != NULL && g_hash_table_contains (seen_method_names, method_name))\n        goto skip_method;\n\n      if (ignore_case)\n      {\n        normalized_method_name_copy = g_utf8_strdown (method_name, -1);\n        normalized_method_name = normalized_method_name_copy;\n      }\n      else\n      {\n        normalized_method_name = method_name;\n      }\n\n      if (!g_pattern_match_string (method_pattern, normalized_method_name))\n        goto skip_method;\n\n      if (group == NULL)\n      {\n        if (!have_loader && get_class_loader (jvmti, klass, &loader) != JVMTI_ERROR_NONE)\n          goto skip_method;\n\n        if (loader == NULL)\n        {\n          group = g_hash_table_lookup (groups, NULL);\n        }\n        else\n        {\n          GHashTableIter iter;\n          jobject cur_loader;\n          JsonBuilder * cur_group;\n\n          g_hash_table_iter_init (&iter, groups);\n          while (g_hash_table_iter_next (&iter, (gpointer *) &cur_loader, (gpointer *) &cur_group))\n          {\n            if (cur_loader != NULL && is_same_object (env, cur_loader, loader))\n            {\n              group = cur_group;\n              break;\n            }\n          }\n        }\n\n        if (group == NULL)\n        {\n          jobject l;\n          gchar * str;\n\n          l = (loader != NULL) ? new_global_ref (env, loader) : NULL;\n\n          group = json_builder_new_immutable ();\n          g_hash_table_insert (groups, l, group);\n\n          json_builder_begin_object (group);\n\n          json_builder_set_member_name (group, \"loader\");\n          str = g_strdup_printf (\"0x%\" G_GSIZE_MODIFIER \"x\", GPOINTER_TO_SIZE (l));\n          json_builder_add_string_value (group, str);\n          g_free (str);\n\n          json_builder_set_member_name (group, \"classes\");\n          json_builder_begin_array (group);\n        }\n\n        json_builder_begin_object (group);\n\n        json_builder_set_member_name (group, \"name\");\n        json_builder_add_string_value (group, class_name);\n\n        json_builder_set_member_name (group, \"methods\");\n        json_builder_begin_array (group);\n      }\n\n      json_builder_add_string_value (group, method_name);\n\n      if (seen_method_names != NULL)\n        g_hash_table_add (seen_method_names, g_strdup (method_name));\n\nskip_method:\n      g_free (normalized_method_name_copy);\n      g_free (method_name_copy);\n      deallocate (jvmti, method_signature_value);\n      deallocate (jvmti, method_name_value);\n    }\n\nskip_class:\n    if (group != NULL)\n    {\n      json_builder_end_array (group);\n      json_builder_end_object (group);\n    }\n\n    if (seen_method_names != NULL)\n      g_hash_table_unref (seen_method_names);\n\n    deallocate (jvmti, methods);\n\n    g_free (class_name_copy);\n    g_free (class_name);\n    deallocate (jvmti, signature);\n\n    if (loader != NULL)\n      delete_local_ref (env, loader);\n\n    delete_local_ref (env, klass);\n  }\n\n  deallocate (jvmti, classes);\n\nemit_results:\n  result = finalize_method_groups_to_json (groups);\n\n  g_hash_table_unref (groups);\n  g_pattern_spec_free (method_pattern);\n  g_pattern_spec_free (class_pattern);\n\n  return result;\n}\n\nstatic gchar *\nfinalize_method_groups_to_json (GHashTable * groups)\n{\n  GString * result;\n  GHashTableIter iter;\n  guint i;\n  JsonBuilder * group;\n\n  result = g_string_sized_new (1024);\n\n  g_string_append_c (result, '[');\n\n  g_hash_table_iter_init (&iter, groups);\n  for (i = 0; g_hash_table_iter_next (&iter, NULL, (gpointer *) &group); i++)\n  {\n    JsonNode * root;\n    gchar * json;\n\n    if (i > 0)\n      g_string_append_c (result, ',');\n\n    json_builder_end_array (group);\n    json_builder_end_object (group);\n\n    root = json_builder_get_root (group);\n    json = json_to_string (root, FALSE);\n    g_string_append (result, json);\n    g_free (json);\n    json_node_unref (root);\n\n    g_object_unref (group);\n  }\n\n  g_string_append_c (result, ']');\n\n  return g_string_free (result, FALSE);\n}\n\nstatic GPatternSpec *\nmake_pattern_spec (const gchar * pattern,\n                   jboolean ignore_case)\n{\n  GPatternSpec * spec;\n\n  if (ignore_case)\n  {\n    gchar * str = g_utf8_strdown (pattern, -1);\n    spec = g_pattern_spec_new (str);\n    g_free (str);\n  }\n  else\n  {\n    spec = g_pattern_spec_new (pattern);\n  }\n\n  return spec;\n}\n\nstatic gchar *\nclass_name_from_signature (const gchar * descriptor)\n{\n  gchar * result, * c;\n\n  result = g_strdup (descriptor + 1);\n\n  for (c = result; *c != '\\0'; c++)\n  {\n    if (*c == '/')\n      *c = '.';\n  }\n\n  c[-1] = '\\0';\n\n  return result;\n}\n\nstatic gchar *\nformat_method_signature (const gchar * name,\n                         const gchar * signature)\n{\n  GString * sig;\n  const gchar * cursor;\n  gint arg_index;\n\n  sig = g_string_sized_new (128);\n\n  g_string_append (sig, name);\n\n  cursor = signature;\n  arg_index = -1;\n  while (TRUE)\n  {\n    const gchar c = *cursor;\n\n    if (c == '(')\n    {\n      g_string_append_c (sig, c);\n      cursor++;\n      arg_index = 0;\n    }\n    else if (c == ')')\n    {\n      g_string_append_c (sig, c);\n      cursor++;\n      break;\n    }\n    else\n    {\n      if (arg_index >= 1)\n        g_string_append (sig, \", \");\n\n      append_type (sig, &cursor);\n\n      if (arg_index != -1)\n        arg_index++;\n    }\n  }\n\n  g_string_append (sig, \": \");\n  append_type (sig, &cursor);\n\n  return g_string_free (sig, FALSE);\n}\n\nstatic void\nappend_type (GString * output,\n             const gchar ** type)\n{\n  const gchar * cursor = *type;\n\n  switch (*cursor)\n  {\n    case 'Z':\n      g_string_append (output, \"boolean\");\n      cursor++;\n      break;\n    case 'B':\n      g_string_append (output, \"byte\");\n      cursor++;\n      break;\n    case 'C':\n      g_string_append (output, \"char\");\n      cursor++;\n      break;\n    case 'S':\n      g_string_append (output, \"short\");\n      cursor++;\n      break;\n    case 'I':\n      g_string_append (output, \"int\");\n      cursor++;\n      break;\n    case 'J':\n      g_string_append (output, \"long\");\n      cursor++;\n      break;\n    case 'F':\n      g_string_append (output, \"float\");\n      cursor++;\n      break;\n    case 'D':\n      g_string_append (output, \"double\");\n      cursor++;\n      break;\n    case 'V':\n      g_string_append (output, \"void\");\n      cursor++;\n      break;\n    case 'L':\n    {\n      gchar ch;\n\n      cursor++;\n      for (; (ch = *cursor) != ';'; cursor++)\n      {\n        g_string_append_c (output, (ch != '/') ? ch : '.');\n      }\n      cursor++;\n\n      break;\n    }\n    case '[':\n      *type = cursor + 1;\n      append_type (output, type);\n      g_string_append (output, \"[]\");\n      return;\n    default:\n      g_string_append (output, \"BUG\");\n      cursor++;\n  }\n\n  *type = cursor;\n}\n\nvoid\ndealloc (gpointer mem)\n{\n  g_free (mem);\n}\n\nstatic gpointer\nread_art_array (gpointer object_base,\n                guint field_offset,\n                guint length_size,\n                guint * length)\n{\n  gpointer result, header;\n  guint n;\n\n  header = GSIZE_TO_POINTER (*(guint64 *) (object_base + field_offset));\n  if (header != NULL)\n  {\n    result = header + length_size;\n    if (length_size == sizeof (guint32))\n      n = *(guint32 *) header;\n    else\n      n = *(guint64 *) header;\n  }\n  else\n  {\n    result = NULL;\n    n = 0;\n  }\n\n  if (length != NULL)\n    *length = n;\n\n  return result;\n}\n\nstatic void\nstd_string_destroy (StdString * str)\n{\n  if ((str->l.capacity & 1) != 0)\n    art_api.free (str->l.data);\n}\n\nstatic gchar *\nstd_string_c_str (StdString * self)\n{\n  if ((self->l.capacity & 1) != 0)\n    return self->l.data;\n\n  return self->s.data;\n}\n",{lock:s,models:l,java_api:c,art_api:m}),v={exceptions:"propagate"},y={exceptions:"propagate",scheduling:"exclusive"};return{handle:g,new:new NativeFunction(g.model_new,"pointer",["pointer","pointer","pointer"],v),has:new NativeFunction(g.model_has,"bool",["pointer","pointer"],y),find:new NativeFunction(g.model_find,"pointer",["pointer","pointer"],y),list:new NativeFunction(g.model_list,"pointer",["pointer"],y),enumerateMethodsArt:new NativeFunction(g.enumerate_methods_art,"pointer",["pointer","pointer","bool","bool","bool"],v),enumerateMethodsJvm:new NativeFunction(g.enumerate_methods_jvm,"pointer",["pointer","pointer","bool","bool","bool","pointer"],v),dealloc:new NativeFunction(g.dealloc,"void",["pointer"],y)}}(e),Jn=function(e,t){const n=Be();if("art"!==n.flavor)return $n;const r=n["art::JavaVMExt::DecodeGlobal"];return function(e,n,o){let i;return pt(t,n,n=>{const a=r(t,n,e);i=o(a)}),i}}(0,e.vm))}function $n(e,t,n){return n(NULL)}function Gn(e){return e?1:0}class Zn{constructor(e,t){this.items=new Map,this.capacity=e,this.destroy=t}dispose(e){const{items:t,destroy:n}=this;t.forEach(t=>{n(t,e)}),t.clear()}get(e){const{items:t}=this,n=t.get(e);return void 0!==n&&(t.delete(e),t.set(e,n)),n}set(e,t,n){const{items:r}=this,o=r.get(e);if(void 0!==o)r.delete(e),this.destroy(o,n);else if(r.size===this.capacity){const e=r.keys().next().value,t=r.get(e);r.delete(e),this.destroy(t,n)}r.set(e,t)}}var Bn=n(287);const qn=2,Hn=Bn.hp.from([3,0,7,14,0]),Wn="Ldalvik/annotation/Throws;",Kn=Bn.hp.from([0]);class Qn{constructor(){this.classes=[]}addClass(e){this.classes.push(e)}build(){const e=function(e){const t=new Set,n=new Set,r={},o=[],i=[],a={},s=new Set,l=new Set;e.forEach(e=>{const{name:c,superClass:d,sourceFileName:u}=e;t.add("this"),t.add(c),n.add(c),t.add(d),n.add(d),t.add(u),e.interfaces.forEach(e=>{t.add(e),n.add(e)}),e.fields.forEach(r=>{const[i,a]=r;t.add(i),t.add(a),n.add(a),o.push([e.name,a,i])}),e.methods.some(([e])=>"<init>"===e)||(e.methods.unshift(["<init>","V",[]]),s.add(c)),e.methods.forEach(o=>{const[u,p,h,f=[],m]=o;t.add(u);const _=function(e,o){const i=[e].concat(o),a=i.join("|");if(void 0!==r[a])return a;t.add(e),n.add(e),o.forEach(e=>{t.add(e),n.add(e)});const s=i.map(nr).join("");return t.add(s),r[a]=[a,s,e,o],a}(p,h);let g=null;if(f.length>0){const e=f.slice();e.sort(),g=e.join("|");let r=a[g];void 0===r&&(r={id:g,types:e},a[g]=r),t.add(Wn),n.add(Wn),f.forEach(e=>{t.add(e),n.add(e)}),t.add("value")}if(i.push([e.name,_,u,g,m]),"<init>"===u){l.add(c+"|"+_);const e=d+"|"+_;s.has(c)&&!l.has(e)&&(i.push([d,_,u,null,0]),l.add(e))}})});const c=Array.from(t);c.sort();const d=c.reduce((e,t,n)=>(e[t]=n,e),{}),u=Array.from(n).map(e=>d[e]);u.sort(Xn);const p=u.reduce((e,t,n)=>(e[c[t]]=n,e),{}),h=Object.keys(r).map(e=>r[e]);h.sort(Yn);const f={},m=h.map(e=>{const[,t,n,r]=e;let o;if(r.length>0){const e=r.join("|");o=f[e],void 0===o&&(o={types:r.map(e=>p[e]),offset:-1},f[e]=o)}else o=null;return[d[t],p[n],o]}),_=h.reduce((e,t,n)=>{const[r]=t;return e[r]=n,e},{}),g=Object.keys(f).map(e=>f[e]),v=o.map(e=>{const[t,n,r]=e;return[p[t],p[n],d[r]]});v.sort(er);const y=i.map(e=>{const[t,n,r,o,i]=e;return[p[t],_[n],d[r],o,i]});y.sort(tr);const b=Object.keys(a).map(e=>a[e]).map(e=>({id:e.id,type:p[Wn],value:d.value,thrownTypes:e.types.map(e=>p[e]),offset:-1})),C=b.map(e=>({id:e.id,items:[e],offset:-1})),w=C.reduce((e,t,n)=>(e[t.id]=n,e),{}),S={},E=[];return{classes:e.map(e=>{const t=p[e.name],n=p[e.superClass];let r;const o=e.interfaces.map(e=>p[e]);if(o.length>0){o.sort(Xn);const e=o.join("|");r=S[e],void 0===r&&(r={types:o,offset:-1},S[e]=r)}else r=null;const i=d[e.sourceFileName],a=y.reduce((e,n,r)=>{const[o,i,a,s,l]=n;return o===t&&e.push([r,a,s,i,l]),e},[]);let l=null;const c=a.filter(([,,e])=>null!==e).map(([e,,t])=>[e,C[w[t]]]);c.length>0&&(l={methods:c,offset:-1},E.push(l));const u=v.reduce((e,n,r)=>{const[o]=n;return o===t&&e.push([r>0?1:0,1]),e},[]),h=d["<init>"],f=a.filter(([,e])=>e===h).map(([t,,,r])=>{if(s.has(e.name)){let e=-1;const o=y.length;for(let t=0;t!==o;t++){const[o,i,a]=y[t];if(o===n&&a===h&&i===r){e=t;break}}return[t,65537,e]}return[t,65793,-1]}),m=function(e){let t=0;return e.map(([e,n],r)=>{let o;return o=0===r?[e,n]:[e-t,n],t=e,o})}(a.filter(([,e])=>e!==h).map(([e,,,,t])=>[e,257|t]));return{index:t,accessFlags:1,superClassIndex:n,interfaces:r,sourceFileIndex:i,annotationsDirectory:l,classData:{instanceFields:u,constructorMethods:f,virtualMethods:m,offset:-1}}}),interfaces:Object.keys(S).map(e=>S[e]),fields:v,methods:y,protos:m,parameters:g,annotationDirectories:E,annotationSets:C,throwsAnnotations:b,types:u,strings:c}}(this.classes),{classes:t,interfaces:n,fields:r,methods:o,protos:i,parameters:a,annotationDirectories:s,annotationSets:l,throwsAnnotations:c,types:d,strings:u}=e;let p=0;p+=112;const h=p,f=4*u.length;p+=f;const m=p,_=4*d.length;p+=_;const g=p,v=12*i.length;p+=v;const y=p,b=8*r.length;p+=b;const C=p,w=8*o.length;p+=w;const S=p,E=32*t.length;p+=E;const L=p,j=l.map(e=>{const t=p;return e.offset=t,p+=4+4*e.items.length,t}),N=t.reduce((e,t)=>(t.classData.constructorMethods.forEach(t=>{const[,n,r]=t;!(256&n)&&r>=0&&(t.push(p),e.push({offset:p,superConstructor:r}),p+=24)}),e),[]);s.forEach(e=>{e.offset=p,p+=16+8*e.methods.length});const A=n.map(e=>{p=or(p,4);const t=p;return e.offset=t,p+=4+2*e.types.length,t}),k=a.map(e=>{p=or(p,4);const t=p;return e.offset=t,p+=4+2*e.types.length,t}),M=[],P=u.map(e=>{const t=p,n=Bn.hp.from(rr(e.length)),r=Bn.hp.from(e,"utf8"),o=Bn.hp.concat([n,r,Kn]);return M.push(o),p+=o.length,t}),I=N.map(e=>{const t=p;return p+=Hn.length,t}),R=c.map(e=>{const t=function(e){const{thrownTypes:t}=e;return Bn.hp.from([qn].concat(rr(e.type)).concat([1]).concat(rr(e.value)).concat([28,t.length]).concat(t.reduce((e,t)=>(e.push(24,t),e),[])))}(e);return e.offset=p,p+=t.length,t}),x=t.map((e,t)=>{e.classData.offset=p;const n=function(e){const{instanceFields:t,constructorMethods:n,virtualMethods:r}=e.classData;return Bn.hp.from([0].concat(rr(t.length)).concat(rr(n.length)).concat(rr(r.length)).concat(t.reduce((e,[t,n])=>e.concat(rr(t)).concat(rr(n)),[])).concat(n.reduce((e,[t,n,,r])=>e.concat(rr(t)).concat(rr(n)).concat(rr(r||0)),[])).concat(r.reduce((e,[t,n])=>e.concat(rr(t)).concat(rr(n)).concat([0]),[])))}(e);return p+=n.length,n});p=or(p,4);const T=p,U=n.length+a.length,O=4+(r.length>0?1:0)+2+l.length+N.length+s.length+(U>0?1:0)+1+I.length+c.length+t.length+1;p+=4+12*O;const D=p-L,z=p,J=Bn.hp.alloc(z);J.write("dex\n035"),J.writeUInt32LE(z,32),J.writeUInt32LE(112,36),J.writeUInt32LE(305419896,40),J.writeUInt32LE(0,44),J.writeUInt32LE(0,48),J.writeUInt32LE(T,52),J.writeUInt32LE(u.length,56),J.writeUInt32LE(h,60),J.writeUInt32LE(d.length,64),J.writeUInt32LE(m,68),J.writeUInt32LE(i.length,72),J.writeUInt32LE(g,76),J.writeUInt32LE(r.length,80),J.writeUInt32LE(r.length>0?y:0,84),J.writeUInt32LE(o.length,88),J.writeUInt32LE(C,92),J.writeUInt32LE(t.length,96),J.writeUInt32LE(S,100),J.writeUInt32LE(D,104),J.writeUInt32LE(L,108),P.forEach((e,t)=>{J.writeUInt32LE(e,h+4*t)}),d.forEach((e,t)=>{J.writeUInt32LE(e,m+4*t)}),i.forEach((e,t)=>{const[n,r,o]=e,i=g+12*t;J.writeUInt32LE(n,i),J.writeUInt32LE(r,i+4),J.writeUInt32LE(null!==o?o.offset:0,i+8)}),r.forEach((e,t)=>{const[n,r,o]=e,i=y+8*t;J.writeUInt16LE(n,i),J.writeUInt16LE(r,i+2),J.writeUInt32LE(o,i+4)}),o.forEach((e,t)=>{const[n,r,o]=e,i=C+8*t;J.writeUInt16LE(n,i),J.writeUInt16LE(r,i+2),J.writeUInt32LE(o,i+4)}),t.forEach((e,t)=>{const{interfaces:n,annotationsDirectory:r}=e,o=null!==n?n.offset:0,i=null!==r?r.offset:0,a=S+32*t;J.writeUInt32LE(e.index,a),J.writeUInt32LE(e.accessFlags,a+4),J.writeUInt32LE(e.superClassIndex,a+8),J.writeUInt32LE(o,a+12),J.writeUInt32LE(e.sourceFileIndex,a+16),J.writeUInt32LE(i,a+20),J.writeUInt32LE(e.classData.offset,a+24),J.writeUInt32LE(0,a+28)}),l.forEach((e,t)=>{const{items:n}=e,r=j[t];J.writeUInt32LE(n.length,r),n.forEach((e,t)=>{J.writeUInt32LE(e.offset,r+4+4*t)})}),N.forEach((e,t)=>{const{offset:n,superConstructor:r}=e;J.writeUInt16LE(1,n),J.writeUInt16LE(1,n+2),J.writeUInt16LE(1,n+4),J.writeUInt16LE(0,n+6),J.writeUInt32LE(I[t],n+8),J.writeUInt32LE(4,n+12),J.writeUInt16LE(4208,n+16),J.writeUInt16LE(r,n+18),J.writeUInt16LE(0,n+20),J.writeUInt16LE(14,n+22)}),s.forEach(e=>{const t=e.offset,n=e.methods.length;J.writeUInt32LE(0,t),J.writeUInt32LE(0,t+4),J.writeUInt32LE(n,t+8),J.writeUInt32LE(0,t+12),e.methods.forEach((e,n)=>{const r=t+16+8*n,[o,i]=e;J.writeUInt32LE(o,r),J.writeUInt32LE(i.offset,r+4)})}),n.forEach((e,t)=>{const n=A[t];J.writeUInt32LE(e.types.length,n),e.types.forEach((e,t)=>{J.writeUInt16LE(e,n+4+2*t)})}),a.forEach((e,t)=>{const n=k[t];J.writeUInt32LE(e.types.length,n),e.types.forEach((e,t)=>{J.writeUInt16LE(e,n+4+2*t)})}),M.forEach((e,t)=>{e.copy(J,P[t])}),I.forEach(e=>{Hn.copy(J,e)}),R.forEach((e,t)=>{e.copy(J,c[t].offset)}),x.forEach((e,n)=>{e.copy(J,t[n].classData.offset)}),J.writeUInt32LE(O,T);const F=[[0,1,0],[1,u.length,h],[2,d.length,m],[3,i.length,g]];r.length>0&&F.push([4,r.length,y]),F.push([5,o.length,C]),F.push([6,t.length,S]),l.forEach((e,t)=>{F.push([4099,e.items.length,j[t]])}),N.forEach(e=>{F.push([8193,1,e.offset])}),s.forEach(e=>{F.push([8198,1,e.offset])}),U>0&&F.push([4097,U,A.concat(k)[0]]),F.push([8194,u.length,P[0]]),I.forEach(e=>{F.push([8195,1,e])}),c.forEach(e=>{F.push([8196,1,e.offset])}),t.forEach(e=>{F.push([8192,1,e.classData.offset])}),F.push([4096,1,T]),F.forEach((e,t)=>{const[n,r,o]=e,i=T+4+12*t;J.writeUInt16LE(n,i),J.writeUInt32LE(r,i+4),J.writeUInt32LE(o,i+8)});const V=new Checksum("sha1");return V.update(J.slice(32)),Bn.hp.from(V.getDigest()).copy(J,12),J.writeUInt32LE(function(e){let t=1,n=0;const r=e.length;for(let o=12;o<r;o++)t=(t+e[o])%65521,n=(n+t)%65521;return(n<<16|t)>>>0}(J),8),J}}function Xn(e,t){return e-t}function Yn(e,t){const[,,n,r]=e,[,,o,i]=t;if(n<o)return-1;if(n>o)return 1;const a=r.join("|"),s=i.join("|");return a<s?-1:a>s?1:0}function er(e,t){const[n,r,o]=e,[i,a,s]=t;return n!==i?n-i:o!==s?o-s:r-a}function tr(e,t){const[n,r,o]=e,[i,a,s]=t;return n!==i?n-i:o!==s?o-s:r-a}function nr(e){const t=e[0];return"L"===t||"["===t?"L":e}function rr(e){if(e<=127)return[e];const t=[];let n=!1;do{let r=127&e;n=0!=(e>>=7),n&&(r|=128),t.push(r)}while(n);return t}function or(e,t){const n=e%t;return 0===n?e:e+t-n}let ir=null,ar=null;function sr(e){ir=e}function lr(e,t,n){let r=ur(e);return null===r&&(0===e.indexOf("[")?r=hr(e,t,n):("L"===e[0]&&";"===e[e.length-1]&&(e=e.substring(1,e.length-1)),r=function(e,t,n){const r=n._types[t?1:0];let o=r[e];return void 0!==o||(o="java.lang.Object"===e?function(e){return{name:"Ljava/lang/Object;",type:"pointer",size:1,defaultValue:NULL,isCompatible:e=>null===e||void 0!==e&&(!!(e.$h instanceof NativePointer)||"string"==typeof e),fromJni:(t,n,r)=>t.isNull()?null:e.cast(t,e.use("java.lang.Object"),r),toJni:(e,t)=>null===e?NULL:"string"==typeof e?t.newStringUtf(e):e.$h}}(n):function(e,t,n){let r=null,o=null,i=null;function a(){return null===r&&(r=n.use(e).class),r}function s(){if(null===i){const e=a();i=n.use("java.lang.String").class.isAssignableFrom(e)}return i}return{name:_r(e),type:"pointer",size:1,defaultValue:NULL,isCompatible:e=>null===e||void 0!==e&&(e.$h instanceof NativePointer?function(e){const t=a();return null===o&&(o=t.isInstance.overload("java.lang.Object")),o.call(t,e)}(e):"string"==typeof e&&s()),fromJni:(r,o,i)=>r.isNull()?null:s()&&t?o.stringFromJni(r):n.cast(r,n.use(e),i),toJni:(e,t)=>null===e?NULL:"string"==typeof e?t.newStringUtf(e):e.$h,toString(){return this.name}}}(e,t,n),r[e]=o),o}(e,t,n))),Object.assign({className:e},r)}const cr={boolean:{name:"Z",type:"uint8",size:1,byteSize:1,defaultValue:!1,isCompatible:e=>"boolean"==typeof e,fromJni:e=>!!e,toJni:e=>e?1:0,read:e=>e.readU8(),write(e,t){e.writeU8(t)},toString(){return this.name}},byte:{name:"B",type:"int8",size:1,byteSize:1,defaultValue:0,isCompatible:e=>Number.isInteger(e)&&e>=-128&&e<=127,fromJni:gr,toJni:gr,read:e=>e.readS8(),write(e,t){e.writeS8(t)},toString(){return this.name}},char:{name:"C",type:"uint16",size:1,byteSize:2,defaultValue:0,isCompatible(e){if("string"!=typeof e||1!==e.length)return!1;const t=e.charCodeAt(0);return t>=0&&t<=65535},fromJni:e=>String.fromCharCode(e),toJni:e=>e.charCodeAt(0),read:e=>e.readU16(),write(e,t){e.writeU16(t)},toString(){return this.name}},short:{name:"S",type:"int16",size:1,byteSize:2,defaultValue:0,isCompatible:e=>Number.isInteger(e)&&e>=-32768&&e<=32767,fromJni:gr,toJni:gr,read:e=>e.readS16(),write(e,t){e.writeS16(t)},toString(){return this.name}},int:{name:"I",type:"int32",size:1,byteSize:4,defaultValue:0,isCompatible:e=>Number.isInteger(e)&&e>=-2147483648&&e<=2147483647,fromJni:gr,toJni:gr,read:e=>e.readS32(),write(e,t){e.writeS32(t)},toString(){return this.name}},long:{name:"J",type:"int64",size:2,byteSize:8,defaultValue:0,isCompatible:e=>"number"==typeof e||e instanceof Int64,fromJni:gr,toJni:gr,read:e=>e.readS64(),write(e,t){e.writeS64(t)},toString(){return this.name}},float:{name:"F",type:"float",size:1,byteSize:4,defaultValue:0,isCompatible:e=>"number"==typeof e,fromJni:gr,toJni:gr,read:e=>e.readFloat(),write(e,t){e.writeFloat(t)},toString(){return this.name}},double:{name:"D",type:"double",size:2,byteSize:8,defaultValue:0,isCompatible:e=>"number"==typeof e,fromJni:gr,toJni:gr,read:e=>e.readDouble(),write(e,t){e.writeDouble(t)},toString(){return this.name}},void:{name:"V",type:"void",size:0,byteSize:0,defaultValue:void 0,isCompatible:e=>void 0===e,fromJni(){},toJni:()=>NULL,toString(){return this.name}}},dr=new Set(Object.values(cr).map(e=>e.name));function ur(e){const t=cr[e];return void 0!==t?t:null}const pr=[["Z","boolean"],["B","byte"],["C","char"],["D","double"],["F","float"],["I","int"],["J","long"],["S","short"]].reduce((e,[t,n])=>(e["["+t]=function(e,t){const n=_.prototype,r=(i=t).charAt(0).toUpperCase()+i.slice(1),o={typeName:t,newArray:n["new"+r+"Array"],setRegion:n["set"+r+"ArrayRegion"],getElements:n["get"+r+"ArrayElements"],releaseElements:n["release"+r+"ArrayElements"]};var i;return{name:e,type:"pointer",size:1,defaultValue:NULL,isCompatible:e=>function(e,t){if(null===e)return!0;if(e instanceof mr)return e.$s.typeName===t;if("object"!=typeof e||void 0===e.length)return!1;const n=ur(t);return Array.prototype.every.call(e,e=>n.isCompatible(e))}(e,t),fromJni:(e,t,n)=>function(e,t,n,r){if(e.isNull())return null;return new mr(e,t,ur(t.typeName),n.getArrayLength(e),n,r)}(e,o,t,n),toJni:(e,t)=>function(e,t,n){if(null===e)return NULL;const r=e.$h;if(void 0!==r)return r;const o=e.length,i=ur(t.typeName),a=t.newArray.call(n,o);if(a.isNull())throw new Error("Unable to construct array");if(o>0){const r=i.byteSize,s=i.write,l=i.toJni,c=Memory.alloc(o*i.byteSize);for(let t=0;t!==o;t++)s(c.add(t*r),l(e[t]));t.setRegion.call(n,a,0,o,c),n.throwIfExceptionPending()}return a}(e,o,t)}}("["+t,n),e),{});function hr(e,t,n){const r=pr[e];if(void 0!==r)return r;if(0!==e.indexOf("["))throw new Error("Unsupported type: "+e);let o=e.substring(1);const i=lr(o,t,n);let a=0;const s=o.length;for(;a!==s&&"["===o[a];)a++;o=o.substring(a),"L"===o[0]&&";"===o[o.length-1]&&(o=o.substring(1,o.length-1));let l=o.replace(/\./g,"/");l=dr.has(l)?"[".repeat(a)+l:"[".repeat(a)+"L"+l+";";const c="["+l;return o="[".repeat(a)+o,{name:e.replace(/\./g,"/"),type:"pointer",size:1,defaultValue:NULL,isCompatible:e=>null===e||"object"==typeof e&&void 0!==e.length&&e.every(function(e){return i.isCompatible(e)}),fromJni(e,t,r){if(e.isNull())return null;const a=[],s=t.getArrayLength(e);for(let n=0;n!==s;n++){const r=t.getObjectArrayElement(e,n);try{a.push(i.fromJni(r,t))}finally{t.deleteLocalRef(r)}}try{a.$w=n.cast(e,n.use(c),r)}catch(t){n.use("java.lang.reflect.Array").newInstance(n.use(o).class,0),a.$w=n.cast(e,n.use(c),r)}return a.$dispose=fr,a},toJni(e,t){if(null===e)return NULL;if(!(e instanceof Array))throw new Error("Expected an array");const r=e.$w;if(void 0!==r)return r.$h;const a=e.length,s=n.use(o).$borrowClassHandle(t);try{const n=t.newObjectArray(a,s.value,NULL);t.throwIfExceptionPending();for(let r=0;r!==a;r++){const o=i.toJni(e[r],t);try{t.setObjectArrayElement(n,r,o)}finally{"pointer"===i.type&&1===t.getObjectRefType(o)&&t.deleteLocalRef(o)}t.throwIfExceptionPending()}return n}finally{s.unref(t)}}}}function fr(){const e=this.length;for(let t=0;t!==e;t++){const e=this[t];if(null===e)continue;const n=e.$dispose;if(void 0===n)break;n.call(e)}this.$w.$dispose()}function mr(e,t,n,r,o,i=!0){if(i){const t=o.newGlobalRef(e);this.$h=t,this.$r=Script.bindWeak(this,o.vm.makeHandleDestructor(t))}else this.$h=e,this.$r=null;return this.$s=t,this.$t=n,this.length=r,new Proxy(this,ar)}function _r(e){return"L"+e.replace(/\./g,"/")+";"}function gr(e){return e}ar={has:(e,t)=>t in e||null!==e.tryParseIndex(t),get(e,t,n){const r=e.tryParseIndex(t);return null===r?e[t]:e.readElement(r)},set(e,t,n,r){const o=e.tryParseIndex(t);return null===o?(e[t]=n,!0):(e.writeElement(o,n),!0)},ownKeys(e){const t=[],{length:n}=e;for(let e=0;e!==n;e++){const n=e.toString();t.push(n)}return t.push("length"),t},getOwnPropertyDescriptor:(e,t)=>null!==e.tryParseIndex(t)?{writable:!0,configurable:!0,enumerable:!0}:Object.getOwnPropertyDescriptor(e,t)},Object.defineProperties(mr.prototype,{$dispose:{enumerable:!0,value(){const e=this.$r;null!==e&&(this.$r=null,Script.unbindWeak(e))}},$clone:{value(e){return new mr(this.$h,this.$s,this.$t,this.length,e)}},tryParseIndex:{value(e){if("symbol"==typeof e)return null;const t=parseInt(e);return isNaN(t)||t<0||t>=this.length?null:t}},readElement:{value(e){return this.withElements(t=>{const n=this.$t;return n.fromJni(n.read(t.add(e*n.byteSize)))})}},writeElement:{value(e,t){const{$h:n,$s:r,$t:o}=this,i=ir.getEnv(),a=Memory.alloc(o.byteSize);o.write(a,o.toJni(t)),r.setRegion.call(i,n,e,1,a)}},withElements:{value(e){const{$h:t,$s:n}=this,r=ir.getEnv(),o=n.getElements.call(r,t);if(o.isNull())throw new Error("Unable to get array elements");try{return e(o)}finally{n.releaseElements.call(r,t,o)}}},toJSON:{value(){const{length:e,$t:t}=this,{byteSize:n,fromJni:r,read:o}=t;return this.withElements(t=>{const i=[];for(let a=0;a!==e;a++){const e=r(o(t.add(a*n)));i.push(e)}return i})}},toString:{value(){return this.toJSON().toString()}}});let{JO:vr,qD:yr}=e;const br=Symbol("PENDING_USE"),Cr="/data/local/tmp",{getCurrentThreadId:wr,pointerSize:Sr}=Process,Er={state:"empty",factories:[],loaders:null,Integer:null};let Lr=null,jr=null,Nr=null,Ar=null,kr=null,Mr=null,Pr=null,Ir=null,Rr=null;const xr=new Map;class Tr{static _initialize(e,t){Lr=e,jr=t,Nr="art"===t.flavor,"jvm"===t.flavor&&(vr=jn,yr=Pn)}static _disposeAll(e){Er.factories.forEach(t=>{t._dispose(e)})}static get(e){const t=function(){switch(Er.state){case"empty":{Er.state="pending";const e=Er.factories[0],t=e.use("java.util.HashMap"),n=e.use("java.lang.Integer");Er.loaders=t.$new(),Er.Integer=n;const r=e.loader;return null!==r&&Hr(e,r),Er.state="ready",Er}case"pending":do{Thread.sleep(.05)}while("pending"===Er.state);return Er;case"ready":return Er}}(),n=t.factories[0];if(null===e)return n;const r=t.loaders.get(e);if(null!==r){const e=n.cast(r,t.Integer);return t.factories[e.intValue()]}const o=new Tr;return o.loader=e,o.cacheDir=n.cacheDir,Hr(o,e),o}constructor(){this.cacheDir=Cr,this.codeCacheDir=Cr+"/dalvik-cache",this.tempFileNaming={prefix:"frida",suffix:""},this._classes={},this._classHandles=new Zn(10,Dr),this._patchedMethods=new Set,this._loader=null,this._types=[{},{}],Er.factories.push(this)}_dispose(e){Array.from(this._patchedMethods).forEach(e=>{e.implementation=null}),this._patchedMethods.clear(),Mt(),this._classHandles.dispose(e),this._classes={}}get loader(){return this._loader}set loader(e){const t=null===this._loader&&null!==e;this._loader=e,t&&"ready"===Er.state&&this===Er.factories[0]&&Hr(this,e)}use(e,t={}){const n="skip"!==t.cache;let r=n?this._getUsedClass(e):void 0;if(void 0===r)try{const t=Lr.getEnv(),{_loader:n}=this,o=null!==n?function(e,t,n){return null===Rr&&(Ir=n.vaMethod("pointer",["pointer"]),Rr=t.loadClass.overload("java.lang.String").handle),n=null,function(n){const r=n.newStringUtf(e),o=wr();Wr(o);try{const e=Ir(n.handle,t.$h,Rr,r);return n.throwIfExceptionPending(),e}finally{Kr(o),n.deleteLocalRef(r)}}}(e,n,t):function(e){const t=e.replace(/\./g,"/");return function(e){const n=wr();Wr(n);try{return e.findClass(t)}finally{Kr(n)}}}(e);r=this._make(e,o,t)}finally{n&&this._setUsedClass(e,r)}return r}_getUsedClass(e){let t;for(;(t=this._classes[e])===br;)Thread.sleep(.05);return void 0===t&&(this._classes[e]=br),t}_setUsedClass(e,t){void 0!==t?this._classes[e]=t:delete this._classes[e]}_make(e,t,n){const r=function(e,t,n,r){return Ur.call(this,e,t,n,r)},o=Object.create(Ur.prototype,{[Symbol.for("n")]:{value:e},$n:{get(){return this[Symbol.for("n")]}},[Symbol.for("C")]:{value:r},$C:{get(){return this[Symbol.for("C")]}},[Symbol.for("w")]:{value:null,writable:!0},$w:{get(){return this[Symbol.for("w")]},set(e){this[Symbol.for("w")]=e}},[Symbol.for("_s")]:{writable:!0},$_s:{get(){return this[Symbol.for("_s")]},set(e){this[Symbol.for("_s")]=e}},[Symbol.for("c")]:{value:[null]},$c:{get(){return this[Symbol.for("c")]}},[Symbol.for("m")]:{value:new Map},$m:{get(){return this[Symbol.for("m")]}},[Symbol.for("l")]:{value:null,writable:!0},$l:{get(){return this[Symbol.for("l")]},set(e){this[Symbol.for("l")]=e}},[Symbol.for("gch")]:{value:t},$gch:{get(){return this[Symbol.for("gch")]}},[Symbol.for("f")]:{value:this},$f:{get(){return this[Symbol.for("f")]}}});r.prototype=o;const i=new r(null);o[Symbol.for("w")]=i,o.$w=i;const a=i.$borrowClassHandle(n);try{const e=a.value;vr(n,e),o.$l=Fn.build(e,n)}finally{a.unref(n)}return i}retain(e){const t=Lr.getEnv();return e.$clone(t)}cast(e,t,n){const r=Lr.getEnv();let o=e.$h;void 0===o&&(o=e);const i=t.$borrowClassHandle(r);try{if(!r.isInstanceOf(o,i.value))throw new Error(`Cast from '${r.getObjectClassName(o)}' to '${t.$n}' isn't possible`)}finally{i.unref(r)}return new(0,t.$C)(o,1,r,n)}wrap(e,t,n){const r=new(0,t.$C)(e,1,n,!1);return r.$r=Script.bindWeak(r,Lr.makeHandleDestructor(e)),r}array(e,t){const n=Lr.getEnv(),r=ur(e);null!==r&&(e=r.name);const o=hr("["+e,!1,this),i=o.toJni(t,n);return o.fromJni(i,n,!0)}registerClass(e){const t=Lr.getEnv(),n=[];try{const r=this.use("java.lang.Class"),o=t.javaLangReflectMethod(),i=t.vaMethod("pointer",[]),a=e.name,s=e.implements||[],l=e.superClass||this.use("java.lang.Object"),c=[],d=[],u={name:_r(a),sourceFileName:Xr(a),superClass:_r(l.$n),interfaces:s.map(e=>_r(e.$n)),fields:c,methods:d},p=s.slice();s.forEach(e=>{Array.prototype.slice.call(e.class.getInterfaces()).forEach(e=>{const t=this.cast(e,r).getCanonicalName();p.push(this.use(t))})});const h=e.fields||{};Object.getOwnPropertyNames(h).forEach(e=>{const t=this._getType(h[e]);c.push([e,t.name])});const f={},m={};p.forEach(e=>{const r=e.$borrowClassHandle(t);n.push(r);const o=r.value;e.$ownMembers.filter(t=>void 0!==e[t].overloads).forEach(t=>{const n=e[t],r=n.overloads,i=r.map(e=>Jr(t,e.returnType,e.argumentTypes));f[t]=[n,i,o],r.forEach((e,t)=>{const n=i[t];m[n]=[e,o]})})});const _=e.methods||{},g=Object.keys(_).reduce((e,t)=>{const n=_[t],r="$init"===t?"<init>":t;return n instanceof Array?e.push(...n.map(e=>[r,e])):e.push([r,n]),e},[]),v=[];g.forEach(([e,n])=>{let r,a,s,l=3,c=[];if("function"==typeof n){const d=f[e];if(void 0!==d&&Array.isArray(d)){const[u,p,h]=d;if(p.length>1)throw new Error(`More than one overload matching '${e}': signature must be specified`);delete m[p[0]];const f=u.overloads[0];l=f.type,r=f.returnType,a=f.argumentTypes,s=n;const _=t.toReflectedMethod(h,f.handle,0),g=i(t.handle,_,o.getGenericExceptionTypes);c=Qr(t,g).map(_r),t.deleteLocalRef(g),t.deleteLocalRef(_)}else r=this._getType("void"),a=[],s=n}else{if(n.isStatic&&(l=2),r=this._getType(n.returnType||"void"),a=(n.argumentTypes||[]).map(e=>this._getType(e)),s=n.implementation,"function"!=typeof s)throw new Error("Expected a function implementation for method: "+e);const d=Jr(e,r,a),u=m[d];if(void 0!==u){const[e,n]=u;delete m[d],l=e.type,r=e.returnType,a=e.argumentTypes;const s=t.toReflectedMethod(n,e.handle,0),p=i(t.handle,s,o.getGenericExceptionTypes);c=Qr(t,p).map(_r),t.deleteLocalRef(p),t.deleteLocalRef(s)}}const u=r.name,p=a.map(e=>e.name),h="("+p.join("")+")"+u;d.push([e,u,p,c,2===l?8:0]),v.push([e,h,l,r,a,s])});const y=Object.keys(m);if(y.length>0)throw new Error("Missing implementation for: "+y.join(", "));const b=Br.fromBuffer(function(e){const t=new Qn,n=Object.assign({},e);return t.addClass(n),t.build()}(u),this);try{b.load()}finally{b.file.delete()}const C=this.use(e.name),w=g.length;if(w>0){const e=3*Sr,r=Memory.alloc(w*e),o=[],i=[];v.forEach(([t,n,a,s,l,c],d)=>{const u=Memory.allocUtf8String(t),p=Memory.allocUtf8String(n),h=Gr(t,C,a,s,l,c);r.add(d*e).writePointer(u),r.add(d*e+Sr).writePointer(p),r.add(d*e+2*Sr).writePointer(h),i.push(u,p),o.push(h)});const a=C.$borrowClassHandle(t);n.push(a);const s=a.value;t.registerNatives(s,r,w),t.throwIfExceptionPending(),C.$nativeMethods=o}return C}finally{n.forEach(e=>{e.unref(t)})}}choose(e,t){const n=Lr.getEnv(),{flavor:r}=jr;if("jvm"===r)this._chooseObjectsJvm(e,n,t);else if("art"===r){const r=void 0===jr["art::gc::Heap::VisitObjects"];if(r&&void 0===jr["art::gc::Heap::GetInstances"])return this._chooseObjectsJvm(e,n,t);pt(Lr,n,o=>{r?this._chooseObjectsArtPreA12(e,n,o,t):this._chooseObjectsArtLegacy(e,n,o,t)})}else this._chooseObjectsDalvik(e,n,t)}_chooseObjectsJvm(e,t,n){const r=this.use(e),{jvmti:o}=jr,i=r.$borrowClassHandle(t),a=int64(i.value.toString());try{const e=new NativeCallback((e,t,n,r)=>(n.writeS64(a),1),"int",["int64","int64","pointer","pointer"]);o.iterateOverInstancesOfClass(i.value,3,e,i.value);const s=Memory.alloc(8);s.writeS64(a);const l=Memory.alloc(4),c=Memory.alloc(Sr);o.getObjectsWithTags(1,s,l,c,NULL);const d=l.readS32(),u=c.readPointer(),p=[];for(let e=0;e!==d;e++)p.push(u.add(e*Sr).readPointer());o.deallocate(u);try{for(const e of p){const t=this.cast(e,r);if("stop"===n.onMatch(t))break}n.onComplete()}finally{p.forEach(e=>{t.deleteLocalRef(e)})}}finally{i.unref(t)}}_chooseObjectsArtPreA12(e,t,n,r){const o=this.use(e),i=dn.$new(n,Lr);let a;const s=o.$borrowClassHandle(t);try{const e=jr["art::JavaVMExt::DecodeGlobal"](jr.vm,n,s.value);a=i.newHandle(e)}finally{s.unref(t)}const l=nn.$new();jr["art::gc::Heap::GetInstances"](jr.artHeap,i,a,0,l);const c=l.handles.map(e=>t.newGlobalRef(e));l.$delete(),i.$delete();try{for(const e of c){const t=this.cast(e,o);if("stop"===r.onMatch(t))break}r.onComplete()}finally{c.forEach(e=>{t.deleteGlobalRef(e)})}}_chooseObjectsArtLegacy(e,t,n,r){const o=this.use(e),i=[],a=jr["art::JavaVMExt::AddGlobalRef"],s=jr.vm;let l;const c=o.$borrowClassHandle(t);try{l=jr["art::JavaVMExt::DecodeGlobal"](s,n,c.value).toInt32()}finally{c.unref(t)}const d=hn(l,e=>{i.push(a(s,n,e))});jr["art::gc::Heap::VisitObjects"](jr.artHeap,d,NULL);try{for(const e of i){const t=this.cast(e,o);if("stop"===r.onMatch(t))break}}finally{i.forEach(e=>{t.deleteGlobalRef(e)})}r.onComplete()}_chooseObjectsDalvik(t,n,r){const o=this.use(t);if(null===jr.addLocalReference){const e=Process.getModuleByName("libdvm.so");let t;switch(Process.arch){case"arm":t="2d e9 f0 41 05 46 15 4e 0c 46 7e 44 11 b3 43 68";break;case"ia32":t="8d 64 24 d4 89 5c 24 1c 89 74 24 20 e8 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 85 d2"}Memory.scan(e.base,e.size,t,{onMatch:(e,t)=>{let n;if("arm"===Process.arch)e=e.or(1),n=new NativeFunction(e,"pointer",["pointer","pointer"]);else{const t=Memory.alloc(Process.pageSize);Memory.patchCode(t,16,n=>{const r=new X86Writer(n,{pc:t});r.putMovRegRegOffsetPtr("eax","esp",4),r.putMovRegRegOffsetPtr("edx","esp",8),r.putJmpAddress(e),r.flush()}),n=new NativeFunction(t,"pointer",["pointer","pointer"]),n._thunk=t}return jr.addLocalReference=n,Lr.perform(e=>{i(this,e)}),"stop"},onError(e){},onComplete(){null===jr.addLocalReference&&r.onComplete()}})}else i(this,n);function i(t,n){const{NB:i}=e,a=n.handle.add(i).readPointer();let s;const l=o.$borrowClassHandle(n);try{s=jr.dvmDecodeIndirectRef(a,l.value)}finally{l.unref(n)}const c=s.toMatchPattern(),d=jr.dvmHeapSourceGetBase(),u=jr.dvmHeapSourceGetLimit().sub(d).toInt32();Memory.scan(d,u,c,{onMatch:(e,n)=>{jr.dvmIsValidObject(e)&&Lr.perform(n=>{const a=n.handle.add(i).readPointer();let s;const l=jr.addLocalReference(a,e);try{s=t.cast(l,o)}finally{n.deleteLocalRef(l)}if("stop"===r.onMatch(s))return"stop"})},onError(e){},onComplete(){r.onComplete()}})}}openClassFile(e){return new Br(e,null,this)}_getType(e,t=!0){return lr(e,t,this)}}function Ur(e,t,n,r=!0){if(null!==e)if(r){const t=n.newGlobalRef(e);this.$h=t,this.$r=Script.bindWeak(this,Lr.makeHandleDestructor(t))}else this.$h=e,this.$r=null;else this.$h=null,this.$r=null;return this.$t=t,new Proxy(this,Ar)}function Or(e,t){this.value=t.newGlobalRef(e),t.deleteLocalRef(e),this.refs=1}function Dr(e,t){e.unref(t)}function zr(e){const t=function(){const e=function(){return e.invoke(this,arguments)};return e}();return Object.setPrototypeOf(t,kr),t._o=e,t}function Jr(e,t,n){return`${t.className} ${e}(${n.map(e=>e.className).join(", ")})`}function Fr(e){const t=e._o;t.length>1&&Vr(t[0].methodName,t,"has more than one overload, use .overload(<signature>) to choose from:")}function Vr(e,t,n){const r=t.slice().sort((e,t)=>e.argumentTypes.length-t.argumentTypes.length).map(e=>e.argumentTypes.length>0?".overload('"+e.argumentTypes.map(e=>e.className).join("', '")+"')":".overload()");throw new Error(`${e}(): ${n}\n\t${r.join("\n\t")}`)}function $r(e,t,n,r,o,i,a,s){const l=o.type,c=i.map(e=>e.type);let d,u;return null===a&&(a=Lr.getEnv()),3===n?(d=a.vaMethod(l,c,s),u=a.nonvirtualVaMethod(l,c,s)):2===n?(d=a.staticVaMethod(l,c,s),u=d):(d=a.constructor(c,s),u=d),function(e){const t=function(){const e=function(){return e.invoke(this,arguments)};return e}();return Object.setPrototypeOf(t,Mr),t._p=e,t}([e,t,n,r,o,i,d,u])}function Gr(e,t,n,r,o,i,a=null){const s=new Set,l=(c=[e,t,n,r,o,i,a,s],function(){return function(e,t){const n=new _(e[0],Lr),[r,o,i,a,s,l,c,d]=t,u=[];let p;p=3===i?new(0,o.$C)(e[1],1,n,!1):o;const h=wr();n.pushLocalFrame(3);let f=!0;Lr.link(h,n);try{let t;d.add(h),t=null!==c&&xr.has(h)?c:l;const o=[],i=e.length-2;for(let t=0;t!==i;t++){const r=s[t].fromJni(e[2+t],n,!1);o.push(r),u.push(r)}const m=t.apply(p,o);if(!a.isCompatible(m))throw new Error(`Implementation for ${r} expected return value compatible with ${a.className}`);let _=a.toJni(m,n);return"pointer"===a.type&&(_=n.popLocalFrame(_),f=!1,u.push(m)),_}catch(e){const t=e.$h;return void 0!==t?n.throw(t):Script.nextTick(()=>{throw e}),a.defaultValue}finally{Lr.unlink(h),f&&n.popLocalFrame(NULL),d.delete(h),u.forEach(e=>{if(null===e)return;const t=e.$dispose;void 0!==t&&t.call(e)})}}(arguments,c)});var c;const d=new NativeCallback(l,r.type,["pointer","pointer"].concat(o.map(e=>e.type)));return d._c=s,d}function Zr(e){this._p=e}Ar={has:(e,t)=>t in e||e.$has(t),get(e,t,n){if("string"!=typeof t||t.startsWith("$")||"class"===t)return e[t];const r=e.$find(t);return null!==r?r(n):e[t]},set:(e,t,n,r)=>(e[t]=n,!0),ownKeys:e=>e.$list(),getOwnPropertyDescriptor:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)?Object.getOwnPropertyDescriptor(e,t):{writable:!1,configurable:!0,enumerable:!0}},Object.defineProperties(Ur.prototype,{[Symbol.for("new")]:{enumerable:!1,get(){return this.$getCtor("allocAndInit")}},$new:{enumerable:!0,get(){return this[Symbol.for("new")]}},[Symbol.for("alloc")]:{enumerable:!1,value(){const e=Lr.getEnv(),t=this.$borrowClassHandle(e);try{const n=e.allocObject(t.value);return this.$f.cast(n,this)}finally{t.unref(e)}}},$alloc:{enumerable:!0,get(){return this[Symbol.for("alloc")]}},[Symbol.for("init")]:{enumerable:!1,get(){return this.$getCtor("initOnly")}},$init:{enumerable:!0,get(){return this[Symbol.for("init")]}},[Symbol.for("dispose")]:{enumerable:!1,value(){const e=this.$r;null!==e&&(this.$r=null,Script.unbindWeak(e)),null!==this.$h&&(this.$h=void 0)}},$dispose:{enumerable:!0,get(){return this[Symbol.for("dispose")]}},[Symbol.for("clone")]:{enumerable:!1,value(e){return new(0,this.$C)(this.$h,this.$t,e)}},$clone:{value(e){return this[Symbol.for("clone")](e)}},[Symbol.for("class")]:{enumerable:!1,get(){const e=Lr.getEnv(),t=this.$borrowClassHandle(e);try{const e=this.$f;return e.cast(t.value,e.use("java.lang.Class"))}finally{t.unref(e)}}},class:{enumerable:!0,get(){return this[Symbol.for("class")]}},[Symbol.for("className")]:{enumerable:!1,get(){const e=this.$h;return null===e?this.$n:Lr.getEnv().getObjectClassName(e)}},$className:{enumerable:!0,get(){return this[Symbol.for("className")]}},[Symbol.for("ownMembers")]:{enumerable:!1,get(){return this.$l.list()}},$ownMembers:{enumerable:!0,get(){return this[Symbol.for("ownMembers")]}},[Symbol.for("super")]:{enumerable:!1,get(){const e=Lr.getEnv();return new(0,this.$s.$C)(this.$h,2,e)}},$super:{enumerable:!0,get(){return this[Symbol.for("super")]}},[Symbol.for("s")]:{enumerable:!1,get(){const e=Object.getPrototypeOf(this);let t=e.$_s;if(void 0===t){const r=Lr.getEnv(),o=this.$borrowClassHandle(r);try{const i=r.getSuperclass(o.value);if(i.isNull())t=null;else try{const o=r.getClassName(i),a=e.$f;if(t=a._getUsedClass(o),void 0===t)try{const e=(n=this,function(e){const t=n.$borrowClassHandle(e);try{return e.getSuperclass(t.value)}finally{t.unref(e)}});t=a._make(o,e,r)}finally{a._setUsedClass(o,t)}}finally{r.deleteLocalRef(i)}}finally{o.unref(r)}e.$_s=t}var n;return t}},$s:{get(){return this[Symbol.for("s")]}},[Symbol.for("isSameObject")]:{enumerable:!1,value(e){return Lr.getEnv().isSameObject(e.$h,this.$h)}},$isSameObject:{value(e){return this[Symbol.for("isSameObject")](e)}},[Symbol.for("getCtor")]:{enumerable:!1,value(e){const t=this.$c;let n=t[0];if(null===n){const e=Lr.getEnv(),r=this.$borrowClassHandle(e);try{n=function(e,t,n){const{$n:r,$f:o}=t,i=function(e){return e.slice(e.lastIndexOf(".")+1)}(r),a=n.javaLangClass(),s=n.javaLangReflectConstructor(),l=n.vaMethod("pointer",[]),c=n.vaMethod("uint8",[]),d=[],u=[],p=o._getType(r,!1),h=o._getType("void",!1),f=l(n.handle,e,a.getDeclaredConstructors);try{const r=n.getArrayLength(f);if(0!==r)for(let e=0;e!==r;e++){let r,a;const c=n.getObjectArrayElement(f,e);try{r=n.fromReflectedMethod(c),a=l(n.handle,c,s.getGenericParameterTypes)}finally{n.deleteLocalRef(c)}let m;try{m=Qr(n,a).map(e=>o._getType(e))}finally{n.deleteLocalRef(a)}d.push($r(i,t,1,r,p,m,n)),u.push($r(i,t,3,r,h,m,n))}else{if(c(n.handle,e,a.isInterface))throw new Error("cannot instantiate an interface");const r=n.javaLangObject(),o=n.getMethodId(r,"<init>","()V");d.push($r(i,t,1,o,p,[],n)),u.push($r(i,t,3,o,h,[],n))}}finally{n.deleteLocalRef(f)}if(0===u.length)throw new Error("no supported overloads");return{allocAndInit:zr(d),initOnly:zr(u)}}(r.value,this.$w,e),t[0]=n}finally{r.unref(e)}}return n[e]}},$getCtor:{value(e){return this[Symbol.for("getCtor")](e)}},[Symbol.for("borrowClassHandle")]:{enumerable:!1,value(e){const t=this.$n,n=this.$f._classHandles;let r=n.get(t);return void 0===r&&(r=new Or(this.$gch(e),e),n.set(t,r,e)),r.ref()}},$borrowClassHandle:{value(e){return this[Symbol.for("borrowClassHandle")](e)}},[Symbol.for("copyClassHandle")]:{enumerable:!1,value(e){const t=this.$borrowClassHandle(e);try{return e.newLocalRef(t.value)}finally{t.unref(e)}}},$copyClassHandle:{value(e){return this[Symbol.for("copyClassHandle")](e)}},[Symbol.for("getHandle")]:{enumerable:!1,value(e){const t=this.$h;if(void 0===t)throw new Error("Wrapper is disposed; perhaps it was borrowed from a hook instead of calling Java.retain() to make a long-lived wrapper?");return t}},$getHandle:{value(e){return this[Symbol.for("getHandle")](e)}},[Symbol.for("list")]:{enumerable:!1,value(){const e=this.$s,t=null!==e?e.$list():[],n=this.$l;return Array.from(new Set(t.concat(n.list())))}},$list:{get(){return this[Symbol.for("list")]}},[Symbol.for("has")]:{enumerable:!1,value(e){if(this.$m.has(e))return!0;if(this.$l.has(e))return!0;const t=this.$s;return!(null===t||!t.$has(e))}},$has:{value(e){return this[Symbol.for("has")](e)}},[Symbol.for("find")]:{enumerable:!1,value(e){const t=this.$m;let n=t.get(e);if(void 0!==n)return n;const r=this.$l.find(e);if(null!==r){const o=Lr.getEnv(),i=this.$borrowClassHandle(o);try{n=function(e,t,n,r,o){return t.startsWith("m")?function(e,t,n,r,o){const{$f:i}=r,a=t.split(":").slice(1),s=o.javaLangReflectMethod(),l=o.vaMethod("pointer",[]),c=o.vaMethod("uint8",[]),d=a.map(t=>{const a="s"===t[0]?2:3,d=ptr(t.substr(1));let u;const p=[],h=o.toReflectedMethod(n,d,2===a?1:0);try{const e=!!c(o.handle,h,s.isVarArgs),t=l(o.handle,h,s.getGenericReturnType);o.throwIfExceptionPending();try{u=i._getType(o.getTypeName(t))}finally{o.deleteLocalRef(t)}const n=l(o.handle,h,s.getParameterTypes);try{const t=o.getArrayLength(n);for(let r=0;r!==t;r++){const a=o.getObjectArrayElement(n,r);let s;try{s=e&&r===t-1?o.getArrayTypeName(a):o.getTypeName(a)}finally{o.deleteLocalRef(a)}const l=i._getType(s);p.push(l)}}finally{o.deleteLocalRef(n)}}catch(e){return null}finally{o.deleteLocalRef(h)}return $r(e,r,a,d,u,p,o)}).filter(e=>null!==e);if(0===d.length)throw new Error("No supported overloads");"valueOf"===e&&function(e){const{holder:t,type:n}=e[0];e.some(e=>e.type===n&&0===e.argumentTypes.length)||e.push(function(e){const t=function(){return this};return Object.setPrototypeOf(t,Pr),t._p=e,t}([t,n]))}(d);const u=zr(d);return function(e){return u}}(e,t,n,r,o):function(e,t,n,r,o){const i="s"===t[2]?1:2,a=ptr(t.substr(3)),{$f:s}=r;let l;const c=o.toReflectedField(n,a,1===i?1:0);try{l=o.vaMethod("pointer",[])(o.handle,c,o.javaLangReflectField().getGenericType),o.throwIfExceptionPending()}finally{o.deleteLocalRef(c)}let d,u,p;try{d=s._getType(o.getTypeName(l))}finally{o.deleteLocalRef(l)}const h=d.type;return 1===i?(u=o.getStaticField(h),p=o.setStaticField(h)):(u=o.getField(h),p=o.setField(h)),f=[i,d,a,u,p],function(e){return new Zr([e].concat(f))};var f}(0,t,n,r,o)}(e,r,i.value,this.$w,o)}finally{i.unref(o)}return t.set(e,n),n}const o=this.$s;return null!==o?o.$find(e):null}},$find:{value(e){return this[Symbol.for("find")](e)}},[Symbol.for("toJSON")]:{enumerable:!1,value(){const e=this.$n;if(null===this.$h)return`<class: ${e}>`;const t=this.$className;return e===t?`<instance: ${e}>`:`<instance: ${e}, $className: ${t}>`}},toJSON:{get(){return this[Symbol.for("toJSON")]}}}),Or.prototype.ref=function(){return this.refs++,this},Or.prototype.unref=function(e){0===--this.refs&&e.deleteGlobalRef(this.value)},kr=Object.create(Function.prototype,{overloads:{enumerable:!0,get(){return this._o}},overload:{value(...e){const t=this._o,n=e.length,r=e.join(":");for(let e=0;e!==t.length;e++){const o=t[e],{argumentTypes:i}=o;if(i.length===n&&i.map(e=>e.className).join(":")===r)return o}Vr(this.methodName,this.overloads,"specified argument types do not match any of:")}},methodName:{enumerable:!0,get(){return this._o[0].methodName}},holder:{enumerable:!0,get(){return this._o[0].holder}},type:{enumerable:!0,get(){return this._o[0].type}},handle:{enumerable:!0,get(){return Fr(this),this._o[0].handle}},implementation:{enumerable:!0,get(){return Fr(this),this._o[0].implementation},set(e){Fr(this),this._o[0].implementation=e}},returnType:{enumerable:!0,get(){return Fr(this),this._o[0].returnType}},argumentTypes:{enumerable:!0,get(){return Fr(this),this._o[0].argumentTypes}},canInvokeWith:{enumerable:!0,get(e){return Fr(this),this._o[0].canInvokeWith}},clone:{enumerable:!0,value(e){return Fr(this),this._o[0].clone(e)}},invoke:{value(e,t){const n=this._o,r=null!==e.$h;for(let o=0;o!==n.length;o++){const i=n[o];if(i.canInvokeWith(t)){if(3===i.type&&!r){const t=this.methodName;if("toString"===t)return`<class: ${e.$n}>`;throw new Error(t+": cannot call instance method without an instance")}return i.apply(e,t)}}if("toString"===this.methodName)return`<class: ${e.$n}>`;Vr(this.methodName,this.overloads,"argument types do not match any of:")}}}),Mr=Object.create(Function.prototype,{methodName:{enumerable:!0,get(){return this._p[0]}},holder:{enumerable:!0,get(){return this._p[1]}},type:{enumerable:!0,get(){return this._p[2]}},handle:{enumerable:!0,get(){return this._p[3]}},implementation:{enumerable:!0,get(){const e=this._r;return void 0!==e?e:null},set(e){const t=this._p,n=t[1];if(1===t[2])throw new Error("Reimplementing $new is not possible; replace implementation of $init instead");const r=this._r;if(void 0!==r&&(n.$f._patchedMethods.delete(this),r._m.revert(Lr),this._r=void 0),null!==e){const[r,o,i,a,s,l]=t,c=Gr(r,o,i,s,l,e,this),d=yr(a);c._m=d,this._r=c,d.replace(c,3===i,l,Lr,jr),n.$f._patchedMethods.add(this)}}},returnType:{enumerable:!0,get(){return this._p[4]}},argumentTypes:{enumerable:!0,get(){return this._p[5]}},canInvokeWith:{enumerable:!0,value(e){const t=this._p[5];return e.length===t.length&&t.every((t,n)=>t.isCompatible(e[n]))}},clone:{enumerable:!0,value(e){return $r(...this._p.slice(0,6),null,e)}},invoke:{value(e,t){const n=Lr.getEnv(),r=this._p,o=r[2],i=r[4],a=r[5],s=this._r,l=3===o,c=t.length,d=2+c;n.pushLocalFrame(d);let u=null;try{let o,d;l?o=e.$getHandle():(u=e.$borrowClassHandle(n),o=u.value);let p=e.$t;void 0===s?d=r[3]:(d=s._m.resolveTarget(e,l,n,jr),Nr&&s._c.has(wr())&&(p=2));const h=[n.handle,o,d];for(let e=0;e!==c;e++)h.push(a[e].toJni(t[e],n));let f;1===p?f=r[6]:(f=r[7],l&&h.splice(2,0,e.$copyClassHandle(n)));const m=f.apply(null,h);return n.throwIfExceptionPending(),i.fromJni(m,n,!0)}finally{null!==u&&u.unref(n),n.popLocalFrame(NULL)}}},toString:{enumerable:!0,value(){return`function ${this.methodName}(${this.argumentTypes.map(e=>e.className).join(", ")}): ${this.returnType.className}`}}}),Pr=Object.create(Function.prototype,{methodName:{enumerable:!0,get:()=>"valueOf"},holder:{enumerable:!0,get(){return this._p[0]}},type:{enumerable:!0,get(){return this._p[1]}},handle:{enumerable:!0,get:()=>NULL},implementation:{enumerable:!0,get:()=>null,set(e){}},returnType:{enumerable:!0,get(){const e=this.holder;return e.$f.use(e.$n)}},argumentTypes:{enumerable:!0,get:()=>[]},canInvokeWith:{enumerable:!0,value:e=>0===e.length},clone:{enumerable:!0,value(e){throw new Error("Invalid operation")}}}),Object.defineProperties(Zr.prototype,{value:{enumerable:!0,get(){const[e,t,n,r,o]=this._p,i=Lr.getEnv();i.pushLocalFrame(4);let a=null;try{let s;if(2===t){if(s=e.$getHandle(),null===s)throw new Error("Cannot access an instance field without an instance")}else a=e.$borrowClassHandle(i),s=a.value;const l=o(i.handle,s,r);return i.throwIfExceptionPending(),n.fromJni(l,i,!0)}finally{null!==a&&a.unref(i),i.popLocalFrame(NULL)}},set(e){const[t,n,r,o,,i]=this._p,a=Lr.getEnv();a.pushLocalFrame(4);let s=null;try{let l;if(2===n){if(l=t.$getHandle(),null===l)throw new Error("Cannot access an instance field without an instance")}else s=t.$borrowClassHandle(a),l=s.value;if(!r.isCompatible(e))throw new Error(`Expected value compatible with ${r.className}`);const c=r.toJni(e,a);i(a.handle,l,o,c),a.throwIfExceptionPending()}finally{null!==s&&s.unref(a),a.popLocalFrame(NULL)}}},holder:{enumerable:!0,get(){return this._p[0]}},fieldType:{enumerable:!0,get(){return this._p[1]}},fieldReturnType:{enumerable:!0,get(){return this._p[2]}},toString:{enumerable:!0,value(){const e=`Java.Field{holder: ${this.holder}, fieldType: ${this.fieldType}, fieldReturnType: ${this.fieldReturnType}, value: ${this.value}}`;return e.length<200?e:`Java.Field{\n\tholder: ${this.holder},\n\tfieldType: ${this.fieldType},\n\tfieldReturnType: ${this.fieldReturnType},\n\tvalue: ${this.value},\n}`.split("\n").map(e=>e.length>200?e.slice(0,e.indexOf(" ")+1)+"...,":e).join("\n")}}});class Br{static fromBuffer(e,t){const n=qr(t),r=n.getCanonicalPath().toString(),o=new File(r,"w");return o.write(e.buffer),o.close(),function(e,t){t.use("java.io.File").$new(e).setWritable(!1,!1)}(r,t),new Br(r,n,t)}constructor(e,t,n){this.path=e,this.file=t,this._factory=n}load(){const{_factory:e}=this,{codeCacheDir:t}=e,n=e.use("dalvik.system.DexClassLoader"),r=e.use("java.io.File");let o=this.file;if(null===o&&(o=e.use("java.io.File").$new(this.path)),!o.exists())throw new Error("File not found");r.$new(t).mkdirs(),e.loader=n.$new(o.getCanonicalPath(),t,null,e.loader),Lr.preventDetachDueToClassLoader()}getClassNames(){const{_factory:e}=this,t=e.use("dalvik.system.DexFile"),n=qr(e),r=[],o=t.loadDex(this.path,n.getCanonicalPath(),0).entries();for(;o.hasMoreElements();)r.push(o.nextElement().toString());return r}}function qr(e){const{cacheDir:t,tempFileNaming:n}=e,r=e.use("java.io.File"),o=r.$new(t);return o.mkdirs(),r.createTempFile(n.prefix,n.suffix+".dex",o)}function Hr(e,t){const{factories:n,loaders:r,Integer:o}=Er,i=o.$new(n.indexOf(e));r.put(t,i);for(let e=t.getParent();null!==e&&!r.containsKey(e);e=e.getParent())r.put(e,i)}function Wr(e){let t=xr.get(e);void 0===t&&(t=0),t++,xr.set(e,t)}function Kr(e){let t=xr.get(e);if(void 0===t)throw new Error(`Thread ${e} is not ignored`);t--,0===t?xr.delete(e):xr.set(e,t)}function Qr(e,t){const n=[],r=e.getArrayLength(t);for(let o=0;o!==r;o++){const r=e.getObjectArrayElement(t,o);try{n.push(e.getTypeName(r))}finally{e.deleteLocalRef(r)}}return n}function Xr(e){const t=e.split(".");return t[t.length-1]+".java"}const Yr=Process.pointerSize;function eo(e,t){const n=e.use("android.os.Process");e.loader=t.getClassLoader(),n.myUid()===n.SYSTEM_UID.value?(e.cacheDir="/data/system",e.codeCacheDir="/data/dalvik-cache"):"getCodeCacheDir"in t?(e.cacheDir=t.getCacheDir().getCanonicalPath(),e.codeCacheDir=t.getCodeCacheDir().getCanonicalPath()):(e.cacheDir=t.getFilesDir().getCanonicalPath(),e.codeCacheDir=t.getCacheDir().getCanonicalPath())}function to(e,t){const n=e.use("java.io.File");e.loader=t.getClassLoader();const r=n.$new(t.getDataDir()).getCanonicalPath();e.cacheDir=r,e.codeCacheDir=r+"/cache"}const no=new class{ACC_PUBLIC=1;ACC_PRIVATE=2;ACC_PROTECTED=4;ACC_STATIC=8;ACC_FINAL=16;ACC_SYNCHRONIZED=32;ACC_BRIDGE=64;ACC_VARARGS=128;ACC_NATIVE=256;ACC_ABSTRACT=1024;ACC_STRICT=2048;ACC_SYNTHETIC=4096;constructor(){this.classFactory=null,this.ClassFactory=Tr,this.vm=null,this.api=null,this._initialized=!1,this._apiError=null,this._wakeupHandler=null,this._pollListener=null,this._pendingMainOps=[],this._pendingVmOps=[],this._cachedIsAppProcess=null;try{this._tryInitialize()}catch(e){}}_tryInitialize(){if(this._initialized)return!0;if(null!==this._apiError)throw this._apiError;let e;try{e=On(),this.api=e}catch(e){throw this._apiError=e,e}if(null===e)return!1;const t=new ee(e);return this.vm=t,sr(t),Tr._initialize(t,e),this.classFactory=new Tr,this._initialized=!0,!0}_dispose(){if(null===this.api)return;const{vm:e}=this;e.perform(e=>{Tr._disposeAll(e),_.dispose(e)}),Script.nextTick(()=>{ee.dispose(e)})}get available(){return this._tryInitialize()}get androidVersion(){return Se()}synchronized(e,t){const{$h:n=e}=e;if(!(n instanceof NativePointer))throw new Error("Java.synchronized: the first argument `obj` must be either a pointer or a Java instance");const r=this.vm.getEnv();s("VM::MonitorEnter",r.monitorEnter(n));try{t()}finally{r.monitorExit(n)}}enumerateLoadedClasses(e){this._checkAvailable();const{flavor:t}=this.api;"jvm"===t?this._enumerateLoadedClassesJvm(e):"art"===t?this._enumerateLoadedClassesArt(e):this._enumerateLoadedClassesDalvik(e)}enumerateLoadedClassesSync(){const e=[];return this.enumerateLoadedClasses({onMatch(t){e.push(t)},onComplete(){}}),e}enumerateClassLoaders(e){this._checkAvailable();const{flavor:t}=this.api;if("jvm"===t)this._enumerateClassLoadersJvm(e);else{if("art"!==t)throw new Error("Enumerating class loaders is not supported on Dalvik");this._enumerateClassLoadersArt(e)}}enumerateClassLoadersSync(){const e=[];return this.enumerateClassLoaders({onMatch(t){e.push(t)},onComplete(){}}),e}_enumerateLoadedClassesJvm(e){const{api:t,vm:n}=this,{jvmti:r}=t,o=n.getEnv(),i=Memory.alloc(4),a=Memory.alloc(Yr);r.getLoadedClasses(i,a);const s=i.readS32(),l=a.readPointer(),c=[];for(let e=0;e!==s;e++)c.push(l.add(e*Yr).readPointer());r.deallocate(l);try{for(const t of c){const n=o.getClassName(t);e.onMatch(n,t)}e.onComplete()}finally{c.forEach(e=>{o.deleteLocalRef(e)})}}_enumerateClassLoadersJvm(e){this.choose("java.lang.ClassLoader",e)}_enumerateLoadedClassesArt(e){const{vm:t,api:n}=this,r=t.getEnv(),o=n["art::JavaVMExt::AddGlobalRef"],{vm:i}=n;pt(t,r,t=>{const a=_t(n=>{const a=o(i,t,n);try{const t=r.getClassName(a);e.onMatch(t,a)}finally{r.deleteGlobalRef(a)}return!0});n["art::ClassLinker::VisitClasses"](n.artClassLinker.address,a)}),e.onComplete()}_enumerateClassLoadersArt(e){const{classFactory:t,vm:n,api:r}=this,o=n.getEnv(),i=r["art::ClassLinker::VisitClassLoaders"];if(void 0===i)throw new Error("This API is only available on Android >= 7.0");const a=t.use("java.lang.ClassLoader"),s=[],l=r["art::JavaVMExt::AddGlobalRef"],{vm:c}=r;pt(n,o,e=>{const t=vt(t=>(s.push(l(c,e,t)),!0));ft(()=>{i(r.artClassLinker.address,t)})});try{s.forEach(n=>{const r=t.cast(n,a);e.onMatch(r)})}finally{s.forEach(e=>{o.deleteGlobalRef(e)})}e.onComplete()}_enumerateLoadedClassesDalvik(e){const{api:t}=this,n=ptr("0xcbcacccd"),r=t.gDvm.add(172).readPointer(),o=r.readS32(),i=r.add(12).readPointer(),a=8*o;for(let t=0;t<a;t+=8){const r=i.add(t).add(4).readPointer();if(r.isNull()||r.equals(n))continue;const o=r.add(24).readPointer().readUtf8String();if(o.startsWith("L")){const t=o.substring(1,o.length-1).replace(/\//g,".");e.onMatch(t)}}e.onComplete()}enumerateMethods(e){const{classFactory:t}=this,n=this.vm.getEnv(),r=t.use("java.lang.ClassLoader");return Fn.enumerateMethods(e,this.api,n).map(e=>{const o=e.loader;return e.loader=null!==o?t.wrap(o,r,n):null,e})}scheduleOnMainThread(e){this.performNow(()=>{this._pendingMainOps.push(e);let{_wakeupHandler:t}=this;if(null===t){const{classFactory:e}=this,n=e.use("android.os.Handler"),r=e.use("android.os.Looper");t=n.$new(r.getMainLooper()),this._wakeupHandler=t}null===this._pollListener&&(this._pollListener=Interceptor.attach(Process.getModuleByName("libc.so").getExportByName("epoll_wait"),this._makePollHook()),Interceptor.flush()),t.sendEmptyMessage(1)})}_makePollHook(){const e=Process.id,{_pendingMainOps:t}=this;return function(){if(this.threadId!==e)return;let n;for(;void 0!==(n=t.shift());)try{n()}catch(e){Script.nextTick(()=>{throw e})}}}perform(e){if(this._checkAvailable(),this._isAppProcess()&&null===this.classFactory.loader)this._pendingVmOps.push(e),1===this._pendingVmOps.length&&this._performPendingVmOpsWhenReady();else try{this.vm.perform(e)}catch(e){Script.nextTick(()=>{throw e})}}performNow(e){return this._checkAvailable(),this.vm.perform(()=>{const{classFactory:t}=this;if(this._isAppProcess()&&null===t.loader){const e=t.use("android.app.ActivityThread").currentApplication();null!==e&&eo(t,e)}return e()})}_performPendingVmOpsWhenReady(){this.vm.perform(()=>{const{classFactory:e}=this,t=e.use("android.app.ActivityThread"),n=t.currentApplication();if(null!==n)return eo(e,n),void this._performPendingVmOps();const r=this;let o=!1,i="early";const a=t.handleBindApplication;a.implementation=function(t){if(null!==t.instrumentationName.value){i="late";const t=e.use("android.app.LoadedApk").makeApplication;t.implementation=function(n,i){return o||(o=!0,to(e,this),r._performPendingVmOps()),t.apply(this,arguments)}}a.apply(this,arguments)};const s=t.getPackageInfo.overloads.map(e=>[e.argumentTypes.length,e]).sort(([e],[t])=>t-e).map(([e,t])=>t)[0];s.implementation=function(...t){const n=s.call(this,...t);return o||"early"!==i||(o=!0,to(e,n),r._performPendingVmOps()),n}})}_performPendingVmOps(){const{vm:e,_pendingVmOps:t}=this;let n;for(;void 0!==(n=t.shift());)try{e.perform(n)}catch(e){Script.nextTick(()=>{throw e})}}use(e,t){return this.classFactory.use(e,t)}openClassFile(e){return this.classFactory.openClassFile(e)}choose(e,t){this.classFactory.choose(e,t)}retain(e){return this.classFactory.retain(e)}cast(e,t){return this.classFactory.cast(e,t)}array(e,t){return this.classFactory.array(e,t)}backtrace(e){return At(this.vm,e)}isMainThread(){const e=this.classFactory.use("android.os.Looper"),t=e.getMainLooper(),n=e.myLooper();return null!==n&&t.$isSameObject(n)}registerClass(e){return this.classFactory.registerClass(e)}deoptimizeEverything(){const{vm:e}=this;return Gt(e,e.getEnv())}deoptimizeBootImage(){const{vm:e}=this;return Zt(e,e.getEnv())}deoptimizeMethod(e){const{vm:t}=this;return $t(t,t.getEnv(),e)}_checkAvailable(){if(!this.available)throw new Error("Java API not available")}_isAppProcess(){let e=this._cachedIsAppProcess;if(null===e){if("jvm"===this.api.flavor)return e=!1,this._cachedIsAppProcess=e,e;const t=new NativeFunction(Module.getGlobalExportByName("readlink"),"pointer",["pointer","pointer","pointer"],{exceptions:"propagate"}),n=Memory.allocUtf8String("/proc/self/exe"),r=1024,o=Memory.alloc(r),i=t(n,o,ptr(r)).toInt32();if(-1!==i){const t=o.readUtf8String(i);e=/^\/system\/bin\/app_process/.test(t)}else e=!0;this._cachedIsAppProcess=e}return e}};Script.bindWeak(no,()=>{no._dispose()});const ro=no,oo=new Map,io=new Map;function ao(e){}!function e(){recv("conf",function(t,n){const r=t.k,o=t.v;if("invoke"===r){if(io.has(o)){const e=io.get(o);console.log(`info: invoking ${o}`),e()}}else oo.set(r,o);e()})}(),rpc.exports={init(e,t){for(const e in t){const n=t[e];oo.set(e,n)}}},ro.performNow(function(){try{ro.deoptimizeEverything()}catch(e){}}),ro.perform(function(){const e=[];e.push(function(){ro.use(function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-36-n)}).join("")}(45,207,189,130,192,193,180)+1185532..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-60-n)}).join("")}(9,175,119,176,183,191,183)+1465337..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-9-n)}).join("")}(22,148,158,126,86,154,146,142,152,152,80,136,143,139)+21..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-8-n)}).join("")}(11,134))[21..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+23..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+533..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-47-n)}).join("")}(48,174)+22952..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")].implementation=function(e){}}),e.push(function(){ro.use(function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-45-n)}).join("")}(10,179,167,177,163,173,181,163,104,166,167,154)+44981..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+985299966..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-44-n)}).join("")}(59,215,211,221,189,149)+28..toString(36).toLowerCase())[function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-24-n)}).join("")}(63,206,190,159,182)+40813..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-62-n)}).join("")}(15,145)].implementation=function(e){}}),e.push(function(){ro.use(16438..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+986..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-15-n)}).join("")}(10,83,139,145,139,140,131,128,144,145,74,137,143,146)+36776..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-0-n)}).join("")}(63,148,109)+35364..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-26-n)}).join("")}(26,158,164,158,159))[10..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-16-n)}).join("")}(54,177,187,169)+40565..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-18-n)}).join("")}(49,179,179,172)].implementation=function(){}}),e.push(function(){ro.use(16438..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+50678562223249..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-41-n)}).join("")}(8,105,167,171,167,157,170,150,160,163,96,153)+29336744..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+766960727..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+51765616..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-30-n)}).join("")}(9,85)+11..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+1062..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-29-n)}).join("")}(4,141))[12..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-63-n)}).join("")}(25,192)+516..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-2-n)}).join("")}(33,142)].implementation=function(e){return!0}}),e.push(function(){ro.use(16438..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+1407737839534..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-16-n)}).join("")}(26,149,156,143,148,90,147,154)+1856596226..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+39942..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-44-n)}).join("")}(47,225,221,190,141,219,211,207,217,185,211,214,213,168,202,173,139,207,199)+1037..toString(36).toLowerCase()+17..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-31-n)}).join("")}(23,158,123,163,162)+1001..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-2-n)}).join("")}(22,139))[20967140..toString(36).toLowerCase()+35..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+531..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-3-n)}).join("")}(23,149,147,148,144,113,142,128,144)+517..toString(36).toLowerCase()].implementation=function(e,t){}}),e.push(function(){ro.use(function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-8-n)}).join("")}(27,166,170,166,156,169,149,159,162,95,152,159,167,159,147,157,143,153,161,143,84,146,147,134)+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+29336744..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+831805..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+896760416..toString(36).toLowerCase()+35..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+24815172..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-63-n)}).join("")}(0,179,135,185,183,184,180,149,100,164)+21..toString(36).toLowerCase()+19..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+531..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-30-n)}).join("")}(49,195,195))[20967140..toString(36).toLowerCase()+35..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-27-n)}).join("")}(20,167,162,148)+531..toString(36).toLowerCase()+10..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+36100..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-18-n)}).join("")}(58,192)+14..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-23-n)}).join("")}(28,151)].implementation=function(e,t){}}),e.push(function(){ro.use(24..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-20-n)}).join("")}(14,139,141)+1391511..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+24..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-62-n)}).join("")}(13,191)+1069..toString(36).toLowerCase()+11..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-33-n)}).join("")}(45,192)+21..toString(36).toLowerCase())[function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-46-n)}).join("")}(35,184)+14..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-57-n)}).join("")}(16,189)].overload(900550..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+21..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-42-n)}).join("")}(41,204,170,132,188,194,180)+990..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-15-n)}).join("")}(18,143)+16..toString(36).toLowerCase()).implementation=function(e){const t=this[function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-58-n)}).join("")}(4,165)+14..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-54-n)}).join("")}(48,218)](function(e){if(oo.get("no_proxy"))return e;const t=oo.get("proxy_url");if(e.startsWith("https://")||e.startsWith("http://")){const n=e.indexOf("://")+3,r=e.indexOf("/",n);return-1===r?t:`${t}${e.substring(r)}`}return e}(e));return t}}),e.push(function(){ro.use(16438..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+628..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-5-n)}).join("")}(9,123,115,129)+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+29..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+10..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+1184..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+1292038..toString(36).toLowerCase()+17..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+25..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-1-n)}).join("")}(50,169,162,172,152,153,158,160,163)+23..toString(36).toLowerCase())[function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-19-n)}).join("")}(17,161,151,153,118,147,147)+34..toString(36).toLowerCase()+19..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-19-n)}).join("")}(13,151,131,134,146)+14..toString(36).toLowerCase()].implementation=function(){}}),e.push(function(){ro.use(function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-1-n)}).join("")}(4,104)+886..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+17..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-26-n)}).join("")}(33,170,162,176,106,162)+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+29..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-12-n)}).join("")}(54,171,172,186,170,136,147,150)+1377239..toString(36).toLowerCase())[function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-18-n)}).join("")}(22,151,151)+11..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+36819..toString(36).toLowerCase()+28..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-20-n)}).join("")}(49,176,173,180)+23..toString(36).toLowerCase()].implementation=function(e,t,n,r){}}),e.push(function(){ro.use(function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-1-n)}).join("")}(2,110,122,118,105,103,109,111)+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-5-n)}).join("")}(13,120,128)+29..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+24910011..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-60-n)}).join("")}(44,207,188,211)+777266710..toString(36).toLowerCase()+32..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+41314354..toString(36).toLowerCase())[function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-23-n)}).join("")}(49,174,187)+29..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-58-n)}).join("")}(40,217,215,209,171)+10..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-54-n)}).join("")}(24,188)+12..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-27-n)}).join("")}(8,136)].implementation=function(e){}}),e.push(function(){ro.use(23181671893..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+2225448814102..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+30341..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+591819..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-17-n)}).join("")}(22,87,143,144)+19..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+24..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-17-n)}).join("")}(1,125,121,128)+16..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+896760416..toString(36).toLowerCase()+35..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+14..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-47-n)}).join("")}(22,187,168)+1284118..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-63-n)}).join("")}(43,186)+31878..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-47-n)}).join("")}(37,183)+34..toString(36).toLowerCase())[function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-24-n)}).join("")}(2,131)+28..toString(36).toLowerCase()+19..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+1293806930..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-40-n)}).join("")}(55,202,207,203,202,196,212,181,212,215)+32..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-29-n)}).join("")}(3,139,139,153,152,140,143,147,133)].overload().implementation=function(){return!0}}),e.push(function(){ro.use(23181671893..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+2225448814102..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-13-n)}).join("")}(5,136,120,128)+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+766998088..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+19..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+41403976..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+14..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-32-n)}).join("")}(0,145,152,148)+992..toString(36).toLowerCase()+35..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-51-n)}).join("")}(60,228,230,198,238,232,220,228,230,211,212)+18..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-21-n)}).join("")}(38,181,158))[18..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-26-n)}).join("")}(32,180,177,159,162,168,126,173)+19361..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-0-n)}).join("")}(41,164,150,128,146,151,147,146,140,156,125)+1361880085..toString(36).toLowerCase()].overload(function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-55-n)}).join("")}(17,175,185,122,172,192,170,178)+844..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+35..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+1071..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-31-n)}).join("")}(20,162,156)+16..toString(36).toLowerCase()).implementation=function(e){return!0}}),e.push(function(){ro.use(function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-15-n)}).join("")}(7,149,145,79,132,136,141,143,128,137,123,71,133,134,121)+16..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+16439..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-43-n)}).join("")}(45,203)+21460097..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-55-n)}).join("")}(32,204,190,169,207,205,206,202,171)+487827..toString(36).toLowerCase()+25..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+22..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-11-n)}).join("")}(39,162)+21..toString(36).toLowerCase())[function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-0-n)}).join("")}(12,111)+811748..toString(36).toLowerCase()+10..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+27..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-18-n)}).join("")}(7,129,129,143,141,142)].overload(17..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+28..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+900550..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+47699091..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-51-n)}).join("")}(54,210)+1078..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+579017..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+14..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-13)}).join("")+180..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-25-n)}).join("")}(14,146,151,147,149,159,156,142,107,96)+14018..toString(36).toLowerCase()+11..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join(""),function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-19-n)}).join("")}(14,124)+18..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join(""),function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-50-n)}).join("")}(10,151)+18..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join(""),function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-37-n)}).join("")}(23,158,166)+1126..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+21..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-36-n)}).join("")}(32,179,165)+16..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+35..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+49992748..toString(36).toLowerCase(),function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-33-n)}).join("")}(39,122,172,192,170,178)+993580..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+35..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+1071..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-32-n)}).join("")}(10,147)+23..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-51-n)}).join("")}(14,168),15144..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-34-n)}).join("")}(27,163,169)+383..toString(36).toLowerCase()).implementation=function(e,t,n,r,o,i){return ro.use(function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-33-n)}).join("")}(38,183,193,193,121,171,191,169,177)+21..toString(36).toLowerCase()+30..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-71)}).join("")+17..toString(36).toLowerCase().split("").map(function(e){return String.fromCharCode(e.charCodeAt()+-39)}).join("")+1295098..toString(36).toLowerCase()+function(){var e=Array.prototype.slice.call(arguments),t=e.shift();return e.reverse().map(function(e,n){return String.fromCharCode(e-t-47-n)}).join("")}(19,172,142)+1037..toString(36).toLowerCase()).$new()}});for(const t of e)try{t()}catch(e){ao()}})})()})();